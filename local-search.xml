<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>六.Jedis操作Redis</title>
    <link href="/2021/11/17/%E5%85%AD-Jedis%E6%93%8D%E4%BD%9CRedis/"/>
    <url>/2021/11/17/%E5%85%AD-Jedis%E6%93%8D%E4%BD%9CRedis/</url>
    
    <content type="html"><![CDATA[<h1 id="Jedis操作Redis"><a href="#Jedis操作Redis" class="headerlink" title="Jedis操作Redis"></a>Jedis操作Redis</h1><p>Jedis是Redis官方推荐的java连接开发工具，使用java操作Redis中间件。</p><div class="note note-success">            <p>慢慢来才是最快的.</p>          </div><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">#连接redis服务<br><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RedisJava</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-comment">//连接本地的 Redis 服务</span><br>        Jedis jedis = <span class="hljs-keyword">new</span> Jedis(<span class="hljs-string">&quot;localhost&quot;</span>);  <span class="hljs-comment">//可设置ip与port</span><br>        <span class="hljs-comment">// 如果 Redis 服务设置了密码，需要下面这行，没有就不需要</span><br>        <span class="hljs-comment">// jedis.auth(&quot;123456&quot;); </span><br>        System.out.println(<span class="hljs-string">&quot;连接成功&quot;</span>);<br>        <span class="hljs-comment">//查看服务是否运行</span><br>        System.out.println(<span class="hljs-string">&quot;服务正在运行: &quot;</span>+jedis.ping());<br>    &#125;<br>&#125;<br>输出：<br>连接成功<br>服务正在运行: PONG<br><br>#建立连接，并设置string类的key，语法与redis客户端的命令完全一致<br><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;<br> <br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RedisStringJava</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-comment">//连接本地的 Redis 服务</span><br>        Jedis jedis = <span class="hljs-keyword">new</span> Jedis(<span class="hljs-string">&quot;localhost&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;连接成功&quot;</span>);<br>        <span class="hljs-comment">//设置 redis 字符串数据</span><br>        jedis.set(<span class="hljs-string">&quot;runoobkey&quot;</span>, <span class="hljs-string">&quot;www.runoob.com&quot;</span>);<br>        <span class="hljs-comment">// 获取存储的数据并输出</span><br>        System.out.println(<span class="hljs-string">&quot;redis 存储的字符串为: &quot;</span>+ jedis.get(<span class="hljs-string">&quot;runoobkey&quot;</span>));<br>    &#125;<br>&#125;<br>输出：<br>连接成功<br>redis 存储的字符串为: www.runoob.com<br><br>#使用list类实例<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;<br> <br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RedisListJava</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-comment">//连接本地的 Redis 服务</span><br>        Jedis jedis = <span class="hljs-keyword">new</span> Jedis(<span class="hljs-string">&quot;localhost&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;连接成功&quot;</span>);<br>        <span class="hljs-comment">//存储数据到列表中</span><br>        jedis.lpush(<span class="hljs-string">&quot;site-list&quot;</span>, <span class="hljs-string">&quot;Runoob&quot;</span>);<br>        jedis.lpush(<span class="hljs-string">&quot;site-list&quot;</span>, <span class="hljs-string">&quot;Google&quot;</span>);<br>        jedis.lpush(<span class="hljs-string">&quot;site-list&quot;</span>, <span class="hljs-string">&quot;Taobao&quot;</span>);<br>        <span class="hljs-comment">// 获取存储的数据并输出</span><br>        List&lt;String&gt; list = jedis.lrange(<span class="hljs-string">&quot;site-list&quot;</span>, <span class="hljs-number">0</span> ,<span class="hljs-number">2</span>);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;list.size(); i++) &#123;<br>            System.out.println(<span class="hljs-string">&quot;列表项为: &quot;</span>+list.get(i));<br>        &#125;<br>    &#125;<br>&#125;<br>输出：<br>连接成功<br>列表项为: Taobao<br>列表项为: Google<br>列表项为: Runoob<br></code></pre></div></td></tr></table></figure><p><img src="/2021/11/17/%E5%85%AD-Jedis%E6%93%8D%E4%BD%9CRedis/%E6%8E%92%E5%BA%8F%E6%93%8D%E4%BD%9C.png" srcset="/img/loading.gif" lazyload alt="排序操作"></p><p>本机实验还没进行，不会配环境，没有装Maven😫</p><p>参考链接：</p><p><a href="https://www.jianshu.com/p/a1038eed6d44">Jedis使用教程完整版 - 简书 (jianshu.com)</a></p><p><a href="https://cloud.tencent.com/developer/article/1776110">Jedis基础详解 - 云+社区 - 腾讯云 (tencent.com)</a></p>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>五.Redis事务与乐观锁</title>
    <link href="/2021/11/16/%E4%BA%94-Redis%E4%BA%8B%E5%8A%A1/"/>
    <url>/2021/11/16/%E4%BA%94-Redis%E4%BA%8B%E5%8A%A1/</url>
    
    <content type="html"><![CDATA[<h1 id="Redis事务"><a href="#Redis事务" class="headerlink" title="Redis事务"></a>Redis事务</h1><p>Redis事务本质：一组命令集合。一个事务中的所有命令都会被序列化，在事务执行过程中，会按照顺序执行。</p><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli">|<span class="hljs-params">------</span>队列 <span class="hljs-keyword">set</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">set</span>.<span class="hljs-string">...</span>队列<span class="hljs-params">-------</span>|<br></code></pre></div></td></tr></table></figure><p>Redis事务：</p><ul><li>开启事务（multi）</li><li>命令入队列（一系列命令）</li><li>执行事务（exec）</li></ul><p>所有的命令在事务中，并没有直接执行，而是只会在执行命令发起的时候才会执行。</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-comment">#正常执行命令</span><br>127.0.0.1:6379&gt; multi  //开启事务<br>OK   <br>127.0.0.1:6379(TX)&gt; <span class="hljs-built_in">set</span> k1 v1<br>QUEUED  //添加命令，命令入队<br>127.0.0.1:6379(TX)&gt; <span class="hljs-built_in">set</span> k2 v1<br>QUEUED<br>127.0.0.1:6379(TX)&gt; get k1<br>QUEUED<br>127.0.0.1:6379(TX)&gt; get k2<br>QUEUED<br>127.0.0.1:6379(TX)&gt; <span class="hljs-built_in">exec</span>   //事务执行，依次按顺序执行命令<br>1) OK   //依次的执行结果<br>2) OK<br>3) <span class="hljs-string">&quot;v1&quot;</span><br>4) <span class="hljs-string">&quot;v1&quot;</span><br><span class="hljs-comment">#取消一个事务  discard命令  执行此命令后，事务将被放弃，队列将被清空，且将会从事务状态中退出</span><br>127.0.0.1:6379(TX)&gt; <span class="hljs-built_in">set</span> k1 1<br>QUEUED<br>127.0.0.1:6379(TX)&gt; <span class="hljs-built_in">set</span> k2 2<br>QUEUED<br>127.0.0.1:6379(TX)&gt; <span class="hljs-built_in">set</span> k4 4<br>QUEUED<br>127.0.0.1:6379(TX)&gt; discard  //事务取消之后，事务中所有的命令都不会被执行<br>OK<br>127.0.0.1:6379&gt; get k4   <br>(nil)   //因为事务被取消，k4并没有<span class="hljs-built_in">set</span>，因此k4为nul<br>127.0.0.1:6379&gt;<br></code></pre></div></td></tr></table></figure><p>Redis中的两种错误：（同java基本一致）</p><ul><li>编译型异常（代码有问题，命令语法错误）：事务中的所有命令都不会被执行！（入队失败）</li><li>运行时异常（分母为0，数组越界等）：如果事务队列中的某一条命令存在运行时异常，那么在执行事务时，其他命令是可以正常执行的，错误的命令会抛出异常。</li></ul><figure class="highlight accesslog"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs accesslog">#编译型异常<br><span class="hljs-number">127.0.0.1:6379</span>&gt; multi<br>OK<br><span class="hljs-number">127.0.0.1:6379</span>(TX)&gt; set v1 <span class="hljs-number">1</span><br>QUEUED<br><span class="hljs-number">127.0.0.1:6379</span>(TX)&gt; setset v1 <span class="hljs-number">2</span><br>(error) ERR unknown command `setset`, with args beginning with: `v1`, `<span class="hljs-number">2</span>`,<br><span class="hljs-number">127.0.0.1:6379</span>(TX)&gt; set v2 <span class="hljs-number">2</span><br>QUEUED<br><span class="hljs-number">127.0.0.1:6379</span>(TX)&gt; exec  //由于存在语法错误，队列中的所有命令都不会执行<br>(error) EXECABORT Transaction discarded because of previous errors. <br><br>#运行时异常<br><span class="hljs-number">127.0.0.1:6379</span>(TX)&gt; set v1 <span class="hljs-string">&quot;ab&quot;</span><br>QUEUED<br><span class="hljs-number">127.0.0.1:6379</span>(TX)&gt; incr v1  //对字符串+<span class="hljs-number">1</span>属于运行时异常<br>QUEUED<br><span class="hljs-number">127.0.0.1:6379</span>(TX)&gt; set k2 <span class="hljs-number">22</span><br>QUEUED<br><span class="hljs-number">127.0.0.1:6379</span>(TX)&gt; get k2<br>QUEUED<br><span class="hljs-number">127.0.0.1:6379</span>(TX)&gt; exec<br><span class="hljs-number">1</span>) OK<br><span class="hljs-number">2</span>) (error) ERR value is not an integer or out of range  //执行时报错<br><span class="hljs-number">3</span>) OK<br><span class="hljs-number">4</span>) <span class="hljs-string">&quot;22&quot;</span>  //其他命令无异常，正常执行<br><span class="hljs-number">127.0.0.1:6379</span>&gt;<br><br></code></pre></div></td></tr></table></figure><p>Redis事务并没有隔离级别的概念</p><p>重点：Redis中单条命令是原子性的，但事务并不保证原子性（acid没有全部实现，与关系型数据库不同），一旦事务中（命令队列中）有一条命令执行失败（运行时异常），并不影响整个事务的执行，而mysql的事务具有原子性，在一个事务中，多条命令，一旦有一条执行失败，其他的也无法成功执行。</p><p>一次性，顺序性，排他性地执行一系列命令</p><ul><li>exec命令执行之前，多个命令被放入队列缓存中</li><li>exec命令执行后，缓存队列中的命令顺序执行，一旦有一个错误（运行时异常），不影响其他命令的执行</li><li>在<strong>事务执行过程</strong>中，其他客户端提交的命令请求不会插入到当前的缓存命令队列中，这里只是保证在<strong>执行过程中</strong>，在<strong>将命令添加进入队列</strong>的过程中，<strong>是不会保证不被其他客户端命令插入的</strong></li><li>不支持回滚，没有实现发生错误直接回滚的功能，redis的事务更像一个命令打包的功能</li></ul><p>为什么不支持回滚？官方回答：</p><figure class="highlight"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs">只有当被调用的Redis命令有语法错误时，这条命令才会执行失败（在将这个命令放入事务队列期间，Redis能够发现此类问题），或者对某个键执行不符合其数据类型的操作：实际上，这就意味着只有程序错误才会导致Redis命令执行失败，这种错误很有可能在程序开发期间发现，一般很少在生产环境发现。Redis已经在系统内部进行功能简化，这样可以确保更快的运行速度，因为Redis不需要事务回滚的能力。<br></code></pre></div></td></tr></table></figure><h1 id="Redis实现乐观锁"><a href="#Redis实现乐观锁" class="headerlink" title="Redis实现乐观锁"></a>Redis实现乐观锁</h1><ul><li>悲观锁：见名知意，很悲观，担心数据会被修改，对读写操作都上锁，自己用完数据后，就会进行解锁。那么其它线程进行操作时必须等待，效率相对较低。传统的关系型数据库里边就用到了很多这种锁机制，比如行锁、表锁、读锁、写锁等。都是在操作之前先上锁让别人无法操作该数据。</li><li>乐观锁：顾名思义，很乐观，每次取数据的时候并不担心自己的数据会被修改。数据库实现乐观锁，通常使用的是version（数据版本），来表示数据的。每次取数据的时候，连同数据版本version一起取出。当读取出数据，对数据进行更改时，会将数版本version 加一，然后提交到数据库，此时比较数据版本version，如果提交的数据版本version大于当前数据库对应记录的数据版本version，那么提交成功。否则小于等于都会提交失败。需要重新从数据库取数据。</li><li>乐观锁适用场景：<strong>频繁读取数据的场景</strong>，因为读取数据并不会上锁。但是当有大量数据写入的时候，会频繁的提交不成功，会重新读取数据，再提交。</li><li>悲观锁适用场景：<strong>频繁写入数据的场景</strong>，因为不管是读还是写 都会上锁，如果大量写入数据，为了数据安全上锁是有必要的，相反乐观锁就会大量的读取提交操作。但是当有大量数据读出的时候，效率低下。</li></ul><p>Redis实现乐观锁：</p><p><img src="/2021/11/16/%E4%BA%94-Redis%E4%BA%8B%E5%8A%A1/1.png" srcset="/img/loading.gif" lazyload alt="1"></p><p>​        Redis通过使用watch命令来实现乐观锁，watch命令用于监视一个或多个key，如果在事务执行之前，这个（或这些）key被其他命令所改动，那么这个事务将被打断。</p><p>​        大多数是基于数据版本（version）的记录机制实现的。即为数据增加一个版本标识，在基于数据库表的版本解决方案中，一般是通过为数据库表增加一个”version”字段来实现读取出数据时，将此版本号一同读出，之后更新时，对此版本号加1。此时，将提交数据的版本号与数据库表对应记录的当前版本号进行比对，如果提交的数据版本号大于数据库当前版本号，则予以更新，否则认为是过期数据。</p><p>​        <strong>“ Redis使用WATCH命令实现事务的“检查再设置”（CAS）行为。作为WATCH命令的参数的键会受到Redis的监控，Redis能够检测到它们的变化。在执行EXEC命令之前，如果Redis检测到至少有一个键被修改了，那么整个事务便会中止运行，然后EXEC命令会返回一个Null值，提醒用户事务运行失败。”</strong></p><p>​        如果在添加watch之后，事务正常exec完成，会自动释放锁（监视），其他的情况，需要手动执行unwatch命令释放监视。</p><p>​        watch的key是对整个连接有效的，事务也一样（但事务被执行后就不存在了），如果连接断开，监视和事务都会被自动清除，discard和unwatch命令也会清除连接中的所有监视。</p><p>​        操作实例：</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-comment">#正常情况下，设置监视</span><br>127.0.0.1:6379&gt; <span class="hljs-built_in">set</span> money 100<br>OK<br>127.0.0.1:6379&gt; <span class="hljs-built_in">set</span> out 0<br>OK<br><span class="hljs-comment">#监视money对象</span><br>127.0.0.1:6379&gt; watch money <br>OK<br><span class="hljs-comment">#事务正常结束，数据期间没有改动，这时正常执行成功</span><br>127.0.0.1:6379&gt; multi<br>OK<br>127.0.0.1:6379&gt; decrby money 20<br>QUEUED<br>127.0.0.1:6379&gt; incrby out 20<br>QUEUED<br>127.0.0.1:6379&gt; <span class="hljs-built_in">exec</span><br>1) (<span class="hljs-built_in">integer</span>) 80<br>2) (<span class="hljs-built_in">integer</span>) 20<br><br><span class="hljs-comment">#多个客户端的场景下</span><br>127.0.0.1:6379&gt; watch money<br>OK<br>127.0.0.1:6379&gt; multi<br>OK<br>127.0.0.1:6379&gt; decrby money 10<br>QUEUED<br>127.0.0.1:6379&gt; incrby out 10<br>QUEUED<br><span class="hljs-comment">#执行之前，开启另一个线程去修改money的值，这个时候就会导致事务执行失败。</span><br>127.0.0.1:6379&gt; <span class="hljs-built_in">exec</span><br>(nil)<br><br><span class="hljs-comment">#出现上述错误后，需要手动解锁，并重新获取锁</span><br><span class="hljs-comment">#如果发现事务执行失败就先解锁</span><br>127.0.0.1:6379&gt; unwatch <br>OK<br><span class="hljs-comment">#获取最新的值再次监控，类似select version</span><br>127.0.0.1:6379&gt; watch money <br>OK<br>127.0.0.1:6379&gt; multi<br>OK<br>127.0.0.1:6379&gt; decrby money 10<br>QUEUED<br>127.0.0.1:6379&gt; incrby out 1000<br>QUEUED<br><span class="hljs-comment">#执行之前会先比较version ，一样就会执行成功，反正失败</span><br>127.0.0.1:6379&gt; <span class="hljs-built_in">exec</span><br>1) (<span class="hljs-built_in">integer</span>) 80<br>2) (<span class="hljs-built_in">integer</span>) 1000<br>127.0.0.1:6379&gt;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>刷题记录</title>
    <link href="/2021/11/15/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    <url>/2021/11/15/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<div class="note note-success">            <p>为了避免将来连笔试都过不了，zyk决定每天刷题！</p>          </div><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>​    不知不觉，已经好久没有刷题了，算法又太重要了，好焦虑。</p><p>​    学校的OJ只能用c++，但是我准备的又是java，长期不写java，连基本的API都快忘记了，所以写这个帖子，每天刷几道题吧，数量不限，看时间是否充足。</p><p>​    当前目标：先把剑指OFFER刷一遍。</p><h2 id="2021-11-22"><a href="#2021-11-22" class="headerlink" title="2021-11-22"></a>2021-11-22</h2><p>又摸了一天。。。</p><ul><li><h4 id="剑指offer25-合并两个排序的链表"><a href="#剑指offer25-合并两个排序的链表" class="headerlink" title="剑指offer25 合并两个排序的链表"></a>剑指offer25 合并两个排序的链表</h4><p>easy遍历</p></li><li><h4 id="剑指offer26-树的子结构"><a href="#剑指offer26-树的子结构" class="headerlink" title="剑指offer26 树的子结构"></a>剑指offer26 树的子结构</h4><p><img src="/2021/11/15/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/MyBlog\source_posts\刷题记录\剑指26.png" srcset="/img/loading.gif" lazyload alt="剑指26"></p></li></ul><p>先深度优先遍历找到头结点的值在A树中的位置，然后递归check下面的子树，注意终止条件即可</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;<br>    TreeNode d;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isSubStructure</span><span class="hljs-params">(TreeNode A, TreeNode B)</span> </span>&#123;<br>        d= B;<br>        <span class="hljs-keyword">if</span>(A==<span class="hljs-keyword">null</span>&amp;&amp;B!=<span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        <span class="hljs-keyword">if</span>(A!=<span class="hljs-keyword">null</span>&amp;&amp;B==<span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        <span class="hljs-keyword">if</span>(A==<span class="hljs-keyword">null</span>&amp;&amp;B==<span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        <span class="hljs-keyword">return</span> find(A,B.val);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">find</span><span class="hljs-params">(TreeNode r,<span class="hljs-keyword">int</span> k)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(r==<span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        <span class="hljs-keyword">if</span>(r.val==k) &#123;<br>            <span class="hljs-keyword">boolean</span> ans = check(r,d);<br>            <span class="hljs-keyword">if</span>(ans==<span class="hljs-keyword">true</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>        &#125;<br>      <span class="hljs-keyword">return</span> find(r.left,k) || find(r.right,k);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">check</span><span class="hljs-params">(TreeNode r,TreeNode x)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(r==<span class="hljs-keyword">null</span>&amp;&amp;x==<span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>        <span class="hljs-keyword">if</span>(r!=<span class="hljs-keyword">null</span>&amp;&amp;x==<span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>        <span class="hljs-keyword">if</span>(r!=<span class="hljs-keyword">null</span>&amp;&amp;x!=<span class="hljs-keyword">null</span>)&#123;<br>            <span class="hljs-keyword">if</span>(r.val == x.val)<br>            &#123;<br>                <span class="hljs-keyword">return</span> check(r.left,x.left)&amp;&amp;check(r.right,x.right);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><ul><li><h4 id="剑指offer28-对称的二叉树"><a href="#剑指offer28-对称的二叉树" class="headerlink" title="剑指offer28 对称的二叉树"></a>剑指offer28 对称的二叉树</h4><p>easy，递归判断即可</p></li></ul><h2 id="2021-11-20"><a href="#2021-11-20" class="headerlink" title="2021-11-20"></a>2021-11-20</h2><p>学院csp线上测验，未得到完整题解，暂不记录</p><h2 id="2021-11-18"><a href="#2021-11-18" class="headerlink" title="2021-11-18"></a>2021-11-18</h2><ul><li><h4 id="剑指offer14-1-剪绳子1"><a href="#剑指offer14-1-剪绳子1" class="headerlink" title="剑指offer14-1  剪绳子1"></a>剑指offer14-1  剪绳子1</h4></li><li><h4 id="剑指offer14-2-剪绳子2"><a href="#剑指offer14-2-剪绳子2" class="headerlink" title="剑指offer14-2 剪绳子2"></a>剑指offer14-2 剪绳子2</h4><p>数学证明：每次切都切长度3</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">cuttingRope</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(n&lt;=<span class="hljs-number">3</span>) <span class="hljs-keyword">return</span> n-<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span>(n==<span class="hljs-number">4</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">4</span>;<br>        <span class="hljs-keyword">long</span> res = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">long</span> mod =(<span class="hljs-keyword">long</span>)<span class="hljs-number">1e9</span>+<span class="hljs-number">7</span>;<br>        <span class="hljs-keyword">while</span>(n&gt;<span class="hljs-number">4</span>)&#123;<br>            res = (res*<span class="hljs-number">3</span>)%mod;<br>            n = n-<span class="hljs-number">3</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">int</span>)((res*n)%mod);<br>        <br>        &#125;<br>&#125;<span class="hljs-comment">//主要是大数溢出，res和mod都要为long才行</span><br></code></pre></div></td></tr></table></figure><p>动态规划（后续补充）</p></li><li><h4 id="剑指offer-21-调整数组顺序使奇数位于偶数前面"><a href="#剑指offer-21-调整数组顺序使奇数位于偶数前面" class="headerlink" title="剑指offer 21.调整数组顺序使奇数位于偶数前面"></a>剑指offer 21.调整数组顺序使奇数位于偶数前面</h4><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;  <span class="hljs-comment">//原地交换</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] exchange(<span class="hljs-keyword">int</span>[] nums) &#123;<br>        <span class="hljs-keyword">int</span>  i = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">int</span> tem=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">int</span> j = nums.length-<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span>(i&lt;j)&#123;<br>            <span class="hljs-keyword">if</span>((nums[i]&amp;<span class="hljs-number">1</span>)==<span class="hljs-number">0</span>&amp;&amp;(nums[j]&amp;<span class="hljs-number">1</span>)==<span class="hljs-number">1</span>)&#123;<br>                tem = nums[i];<br>                nums[i] = nums[j];<br>                nums[j] = tem;<br>                i++;<br>                j--;<br>            &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>((nums[i]&amp;<span class="hljs-number">1</span>)==<span class="hljs-number">0</span>&amp;&amp;(nums[j]&amp;<span class="hljs-number">1</span>)==<span class="hljs-number">0</span>)&#123;<br>                j--;<br>            &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>((nums[i]&amp;<span class="hljs-number">1</span>)==<span class="hljs-number">1</span>&amp;&amp;(nums[j]&amp;<span class="hljs-number">1</span>)==<span class="hljs-number">1</span>)&#123;<br>                i++;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                i++;j--;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> nums;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure></li></ul><h2 id="2021-11-16"><a href="#2021-11-16" class="headerlink" title="2021-11-16"></a>2021-11-16</h2><ul><li><h4 id="剑指offer-27-二叉树的镜像"><a href="#剑指offer-27-二叉树的镜像" class="headerlink" title="剑指offer 27.二叉树的镜像"></a>剑指offer 27.二叉树的镜像</h4><p>easy，递归处理</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Definition for a binary tree node.</span><br><span class="hljs-comment"> * public class TreeNode &#123;</span><br><span class="hljs-comment"> *     int val;</span><br><span class="hljs-comment"> *     TreeNode left;</span><br><span class="hljs-comment"> *     TreeNode right;</span><br><span class="hljs-comment"> *     TreeNode(int x) &#123; val = x; &#125;</span><br><span class="hljs-comment"> * &#125;</span><br><span class="hljs-comment"> */</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title">mirrorTree</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(root == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">return</span> reverse(root);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title">reverse</span><span class="hljs-params">(TreeNode root)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(root == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>        TreeNode l = root.left;<br>        TreeNode r = root.right;<br>        root.left = reverse(r);<br>        root.right = reverse(l);<br>        <span class="hljs-keyword">return</span> root;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li><h4 id="剑指offer-11-旋转数组的最小数字"><a href="#剑指offer-11-旋转数组的最小数字" class="headerlink" title="剑指offer 11.旋转数组的最小数字"></a>剑指offer 11.旋转数组的最小数字</h4><p>easy,初始最小设为数组第一个(考虑没有发生旋转的情况)，接着从左往右遍历，当发现下一个比当前的值小，说明下一个是旋转前的头一个，是最小的</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">minArray</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] numbers)</span> </span>&#123;<br>        <span class="hljs-keyword">int</span> len = numbers.length;<br>        <span class="hljs-keyword">int</span> ans = numbers[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;i&lt;len-<span class="hljs-number">1</span>;i++)&#123;<br>            <span class="hljs-keyword">if</span>(numbers[i]&gt;numbers[i+<span class="hljs-number">1</span>])&#123;<br>                ans = numbers[i+<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> ans;<br><br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li><h4 id="剑指offer-12-矩阵中的路径"><a href="#剑指offer-12-矩阵中的路径" class="headerlink" title="剑指offer 12.矩阵中的路径"></a>剑指offer 12.矩阵中的路径</h4><p><img src="/2021/11/15/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/%E5%89%91%E6%8C%8712.png" srcset="/img/loading.gif" lazyload alt="剑指12"></p></li></ul><p>整体思路：DFS+标记位，自己做的时候有大概的思路，但是还是混乱的，在情况分类，边界条件上做了很多无用功，引以为戒。</p><p>DFS的递归思路：</p><p>递归变量：当前值在矩阵中的坐标i,j以及当前判断的目标字符串中的字符在数组中的位置</p><p>递归函数：</p><ol><li>首先判断当前的坐标值，是否在正常的坐标范围内，如果不在，返回false，如果在，进一步判断</li><li>若当前坐标(i,j)出的字符与目标字符相同，且当前坐标未被使用过，flag[i] [j]为false，进一步处理。若不满足要求，说明找不到目标字符，返回false。</li><li>当判断当前位置找到了目标字符时，先将当前位置的标记设为true，即flag[i] [j]为true，接着递归判断当前位置的上下左右四个位置，只要有一个满足情况就说明找到了目标字符串，返回true，否则，说明此路不通，需要将当前位置的标记重新改为false，返回false，只有能走通的路才能被标记位true</li><li>如果当前坐标的字符与目标字符相同，且当前坐标未被访问，目标字符在数组中正好是最后一个，说明已经找到了所有的字符，直接返回true</li></ol><p>初始代码：（极其混乱，注释部分过多代码冗余）</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;<br>    <span class="hljs-keyword">char</span>[] c;<br>    <span class="hljs-keyword">char</span>[][] tem;<br>    <span class="hljs-keyword">boolean</span>[][] flag1;<br>    <span class="hljs-keyword">int</span> length;<br>    <span class="hljs-keyword">int</span> M=<span class="hljs-number">0</span>,N=<span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">exist</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] board, String word)</span> </span>&#123;<br>        c = word.toCharArray();<br>        length = c.length;<br>        tem = board;<br>        <span class="hljs-keyword">int</span> m = board.length; <span class="hljs-comment">//hang</span><br>        <span class="hljs-keyword">int</span> n = board[<span class="hljs-number">0</span>].length; <span class="hljs-comment">//lies</span><br>        M = m;<br>        N = n; <br>        <span class="hljs-keyword">boolean</span>[][] flag = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[m][n];<br>        <span class="hljs-keyword">boolean</span> ans = <span class="hljs-keyword">false</span>;<br>        flag1 = flag;<br>        <span class="hljs-keyword">if</span>(m*n&lt;length) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;i&lt;m;i++)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j =<span class="hljs-number">0</span>;j&lt;n;j++)&#123;<br>                <span class="hljs-keyword">if</span>(tem[i][j]==c[<span class="hljs-number">0</span>])&#123;<br>                     ans = find(i,j,<span class="hljs-number">0</span>);<br>                     <span class="hljs-keyword">if</span>(ans == <span class="hljs-keyword">true</span>)  <span class="hljs-keyword">return</span> ans;<br>                    <span class="hljs-comment">//  for(int a = 0;a&lt;m;a++)&#123;//因为在递归函数里若当前路径没有找到，就会取消标记，因此不用再将所有的标记清除，这会做很多无用功，浪费很多时间</span><br>                    <span class="hljs-comment">//      for(int b = 0;b&lt;n;b++)&#123;</span><br>                    <span class="hljs-comment">//          flag1[a][b] = false;</span><br>                    <span class="hljs-comment">//      &#125;</span><br>                    <span class="hljs-comment">//  &#125;</span><br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i,<span class="hljs-keyword">int</span> j,<span class="hljs-keyword">int</span> x)</span></span>&#123;<br>        <span class="hljs-keyword">boolean</span> ans =<span class="hljs-keyword">false</span>;<br>        <span class="hljs-keyword">if</span>(i&gt;=<span class="hljs-number">0</span>&amp;&amp;i&lt;M&amp;&amp;j&gt;=<span class="hljs-number">0</span>&amp;&amp;j&lt;N)&#123;<br>            <span class="hljs-keyword">if</span>(tem[i][j]==c[x]&amp;&amp;flag1[i][j]==<span class="hljs-keyword">false</span>)&#123;<br>                flag1[i][j] = <span class="hljs-keyword">true</span>;<br>                <span class="hljs-keyword">if</span>(x==length-<span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>                <span class="hljs-comment">// if(i==0&amp;&amp;j==0)&#123;</span><br>                <span class="hljs-comment">//     ans = find(i+1,j,x+1)||find(i,j+1,x+1);</span><br>                <span class="hljs-comment">//     if(ans == true) return true;</span><br>                <span class="hljs-comment">//     flag1[i][j] = false;</span><br>                <span class="hljs-comment">//    // return false;</span><br>                <span class="hljs-comment">//  &#125;</span><br>                <span class="hljs-comment">// if(i==0&amp;&amp;j!=0)&#123;  //因为在一开始会判断坐标是否处于正常的范围，因此不需要在针对坐标做分类处理了，统一去找上下所有即可</span><br>                <span class="hljs-comment">//   ans = find(i,j-1,x+1)||find(i,j+1,x+1)||find(i+1,j,x+1);</span><br>                <span class="hljs-comment">//   if(ans == true) return true;</span><br>                <span class="hljs-comment">//   flag1[i][j] = false;</span><br>                <span class="hljs-comment">//   //return false;</span><br>                <span class="hljs-comment">// &#125;</span><br>                <span class="hljs-comment">// if(i!=0&amp;&amp;j==0)&#123;</span><br>                <span class="hljs-comment">//    ans = find(i-1,j,x+1)||find(i+1,j,x+1)||find(i,j+1,x+1);</span><br>                <span class="hljs-comment">//    if(ans == true) return true;</span><br>                <span class="hljs-comment">//     flag1[i][j] = false;</span><br>                <span class="hljs-comment">//     //return false;</span><br>                <span class="hljs-comment">// &#125;</span><br>                <span class="hljs-comment">// if(i!=0&amp;&amp;j!=0)&#123;</span><br>                ans =  find(i-<span class="hljs-number">1</span>,j,x+<span class="hljs-number">1</span>)||find(i+<span class="hljs-number">1</span>,j,x+<span class="hljs-number">1</span>)||find(i,j+<span class="hljs-number">1</span>,x+<span class="hljs-number">1</span>)||find(i,j-<span class="hljs-number">1</span>,x+<span class="hljs-number">1</span>);<br>                <span class="hljs-keyword">if</span>(ans == <span class="hljs-keyword">true</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>                flag1[i][j] = <span class="hljs-keyword">false</span>;<br>                <span class="hljs-comment">//return false;</span><br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        &#125;<br> &#125;<br></code></pre></div></td></tr></table></figure><p>最终版：</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;<br>    <span class="hljs-keyword">char</span>[] c;<br>    <span class="hljs-keyword">char</span>[][] tem;<br>    <span class="hljs-keyword">boolean</span>[][] flag1;<br>    <span class="hljs-keyword">int</span> length;<br>    <span class="hljs-keyword">int</span> M=<span class="hljs-number">0</span>,N=<span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">exist</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] board, String word)</span> </span>&#123;<br>        c = word.toCharArray();<br>        length = c.length;<br>        tem = board;<br>        <span class="hljs-keyword">int</span> m = board.length; <span class="hljs-comment">//hang</span><br>        <span class="hljs-keyword">int</span> n = board[<span class="hljs-number">0</span>].length; <span class="hljs-comment">//lies</span><br>        M = m;<br>        N = n; <span class="hljs-comment">//保存一些全局变量，包括矩阵的行数和列数，目标字符串数组，标记矩阵等等</span><br>        <span class="hljs-keyword">boolean</span>[][] flag = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[m][n];<br>        <span class="hljs-keyword">boolean</span> ans = <span class="hljs-keyword">false</span>;<br>        flag1 = flag;<br>        <span class="hljs-keyword">if</span>(m*n&lt;length) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;i&lt;m;i++)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j =<span class="hljs-number">0</span>;j&lt;n;j++)&#123;<br>                <span class="hljs-keyword">if</span>(tem[i][j]==c[<span class="hljs-number">0</span>])&#123;  <span class="hljs-comment">//刚开始找第一个字符的时候，应该尝试对所有与目标字符串第一个字符相等的坐标</span><br>                     ans = find(i,j,<span class="hljs-number">0</span>);<br>                     <span class="hljs-keyword">if</span>(ans == <span class="hljs-keyword">true</span>)  <span class="hljs-keyword">return</span> ans;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i,<span class="hljs-keyword">int</span> j,<span class="hljs-keyword">int</span> x)</span></span>&#123;<br>        <span class="hljs-keyword">boolean</span> ans =<span class="hljs-keyword">false</span>;<br>        <span class="hljs-keyword">if</span>(i&gt;=<span class="hljs-number">0</span>&amp;&amp;i&lt;M&amp;&amp;j&gt;=<span class="hljs-number">0</span>&amp;&amp;j&lt;N)&#123;<br>            <span class="hljs-keyword">if</span>(tem[i][j]==c[x]&amp;&amp;flag1[i][j]==<span class="hljs-keyword">false</span>)&#123;<br>                flag1[i][j] = <span class="hljs-keyword">true</span>;<br>                <span class="hljs-keyword">if</span>(x==length-<span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>                ans =  find(i-<span class="hljs-number">1</span>,j,x+<span class="hljs-number">1</span>)||find(i+<span class="hljs-number">1</span>,j,x+<span class="hljs-number">1</span>)||find(i,j+<span class="hljs-number">1</span>,x+<span class="hljs-number">1</span>)||find(i,j-<span class="hljs-number">1</span>,x+<span class="hljs-number">1</span>);<br>                <span class="hljs-keyword">if</span>(ans == <span class="hljs-keyword">true</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>                flag1[i][j] = <span class="hljs-keyword">false</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>   &#125;<br> &#125;<br></code></pre></div></td></tr></table></figure><h2 id="2021-11-15"><a href="#2021-11-15" class="headerlink" title="2021-11-15"></a>2021-11-15</h2><ul><li><h4 id="剑指offer-05-替换空格-very-easy"><a href="#剑指offer-05-替换空格-very-easy" class="headerlink" title="剑指offer 05.替换空格    very easy"></a>剑指offer 05.替换空格    very easy</h4></li></ul><p><img src="/2021/11/15/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/%E5%89%91%E6%8C%8705.png" srcset="/img/loading.gif" lazyload alt="剑指05"></p><p>对于java的string类型，它具有不可变型，使用StringBuilder类型保存结果，遍历s的每个        字符，当遇到空格使，向StringBuilder中加入“%20”，其他情况，加入当前字符。</p><p>主要是好久不做，相关API忘记了。。。</p><p>这里需要复习一下String，StringBuilder，和Stringbuffer的异同。</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">replaceSpace</span><span class="hljs-params">(String s)</span> </span>&#123;<br>            StringBuilder  ans = <span class="hljs-keyword">new</span> StringBuilder();<br>            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">char</span> c:s.toCharArray())<br>            &#123;<br>                <span class="hljs-keyword">if</span>(c==<span class="hljs-string">&#x27; &#x27;</span>)&#123;<br>                    ans.append(<span class="hljs-string">&quot;%20&quot;</span>);<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    ans.append(c);<br>                &#125;<br>            &#125; <br>            <span class="hljs-keyword">return</span> ans.toString();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><ul><li><h4 id="剑指offer-07-重建二叉树"><a href="#剑指offer-07-重建二叉树" class="headerlink" title="剑指offer 07.重建二叉树"></a>剑指offer 07.重建二叉树</h4><p><img src="/2021/11/15/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/%E5%89%91%E6%8C%8707.png" srcset="/img/loading.gif" lazyload alt="剑指07"></p></li></ul><p>关于本题的关键点：</p><ol><li>前序遍历第一个就是根节点，中序遍历的根节点左边就是左子树，右边就是右子树</li><li>前序遍历的结构是[根节点，左子树，右子树]，且左子树和右子树部分的第一个分别是他们的根节点</li><li>中序遍历的结构是[左子树，根节点，右子树]</li><li>所以可以根据这样的结构去递归处理左子树和右子树</li></ol><p>难点主要在于递归的结构，在递归过程中需要传递的变量值，这里使用一个HashMap来存储中序遍历中每个节点值和它在中序遍历的数组中的位置，这样可以在O(1)的条件下获取一个值在中序遍历中的索引。</p><p>递归算法分析：</p><ul><li><p>递归参数：</p><p>root_pre_id：表示根节点在前序遍历中的索引，根据这个id可以获得当前树根节点的值，再根据根节点的值，可以在map中得到在根节点在中序遍历中的索引.</p><p>in_left：当前树在中序遍历中的左边界</p><p>in_right：当前树在中序遍历中的右边界</p><p>根据上述三个参树，每次递归都可以计算出左节点或右节点在前序遍历中的索引，以及左右子树各自的左右边界。</p></li><li><p>终止条件：in_left&gt;in_right，说明已将越过了叶子结点，返回null</p></li><li><p>每一次递归：</p><ol><li><p>计算根据root_pre_id，得到根节点的值，建立根节点</p></li><li><p>根据根节点的值，得到根节点在中序遍历中的索引root_in_id</p></li><li><p>递归左右子树：</p><p>递归变量：</p><p>左子树：左子树根节点在前序遍历中的索引就是当前根节点在前序中的索引+1，即root_pre_id + 1,左子树在中序中的左边界就是当前的左边界，即in_left+1，右边界为当前根节点在中序中的索引-1，即root_in_id - 1</p><p>右子树：右子树的根节点在前序遍历中的索引就是当前根节点在前序中的索引加上左子树的节点数量+1，即root_pre_id+(root_in_id - in_left) + 1，右子树的左边界为root_in_id +1，右边界为当前的右边界in_right</p></li><li><p>返回root</p></li></ol></li></ul><p>代码如下：</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Definition for a binary tree node.</span><br><span class="hljs-comment"> * public class TreeNode &#123;</span><br><span class="hljs-comment"> *     int val;</span><br><span class="hljs-comment"> *     TreeNode left;</span><br><span class="hljs-comment"> *     TreeNode right;</span><br><span class="hljs-comment"> *     TreeNode(int x) &#123; val = x; &#125;</span><br><span class="hljs-comment"> * &#125;</span><br><span class="hljs-comment"> */</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[] pre;<br>    <span class="hljs-keyword">private</span> HashMap&lt;Integer,Integer&gt; id_index = <span class="hljs-keyword">new</span> HashMap&lt;Integer,Integer&gt;();<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title">buildTree</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] preorder, <span class="hljs-keyword">int</span>[] inorder)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.pre = preorder;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;i&lt;inorder.length;i++)&#123;<br>            id_index.put(inorder[i],i);  <span class="hljs-comment">//使用map保存中序数组中的值与索引，避免每一次都遍历</span><br>        &#125;<br>        <span class="hljs-keyword">return</span> build(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,inorder.length-<span class="hljs-number">1</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title">build</span><span class="hljs-params">(<span class="hljs-keyword">int</span> root_pre_id,<span class="hljs-keyword">int</span> in_left,<span class="hljs-keyword">int</span> in_right)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(in_left &gt; in_right)&#123;  <span class="hljs-comment">//终止条件</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>        &#125;<br>        TreeNode root = <span class="hljs-keyword">new</span> TreeNode();  <span class="hljs-comment">//创建当前的根节点</span><br>        root.val = pre[root_pre_id]; <span class="hljs-comment">//获取根节点的值</span><br>        <span class="hljs-keyword">int</span> root_in_id = id_index.get(root.val);  <span class="hljs-comment">//获取根节点在中序中的索引</span><br>        root.left = build(root_pre_id+<span class="hljs-number">1</span>,  in_left,  root_in_id-<span class="hljs-number">1</span>); <span class="hljs-comment">//递归左右子树(根节点的前序索引，中序左边界，中序右边界)</span><br>        root.right = build(root_pre_id+(root_in_id-in_left)+<span class="hljs-number">1</span>,  root_in_id+<span class="hljs-number">1</span>,  in_right);<br>        <span class="hljs-keyword">return</span> root;       <span class="hljs-comment">//根节点前序索引+左子树节点数+1</span><br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><ul><li><h4 id="剑指offer-09-用两个栈实现队列"><a href="#剑指offer-09-用两个栈实现队列" class="headerlink" title="剑指offer 09 用两个栈实现队列"></a>剑指offer 09 用两个栈实现队列</h4><p>思路：先用第一个栈保存数据，从队列尾部添加数据，就是把数据push到第一个栈中，当需要从队列头部取出数据时，现将第一个栈中的数据全部pop到第二个栈中，这样第二个栈的栈顶，就是队列头部的元素，pop出栈顶，再把剩下的元素在pop+push导到第一个站里面</p></li><li><h4 id="剑指offer-10-青蛙跳台阶"><a href="#剑指offer-10-青蛙跳台阶" class="headerlink" title="剑指offer 10 青蛙跳台阶"></a>剑指offer 10 青蛙跳台阶</h4><p>简单DP</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>算法与刷题</category>
      
    </categories>
    
    
    <tags>
      
      <tag>刷题记录</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>四.Redis数据类型</title>
    <link href="/2021/11/11/%E5%9B%9B-Redis%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
    <url>/2021/11/11/%E5%9B%9B-Redis%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="Redis数据类型"><a href="#Redis数据类型" class="headerlink" title="Redis数据类型"></a>Redis数据类型</h1><h2 id="一-String字符串类型"><a href="#一-String字符串类型" class="headerlink" title="一.String字符串类型"></a>一.String字符串类型</h2><figure class="highlight clean"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs clean">########################################################################<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; keys *<br>(empty array)<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; set key1 v1  #设置key1的值为v1<br>OK<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; get key1 #获取key1的值<br><span class="hljs-string">&quot;v1&quot;</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; exists key1  #判断是否存在名为key1的键<br>(integer) <span class="hljs-number">1</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; append key1 <span class="hljs-string">&quot;hello&quot;</span>  #在key1上追加字符串，若key不存在，相当于set key value<br>(integer) <span class="hljs-number">7</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; keys *<br><span class="hljs-number">1</span>) <span class="hljs-string">&quot;key1&quot;</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; append key2 <span class="hljs-string">&quot;abcde&quot;</span> #key2不存在，因此新建key2，并设置value<br>(integer) <span class="hljs-number">5</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; keys *<br><span class="hljs-number">1</span>) <span class="hljs-string">&quot;key2&quot;</span><br><span class="hljs-number">2</span>) <span class="hljs-string">&quot;key1&quot;</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; strlen key1  #获取key的长度<br>(integer) <span class="hljs-number">7</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; append key1 <span class="hljs-string">&quot;12345&quot;</span><br>(integer) <span class="hljs-number">12</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; strlen key1<br>(integer) <span class="hljs-number">12</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; get key1<br><span class="hljs-string">&quot;v1hello12345&quot;</span><br>#########################################################################<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; set views <span class="hljs-number">0</span><br>OK<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; get views<br><span class="hljs-string">&quot;0&quot;</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; incr views #自增<span class="hljs-number">1</span><br>(integer) <span class="hljs-number">1</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; get views<br><span class="hljs-string">&quot;1&quot;</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; decr views<br>(integer) <span class="hljs-number">0</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; get views<br><span class="hljs-string">&quot;0&quot;</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; decr views #自减<span class="hljs-number">1</span><br>(integer) <span class="hljs-number">-1</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; get views<br><span class="hljs-string">&quot;-1&quot;</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; incrby views <span class="hljs-number">10</span> #设置步长，相当于views = views+<span class="hljs-number">10</span><br>(integer) <span class="hljs-number">9</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; get views<br><span class="hljs-string">&quot;9&quot;</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; decrby views <span class="hljs-number">8</span> #设置步长，相当于views = views<span class="hljs-number">-10</span><br>(integer) <span class="hljs-number">1</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; get views<br><span class="hljs-string">&quot;1&quot;</span><br>################################################################<br>#获取一个字符串指定范围的字串  getrange key start end  <span class="hljs-comment">//end为负的就获取全部串</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; set key1 helloworld<br>OK<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; get key1<br><span class="hljs-string">&quot;helloworld&quot;</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; getrange key1 <span class="hljs-number">0</span> <span class="hljs-number">3</span>  #截取字串[<span class="hljs-number">0</span>,<span class="hljs-number">3</span>]<br><span class="hljs-string">&quot;hell&quot;</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; getrange key1 <span class="hljs-number">0</span> <span class="hljs-number">-1</span><br><span class="hljs-string">&quot;helloworld&quot;</span><br><br>#替换指定范围的字串  setrange key offset new_value 从指定的偏移量开始将key的值替换为new_value<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; set key2 abcdefg<br>OK<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; get key2<br><span class="hljs-string">&quot;abcdefg&quot;</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; setrange key2 <span class="hljs-number">2</span> <span class="hljs-number">123</span><br>(integer) <span class="hljs-number">7</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; get key2<br><span class="hljs-string">&quot;ab123fg&quot;</span><br>###############################################################<br>#setex (set <span class="hljs-keyword">with</span> expire) 设置过期时间<br>#setnx (set <span class="hljs-keyword">if</span> not exist) 如果不存在再设置<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; setex key3 <span class="hljs-number">30</span> <span class="hljs-string">&quot;hello&quot;</span>  <span class="hljs-comment">//设置keys的值为hello，且过期时间为30秒</span><br>OK<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; get key3 <span class="hljs-comment">//未达到过期时间，可以查到key3</span><br><span class="hljs-string">&quot;hello&quot;</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; ttl key3 <span class="hljs-comment">//key3的剩余时间</span><br>(integer) <span class="hljs-number">23</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; setnx mykey <span class="hljs-number">123456</span>  <span class="hljs-comment">//如果mykey不存在，设置mykey的值</span><br>OK<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; ttl key3  <span class="hljs-comment">//key3已经过期</span><br>(integer) <span class="hljs-number">-2</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; keys * <span class="hljs-comment">//查看所有keys，因为key3已将过期，所以不存在key3</span><br><span class="hljs-number">1</span>) <span class="hljs-string">&quot;mykey&quot;</span><br><span class="hljs-number">2</span>) <span class="hljs-string">&quot;key2&quot;</span><br><span class="hljs-number">3</span>) <span class="hljs-string">&quot;key1&quot;</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; setnx mykey <span class="hljs-string">&quot;566868&quot;</span> <span class="hljs-comment">//如果mykey不存在，那么设置值为566868</span><br>(integer) <span class="hljs-number">0</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; get mykey <span class="hljs-comment">//因为mykey一直存在，所以上面的setnx没有成功，返回值为0，</span><br><span class="hljs-string">&quot;123456&quot;</span>                  <span class="hljs-comment">//mykey还是原来的值</span><br>###############################################################<br>mset key1 value1 key2 value2 ...... 批量设置键值<br>mget key1 key2......批量获取键值<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; mset k1 v1 k2 v2 k3 v3<br>OK<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; keys *<br><span class="hljs-number">1</span>) <span class="hljs-string">&quot;k3&quot;</span><br><span class="hljs-number">2</span>) <span class="hljs-string">&quot;k2&quot;</span><br><span class="hljs-number">3</span>) <span class="hljs-string">&quot;k1&quot;</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; mget k1 k2 k3<br><span class="hljs-number">1</span>) <span class="hljs-string">&quot;v1&quot;</span><br><span class="hljs-number">2</span>) <span class="hljs-string">&quot;v2&quot;</span><br><span class="hljs-number">3</span>) <span class="hljs-string">&quot;v3&quot;</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; msetnx k1 m1 k4 v4  <span class="hljs-comment">//mset是原子性操作，要么全部成功，要么全部失败，类似事务，因为k1存在，set失败，所以k4的设置也失败，下面看到返回值为0，key4为null，k1的值不变</span><br>(integer) <span class="hljs-number">0</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; get k4<br>(nil)<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; get k1<br><span class="hljs-string">&quot;v1&quot;</span><br><br>##设置一个对象<br>set user:<span class="hljs-number">1</span> &#123;name:zhangsan,age:<span class="hljs-number">18</span>&#125;  #设置一个user:<span class="hljs-number">1</span>对象的值为json字符串来保存一个对象<br>#这里的key很巧妙，user:&#123;uid&#125;:&#123;属性&#125;,如此设置在redis中完全ok<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; mset user:<span class="hljs-number">1</span>:name zhangsan  user:<span class="hljs-number">1</span>:age <span class="hljs-number">18</span><br>OK    <span class="hljs-comment">//他把user:1:name当做一个key来存，user:1:age当做一个key来存</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; mget user:<span class="hljs-number">1</span>:name user:<span class="hljs-number">1</span>:age<br><span class="hljs-number">1</span>) <span class="hljs-string">&quot;zhangsan&quot;</span><br><span class="hljs-number">2</span>) <span class="hljs-string">&quot;18&quot;</span><br><br><span class="hljs-comment">//getset 组合命令，先获取再设置</span><br><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; getset db redis   <span class="hljs-comment">//如果事先没有值，则返回null</span><br>(nil)<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; getset db mongodb  <span class="hljs-comment">//如果当前存在值，则返回当前值在设置</span><br><span class="hljs-string">&quot;redis&quot;</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span>&gt; get db<br><span class="hljs-string">&quot;mongodb&quot;</span><br>###################################################<br></code></pre></div></td></tr></table></figure><p>String类的使用场景： value可以使字符串，还可以是数字</p><ul><li>做计数器</li><li>统计多单位的数量  uid:123455:follower 0</li><li>粉丝数</li><li>对象缓存存储</li></ul><h2 id="二-List类型"><a href="#二-List类型" class="headerlink" title="二.List类型"></a>二.List类型</h2><p>在redis中，list可以当做栈，队列，双端队列，或阻塞队列来使用</p><p>所有有关list的命令，都是字母’L’开头的</p><p>基本命令使用：</p><figure class="highlight xquery"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xquery">key为操作的列表的名字<br>- LPUSH<span class="hljs-built_in"> key</span> <span class="hljs-keyword">value</span> [<span class="hljs-keyword">value</span>....]   从队列的左边入队一个或多个元素<br>ps: 在队列中，编号是从左到右为<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>，如果前面LPUSH一个元素后，他的编号为<span class="hljs-number">0</span>，继续LPUSH一个元素，此时他的编号变成了<span class="hljs-number">1</span><br>- LPUSHX<span class="hljs-built_in"> key</span> <span class="hljs-keyword">value</span>如果队列存在，从队列的左边入队一个元素<br>- LRANGE<span class="hljs-built_in"> key</span> <span class="hljs-keyword">start</span> <span class="hljs-keyword">end</span>从列表中取出指定编号范围内的元素，<span class="hljs-number">0</span>，-<span class="hljs-number">1</span>为取出所有<br>- LREM<span class="hljs-built_in"> key</span><span class="hljs-built_in"> count</span> <span class="hljs-keyword">value</span>从列表中删除元素，注意元素的<span class="hljs-keyword">value</span>必须明确指定<span class="hljs-built_in">，count</span>为删除的<span class="hljs-keyword">value</span>的个数<br>- LSET<span class="hljs-built_in"> key</span> index <span class="hljs-keyword">value</span>设置列表中编号为index的元素的值<br>- LTRIM<span class="hljs-built_in"> key</span> <span class="hljs-keyword">start</span> <span class="hljs-keyword">end</span>修建指定范围内的数据，语句执行结束后，原来<span class="hljs-built_in">的key</span>中只保存范围内的值，其他的都被删除<br>- RPOP<span class="hljs-built_in"> key</span>从队列的右边出队一个元素<br>- RPOPLPUSH source destination 删除source列表中最后一个元素(pop出最右边的)，并追加到另一个列表(并加到另一个队列左边)<br>- RPUSH<span class="hljs-built_in"> key</span> <span class="hljs-keyword">value</span> [<span class="hljs-keyword">value</span>....] 从队列的右边入队一个或多个元素<br>- RPUSHX<span class="hljs-built_in"> key</span> <span class="hljs-keyword">value</span> 如果队列存在，从队列的右边入队一个元素<br>- LLEN<span class="hljs-built_in"> key</span> 获取列<span class="hljs-built_in">表key</span>的元素个数<br>- LINSERT<span class="hljs-built_in"> key</span> [BEFORE/AFTER] pivot <span class="hljs-keyword">value</span> 在列<span class="hljs-built_in">表key</span>的元素pivot前面或后面插入元素<span class="hljs-keyword">value</span><br></code></pre></div></td></tr></table></figure><p>如果key不存在，push时创建列表</p><p>如果移除了key的所有值，key为空链表，也相当于不存在</p><p>在llist的两边插入或改动元素时，效率最高，修改中间元素或插到中间，效率相低</p><p>适用场景：消息排队，消息队列(LPUSH,RPOP)，栈(LPUSH,LPOP)</p><h2 id="三-Set类型"><a href="#三-Set类型" class="headerlink" title="三.Set类型"></a>三.Set类型</h2><p>与java中的set类似，不允许元素重复</p><p>与set相关的命令，都以字母‘S’开头</p><p>基本命令：</p><figure class="highlight maxima"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs maxima">- SADD <span class="hljs-built_in">key</span> <span class="hljs-built_in">member</span> [<span class="hljs-built_in">member</span>...]添加一个或多个元素到集合中<br>- SCARD <span class="hljs-built_in">key</span>获取集合中的元素数量<br>- SISMEMBER <span class="hljs-built_in">key</span> <span class="hljs-built_in">member</span> 判断<span class="hljs-built_in">member</span>元素是否在集合<span class="hljs-built_in">key</span>中<br>- SMEMBERS <span class="hljs-built_in">key</span>获取集合中的所有元素<br>- SMOVE source destination <span class="hljs-built_in">member</span>把集合source中的一个元素<span class="hljs-built_in">member</span>移动到另一个集合中，source中将不再有该<span class="hljs-built_in">member</span><br>- SREM <span class="hljs-built_in">key</span> <span class="hljs-built_in">member</span> [<span class="hljs-built_in">member</span>...]删除集合中的一个或多个元素<br>- SPOP <span class="hljs-built_in">key</span> [count]删除并获取集合中的一个元素，由于元素时无序的，因此<span class="hljs-built_in">pop</span>出哪一个不知道，count指定个数<br>- SRANDMEMBER <span class="hljs-built_in">key</span> [count]从集合中随机取获取一个元素<br>- SDIFF key1 key2 求key1与key2的差集，即key1中存在，但是key2中不存在的<br>- SINTER <span class="hljs-built_in">key</span> [<span class="hljs-built_in">key</span>...]求集合间的交集<br>- SINTERSTORE destination <span class="hljs-built_in">key</span> [<span class="hljs-built_in">key</span>...]求集合间的交集,并保存新集合destination中<br>- SUNION <span class="hljs-built_in">key</span> [<span class="hljs-built_in">key</span>...]求集合间的并集<br>- SUNIONSTORE destination <span class="hljs-built_in">key</span> [<span class="hljs-built_in">key</span>...]求集合间的并集,并保存新集合destination中<br></code></pre></div></td></tr></table></figure><p>适用场景：</p><p>微博中，将A用户的所有关注的人放在一个set集合中，将他的粉丝也放到一个集合中</p><p>共同关注求交集，求推荐好友等</p><h2 id="四-Hash-哈希"><a href="#四-Hash-哈希" class="headerlink" title="四.Hash(哈希)"></a>四.Hash(哈希)</h2><p>Map集合，key为一个集合，存放的元素为kv对</p><p>和string的集合差不对，只不过string集合存放单个value，Map集合存放kv</p><p>基本命令：</p><figure class="highlight gauss"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gauss">- HSET <span class="hljs-built_in">key</span> field value设置集合<span class="hljs-built_in">key</span>中的kv对<br>- HSETNX <span class="hljs-built_in">key</span> field value如果当前的kv不存在，设置kv<br>- HMSET <span class="hljs-built_in">key</span> field value [field value....]批量设置集合<span class="hljs-built_in">key</span>中的kv对<br>- HGET <span class="hljs-built_in">key</span> field获取集合<span class="hljs-built_in">key</span>中键为field的value<br>- HGETALL <span class="hljs-built_in">key</span>读取<span class="hljs-built_in">key</span>中的所有域和值，field和value都有<br>- HMGET <span class="hljs-built_in">key</span> field [field...]批量获取集合<span class="hljs-built_in">key</span>中键为field的value<br>- HLEN <span class="hljs-built_in">key</span>获取<span class="hljs-built_in">key</span>集合中所有字段的数量<br>- HKEYS <span class="hljs-built_in">key</span> 获取<span class="hljs-built_in">key</span>中的所有field字段<br>- HVALS <span class="hljs-built_in">key</span> 获取<span class="hljs-built_in">key</span>中的所有value值<br>- HEXISTS <span class="hljs-built_in">key</span> field   判断field是否存在于<span class="hljs-built_in">key</span>中<br>- HDEL <span class="hljs-built_in">key</span> field [field...]    删除一个或多个field，对应的value也会删除<br>- HINCRBY <span class="hljs-built_in">key</span> field increment将<span class="hljs-built_in">key</span>中指定域的值(value)增加给定的数字<br>- HINCRBYFLOAT <span class="hljs-built_in">key</span> field increment将<span class="hljs-built_in">key</span>中指定域的值(value)增加给定的浮点数<br></code></pre></div></td></tr></table></figure><p>相对于String类型，hash更适合对象的存储，string更适合字符串的存储，当然也可以用string存储对象</p><h2 id="五-Zset-有序集合"><a href="#五-Zset-有序集合" class="headerlink" title="五.Zset(有序集合)"></a>五.Zset(有序集合)</h2><p>在set的基础上，增加了一个score值     set key value    zset key  score  value</p><p>基本命令:</p><figure class="highlight maxima"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs maxima">- ZADD <span class="hljs-built_in">key</span> score <span class="hljs-built_in">member</span> [score <span class="hljs-built_in">member</span>....]添加一个或多个成员到一个有序的set，如果已经存在，那么更新分数<br>- ZCARD <span class="hljs-built_in">key</span>  获取一个排序集合中成员的数量<br>- ZCOUNT <span class="hljs-built_in">key</span> <span class="hljs-built_in">min</span> <span class="hljs-built_in">max</span>返回分数在指定范围内的成员数量<br>- ZINCRBY <span class="hljs-built_in">key</span> increment <span class="hljs-built_in">member</span>  将指定的成员的score增加increment<br>- ZRANGE <span class="hljs-built_in">key</span> start stop 根据指定的index返回范围内的成员<br>- ZRANK <span class="hljs-built_in">key</span> <span class="hljs-built_in">member</span> 返回<span class="hljs-built_in">member</span>在排序集合中的索引<br>- ZREM <span class="hljs-built_in">key</span> <span class="hljs-built_in">member</span> 删除一个成员<br></code></pre></div></td></tr></table></figure><p>适用场景：</p><p>对set排序，班级成绩，工资排序，带权重的成员，排行榜等等</p><h2 id="六-三种特殊的类型"><a href="#六-三种特殊的类型" class="headerlink" title="六.三种特殊的类型"></a>六.三种特殊的类型</h2><ul><li>Geospatial 地理位置类型</li><li>Hyperlog 基数统计类型</li><li>Bitmap 位图场景</li></ul><p>写吐了，需要用的时候还是查官方文档吧。。。🐶</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="http://www.redis.cn/">redis中文官方网站</a></p><p><a href="https://redis.io/commands">Command reference – Redis</a></p>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HUST数据库实验</title>
    <link href="/2021/11/11/HUST%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C/"/>
    <url>/2021/11/11/HUST%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C/</url>
    
    <content type="html"><![CDATA[<h1 id="HUST网安数据库实验"><a href="#HUST网安数据库实验" class="headerlink" title="HUST网安数据库实验"></a>HUST网安数据库实验</h1><div class="note note-success">            <p>单纯的sql语句练习。。。</p>          </div><div class="note note-danger">            <p>如有错误，还请指正，不胜感激！🤣</p>          </div><h2 id="实验一-SQL基础练习"><a href="#实验一-SQL基础练习" class="headerlink" title="实验一.SQL基础练习"></a>实验一.SQL基础练习</h2><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc">1.create database CSEDB_学号;<br><span class="hljs-comment">//2-8为前面几个表操作语句的联系，但一顿搞之后得到的表结构可能与指导书上的结构不一致</span><br><span class="hljs-comment">//在进行insert之前，可以先把库删了，重新建库，直接使用4.5.(1)里的三个建表语句</span><br>2.创建表student(具体数据类型char的大小感觉多少就行，影响不大)<br>mysql&gt; create table Student(<br><span class="hljs-code">    -&gt; Sno char(9) primary key,</span><br><span class="hljs-code">    -&gt; Sname char(20) unique,</span><br><span class="hljs-code">    -&gt; Ssex char(2),</span><br><span class="hljs-code">    -&gt; Sage  int,</span><br><span class="hljs-code">    -&gt; Sdept char(20),</span><br><span class="hljs-code">    -&gt; Scholarshhip char(2))</span><br><span class="hljs-code">    -&gt; ;</span><br>Query OK, 0 rows affected (0.12 sec)<br><br><span class="hljs-section">mysql&gt; show columns from student;</span><br><span class="hljs-section">+--------------+----------+------+-----+---------+-------+</span><br><span class="hljs-section">| Field        | Type     | Null | Key | Default | Extra |</span><br><span class="hljs-section">+--------------+----------+------+-----+---------+-------+</span><br>| Sno          | char(9)  | NO   | PRI | NULL    |       |<br>| Sname        | char(20) | YES  | UNI | NULL    |       |<br>| Ssex         | char(2)  | YES  |     | NULL    |       |<br>| Sage         | int      | YES  |     | NULL    |       |<br>| Sdept        | char(20) | YES  |     | NULL    |       |<br><span class="hljs-section">| Scholarshhip | char(2)  | YES  |     | NULL    |       |</span><br><span class="hljs-section">+--------------+----------+------+-----+---------+-------+</span><br>6 rows in set (0.02 sec)<br><br>ps: 唯一键可以为空，主键不能为空<br><br>3.创建表course<br>mysql&gt; create table Course(<br><span class="hljs-code">    -&gt; Cno char(4) primary key,</span><br><span class="hljs-code">    -&gt; Cname char(40) unique,</span><br><span class="hljs-code">    -&gt; Cpno char(4),</span><br><span class="hljs-code">    -&gt; Ccredit int)</span><br><span class="hljs-code">    -&gt; ;</span><br>Query OK, 0 rows affected (0.07 sec)<br><br><span class="hljs-section">mysql&gt; show columns from course;</span><br><span class="hljs-section">+---------+----------+------+-----+---------+-------+</span><br><span class="hljs-section">| Field   | Type     | Null | Key | Default | Extra |</span><br><span class="hljs-section">+---------+----------+------+-----+---------+-------+</span><br>| Cno     | char(4)  | NO   | PRI | NULL    |       |<br>| Cname   | char(40) | YES  | UNI | NULL    |       |<br>| Cpno    | char(4)  | YES  |     | NULL    |       |<br><span class="hljs-section">| Ccredit | int      | YES  |     | NULL    |       |</span><br><span class="hljs-section">+---------+----------+------+-----+---------+-------+</span><br>4 rows in set (0.00 sec)<br><br>4.创建表sc<br>mysql&gt; create table sc(<br><span class="hljs-code">    -&gt; sno char(5),</span><br><span class="hljs-code">    -&gt; cno char(3),</span><br><span class="hljs-code">    -&gt; grade int,</span><br><span class="hljs-code">    -&gt; primary key (sno,cno)</span><br><span class="hljs-code">    -&gt; );</span><br>Query OK, 0 rows affected (0.03 sec)<br><br><span class="hljs-section">mysql&gt; show columns from Sc;</span><br><span class="hljs-section">+-------+---------+------+-----+---------+-------+</span><br><span class="hljs-section">| Field | Type    | Null | Key | Default | Extra |</span><br><span class="hljs-section">+-------+---------+------+-----+---------+-------+</span><br>| Sno   | char(9) | NO   | PRI | NULL    |       |<br>| Cno   | char(4) | NO   | PRI | NULL    |       |<br><span class="hljs-section">| Grade | int     | YES  |     | NULL    |       |</span><br><span class="hljs-section">+-------+---------+------+-----+---------+-------+</span><br>3 rows in set (0.00 sec)<br><br>5，删除表<br><span class="hljs-section">mysql&gt; show tables;</span><br><span class="hljs-section">+----------------------------+</span><br><span class="hljs-section">| Tables_in_csedb_u201911749 |</span><br><span class="hljs-section">+----------------------------+</span><br>| course                     |<br>| sc                         |<br><span class="hljs-section">| student                    |</span><br><span class="hljs-section">+----------------------------+</span><br>3 rows in set (0.00 sec)<br><br>mysql&gt; drop tables sc;<br>Query OK, 0 rows affected (0.02 sec)<br><br><span class="hljs-section">mysql&gt; show tables;</span><br><span class="hljs-section">+----------------------------+</span><br><span class="hljs-section">| Tables_in_csedb_u201911749 |</span><br><span class="hljs-section">+----------------------------+</span><br>| course                     |<br><span class="hljs-section">| student                    |</span><br><span class="hljs-section">+----------------------------+</span><br>2 rows in set (0.00 sec)<br><br>6.更改表结构（增加/删除一列，更改表字段类型）<br><span class="hljs-section">mysql&gt; show columns from student;</span><br><span class="hljs-section">+--------------+----------+------+-----+---------+-------+</span><br><span class="hljs-section">| Field        | Type     | Null | Key | Default | Extra |</span><br><span class="hljs-section">+--------------+----------+------+-----+---------+-------+</span><br>| Sno          | char(9)  | NO   | PRI | NULL    |       |<br>| Sname        | char(20) | YES  | UNI | NULL    |       |<br>| Ssex         | char(2)  | YES  |     | NULL    |       |<br>| Sage         | int      | YES  |     | NULL    |       |<br>| Sdept        | char(20) | YES  |     | NULL    |       |<br><span class="hljs-section">| Scholarshhip | char(2)  | YES  |     | NULL    |       |</span><br><span class="hljs-section">+--------------+----------+------+-----+---------+-------+</span><br>6 rows in set (0.00 sec)<br><span class="hljs-comment">//添加列 alter table 表名 add column(加不加都行) 列名  列属性;</span><br>mysql&gt; alter table student add Scome datetime;<br>Query OK, 0 rows affected (0.04 sec)<br>Records: 0  Duplicates: 0  Warnings: 0<br><span class="hljs-comment">//删除列 alter table 表名 drop column(加不加都行) 列名;</span><br>mysql&gt; alter table student drop column scome;<br>Query OK, 0 rows affected (0.08 sec)<br>Records: 0  Duplicates: 0  Warnings: 0<br><span class="hljs-comment">//修改列属性 alter table 表名 modify column(加不加都行) 列名  列属性;</span><br>mysql&gt; alter table student modify column sage smallint;<br>Query OK, 0 rows affected (0.12 sec)<br>Records: 0  Duplicates: 0  Warnings: 0<br><br><span class="hljs-section">mysql&gt; show columns from student;</span><br><span class="hljs-section">+--------------+----------+------+-----+---------+-------+</span><br><span class="hljs-section">| Field        | Type     | Null | Key | Default | Extra |</span><br><span class="hljs-section">+--------------+----------+------+-----+---------+-------+</span><br>| Sno          | char(9)  | NO   | PRI | NULL    |       |<br>| Sname        | char(20) | YES  | UNI | NULL    |       |<br>| Ssex         | char(2)  | YES  |     | NULL    |       |<br>| Sage         | smallint | YES  |     | NULL    |       |<br>| Sdept        | char(20) | YES  |     | NULL    |       |<br>| Scholarshhip | char(2)  | YES  |     | NULL    |       |<br><span class="hljs-section">| Scome        | datetime | YES  |     | NULL    |       |</span><br><span class="hljs-section">+--------------+----------+------+-----+---------+-------+</span><br>7 rows in set (0.00 sec)<br><br>7.创建索引，删除索引<br>mysql&gt; create unique index stusno on student(sno);<br>Query OK, 0 rows affected, 1 warning (0.04 sec)<br>Records: 0  Duplicates: 0  Warnings: 1<br>##第一种删除方式<br>mysql&gt; drop index stusno on student;<br>Query OK, 0 rows affected (0.02 sec)<br>Records: 0  Duplicates: 0  Warnings: 0<br>##第二种删除方式<br>mysql&gt; alter table student drop index stusno;<br>Query OK, 0 rows affected (0.02 sec)<br>Records: 0  Duplicates: 0  Warnings: 0<br>##第三种删除方式，删除主键索引<br>alter table 表名 drop primary key;<br>##第四种删除方式，删除外键索引<br>alter table 表名 drop foreign key 外键名；//未检验<br><br>8.按照指导书的要求，建立三个表之间的关系，就是设置外键<br>mysql&gt; alter table course add foreign key (cpno) references course(cno);<br>Query OK, 0 rows affected (0.11 sec)<br>Records: 0  Duplicates: 0  Warnings: 0<br><br>mysql&gt; alter table sc add foreign key (sno) references student(sno);<br>Query OK, 0 rows affected (0.09 sec)<br>Records: 0  Duplicates: 0  Warnings: 0<br><br>mysql&gt; alter table sc add foreign key (cno) references course(cno);<br>Query OK, 0 rows affected (0.13 sec)<br>Records: 0  Duplicates: 0  Warnings: 0<br>注意外键约束！！！<br>ps:设置外键之后，如果想要修改父表的话，需要设置一个级联操作命令，当在操作父表时，子表会受到相同的影响，如果没有设置级联操作，更改父表会报错。<br>级联操作：<br><span class="hljs-code">主表更新</span><br><span class="hljs-code">语法形式为：on update[级联操作]</span><br><span class="hljs-code">主表删除</span><br><span class="hljs-code">语法形式为：on delete[级联操作]</span><br><span class="hljs-code">这里的级联操作常见的有三种形式：</span><br><span class="hljs-code">cascade：同步操作，或者串联操作！也就是当主表记录删除或更新的时候，从表也进行相应的删除   更新！</span><br><span class="hljs-code">set null：设置为null，也就是当主表记录删除或更新的时候，从表中的外键字段设置为空</span><br><span class="hljs-code">restrict：拒绝主表的更新或删除</span><br><span class="hljs-code"></span><br>9.添加数据(insert)<br>语法规则：<br><span class="hljs-code">1. 指定向那些列插入值：</span><br><span class="hljs-code">insert into table_name ( field1, field2,...fieldN )</span><br><span class="hljs-code">                       values</span><br><span class="hljs-code">                       ( value1, value2,...valueN );</span><br><span class="hljs-code">    2. 如果插入的数据覆盖所有的列，则不用指定插入列的范围</span><br><span class="hljs-code">    insert into table_name</span><br><span class="hljs-code">       values</span><br><span class="hljs-code">       ( value1, value2,...valueN );</span><br>ps: 所有符号都必须是英文符号<br>向student表中插入数据：<br>mysql&gt; insert into student values(<span class="hljs-emphasis">&#x27;200215121&#x27;</span>,<span class="hljs-emphasis">&#x27;李勇&#x27;</span>,<span class="hljs-emphasis">&#x27;男&#x27;</span>,20,<span class="hljs-emphasis">&#x27;CS&#x27;</span>,<span class="hljs-emphasis">&#x27;否&#x27;</span>);<br>Query OK, 1 row affected (0.01 sec)<br><br>mysql&gt; insert into student values(<span class="hljs-emphasis">&#x27;200215122&#x27;</span>,<span class="hljs-emphasis">&#x27;刘晨&#x27;</span>,<span class="hljs-emphasis">&#x27;女&#x27;</span>,19,<span class="hljs-emphasis">&#x27;CS&#x27;</span>,<span class="hljs-emphasis">&#x27;否&#x27;</span>);<br>Query OK, 1 row affected (0.00 sec)<br><br>mysql&gt; insert into student values(<span class="hljs-emphasis">&#x27;200215123&#x27;</span>,<span class="hljs-emphasis">&#x27;王敏&#x27;</span>,<span class="hljs-emphasis">&#x27;女&#x27;</span>,18,<span class="hljs-emphasis">&#x27;MA&#x27;</span>,<span class="hljs-emphasis">&#x27;否&#x27;</span>);<br>Query OK, 1 row affected (0.00 sec)<br><br>mysql&gt; insert into student values(<span class="hljs-emphasis">&#x27;200215125&#x27;</span>,<span class="hljs-emphasis">&#x27;张立&#x27;</span>,<span class="hljs-emphasis">&#x27;男&#x27;</span>,19,<span class="hljs-emphasis">&#x27;IS&#x27;</span>,<span class="hljs-emphasis">&#x27;否&#x27;</span>);<br>Query OK, 1 row affected (0.01 sec)<br><br><span class="hljs-section">mysql&gt; select * from student;</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br><span class="hljs-section">| Sno       | Sname | Ssex | Sage | Sdept | Scholarship |</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br>| 200215121 | 李勇  | 男   |   20 | CS    | 否          |<br>| 200215122 | 刘晨  | 女   |   19 | CS    | 否          |<br>| 200215123 | 王敏  | 女   |   18 | MA    | 否          |<br><span class="hljs-section">| 200215125 | 张立  | 男   |   19 | IS    | 否          |</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br>4 rows in set (0.01 sec)<br>向course表中插入数据：<br>insert into course values(<span class="hljs-emphasis">&#x27;1&#x27;</span>,<span class="hljs-emphasis">&#x27;数据库&#x27;</span>,NULL,4);<br>insert into course values(<span class="hljs-emphasis">&#x27;2&#x27;</span>,<span class="hljs-emphasis">&#x27;数学&#x27;</span>,NULL,2);<br>insert into course values(<span class="hljs-emphasis">&#x27;3&#x27;</span>,<span class="hljs-emphasis">&#x27;信息系统&#x27;</span>,NULL,4);<br>insert into course values(<span class="hljs-emphasis">&#x27;4&#x27;</span>,<span class="hljs-emphasis">&#x27;操作系统&#x27;</span>,NULL,3);<br>insert into course values(<span class="hljs-emphasis">&#x27;5&#x27;</span>,<span class="hljs-emphasis">&#x27;数据结构&#x27;</span>,NULL,4);<br>insert into course values(<span class="hljs-emphasis">&#x27;6&#x27;</span>,<span class="hljs-emphasis">&#x27;数据处理&#x27;</span>,NULL,2);<br>insert into course values(<span class="hljs-emphasis">&#x27;7&#x27;</span>,<span class="hljs-emphasis">&#x27;java&#x27;</span>,NULL,4);<br>向sc表中插入数据：<br>insert into SC values(<span class="hljs-emphasis">&#x27;200215121&#x27;</span>,<span class="hljs-emphasis">&#x27;1&#x27;</span>,92);<br>insert into SC values(<span class="hljs-emphasis">&#x27;200215121&#x27;</span>,<span class="hljs-emphasis">&#x27;2&#x27;</span>,85);<br>insert into SC values(<span class="hljs-emphasis">&#x27;200215121&#x27;</span>,<span class="hljs-emphasis">&#x27;3&#x27;</span>,88);<br>insert into SC values(<span class="hljs-emphasis">&#x27;200215122&#x27;</span>,<span class="hljs-emphasis">&#x27;2&#x27;</span>,90);<br>insert into SC values(<span class="hljs-emphasis">&#x27;200215122&#x27;</span>,<span class="hljs-emphasis">&#x27;3&#x27;</span>,80);<br><br>10.更新数据(update)<br>语法规则：<br><span class="hljs-code">UPDATE [LOW_PRIORITY] [IGNORE] table_name </span><br><span class="hljs-code">SET field1=new-value1, field2=new-value2</span><br><span class="hljs-code">[WHERE Clause]</span><br><span class="hljs-code">[ORDER BY ...]</span><br><span class="hljs-code">[LIMIT ROW_COUNT]</span><br>更新courseb表数据：<br>update Course set Cpno = <span class="hljs-emphasis">&#x27;5&#x27;</span> where Cno = <span class="hljs-emphasis">&#x27;1&#x27;</span>;<br>update Course set Cpno = <span class="hljs-emphasis">&#x27;1&#x27;</span> where Cno = <span class="hljs-emphasis">&#x27;3&#x27;</span>;<br>update Course set Cpno = <span class="hljs-emphasis">&#x27;6&#x27;</span> where Cno = <span class="hljs-emphasis">&#x27;4&#x27;</span>;<br>update Course set Cpno = <span class="hljs-emphasis">&#x27;7&#x27;</span> where Cno = <span class="hljs-emphasis">&#x27;5&#x27;</span>;<br>update Course set Cpno = <span class="hljs-emphasis">&#x27;6&#x27;</span> where Cno = <span class="hljs-emphasis">&#x27;7&#x27;</span>;<br><br>11.删除数据(delete)<br>语法规则：<br><span class="hljs-code">delete from table_name [where clause]</span><br><span class="hljs-code">如果没有指定where，则删除表中所有数据</span><br><br><span class="hljs-section">mysql&gt; select * from student;</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br><span class="hljs-section">| Sno       | Sname | Ssex | Sage | Sdept | Scholarship |</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br>| 200215121 | 李勇  | 男   |   20 | CS    | 否          |<br><span class="hljs-section">| 200215122 | 刘晨  | 女   |   19 | CS    | 否          |</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br>2 rows in set (0.01 sec)<br><br>mysql&gt; delete from student;<br>Query OK, 2 rows affected (0.02 sec)<br><br>mysql&gt; select * from student;<br>Empty set (0.00 sec)<br><br>12.扩展练习：<br>（1）查询全体学生的学号、姓名和年龄；<br>mysql&gt; select sno,sname,sage<br><span class="hljs-section">    -&gt; from student;</span><br><span class="hljs-section">+-----------+-------+------+</span><br><span class="hljs-section">| sno       | sname | sage |</span><br><span class="hljs-section">+-----------+-------+------+</span><br>| 200215121 | 李勇  |   20 |<br>| 200215122 | 刘晨  |   19 |<br>| 200215123 | 王敏  |   18 |<br><span class="hljs-section">| 200215125 | 张立  |   19 |</span><br><span class="hljs-section">+-----------+-------+------+</span><br>4 rows in set (0.00 sec)<br>（2）查询所有计算机系学生的详细记录；<br>mysql&gt; select *<br><span class="hljs-code">    -&gt; from student</span><br><span class="hljs-section">    -&gt; where sdept = &#x27;CS&#x27;;</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br><span class="hljs-section">| Sno       | Sname | Ssex | Sage | Sdept | Scholarship |</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br>| 200215121 | 李勇  | 男   |   20 | CS    | 否          |<br><span class="hljs-section">| 200215122 | 刘晨  | 女   |   19 | CS    | 否          |</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br>2 rows in set (0.00 sec)<br>（3）找出考试成绩为优秀（90 分及以上）或不及格的学生的学号、课程号及成绩；<br>mysql&gt; select *<br><span class="hljs-code">    -&gt; from sc</span><br><span class="hljs-section">    -&gt; where grade &gt;= 90 or grade &lt;60;</span><br><span class="hljs-section">+-----------+-----+-------+</span><br><span class="hljs-section">| Sno       | Cno | Grade |</span><br><span class="hljs-section">+-----------+-----+-------+</span><br>| 200215121 | 1   |    92 |<br><span class="hljs-section">| 200215122 | 2   |    90 |</span><br><span class="hljs-section">+-----------+-----+-------+</span><br>2 rows in set (0.00 sec)<br>（4）查询年龄不在 19~20 岁之间的学生姓名、性别和年龄；<br>mysql&gt; select sname,ssex,sage<br><span class="hljs-code">    -&gt; from student</span><br><span class="hljs-section">    -&gt; where sage not in (19,20);</span><br><span class="hljs-section">+-------+------+------+</span><br><span class="hljs-section">| sname | ssex | sage |</span><br><span class="hljs-section">+-------+------+------+</span><br><span class="hljs-section">| 王敏  | 女   |   18 |</span><br><span class="hljs-section">+-------+------+------+</span><br>1 row in set (0.00 sec)<br>（5）查询数学系（MA）、信息系（IS)的学生的姓名和所在系；<br>mysql&gt; select sname,sdept<br><span class="hljs-code">    -&gt; from student</span><br><span class="hljs-section">    -&gt; where sdept in (&#x27;CS&#x27;,&#x27;MA&#x27;);</span><br><span class="hljs-section">+-------+-------+</span><br><span class="hljs-section">| sname | sdept |</span><br><span class="hljs-section">+-------+-------+</span><br>| 李勇  | CS    |<br>| 刘晨  | CS    |<br><span class="hljs-section">| 王敏  | MA    |</span><br><span class="hljs-section">+-------+-------+</span><br>3 rows in set (0.00 sec)<br>（6）查询名称中包含“数据”的所有课程的课程号、课程名及其学分；<br>mysql&gt; select cno,cname,ccredit<br><span class="hljs-code">    -&gt; from course</span><br><span class="hljs-section">    -&gt; where cname like &#x27;%数据%&#x27;;</span><br><span class="hljs-section">+-----+----------+---------+</span><br><span class="hljs-section">| cno | cname    | ccredit |</span><br><span class="hljs-section">+-----+----------+---------+</span><br>| 1   | 数据库   |       4 |<br>| 5   | 数据结构 |       4 |<br><span class="hljs-section">| 6   | 数据处理 |       2 |</span><br><span class="hljs-section">+-----+----------+---------+</span><br>3 rows in set (0.00 sec)<br>（7) 找出所有没有选修课成绩的学生学号和课程号；<br>mysql&gt; select distinct sno,cno<br><span class="hljs-code">    -&gt; from student,course</span><br><span class="hljs-section">    -&gt; where sno not in(select distinct sno from sc) and cno not in (select distinct cno from sc);</span><br><span class="hljs-section">+-----------+-----+</span><br><span class="hljs-section">| sno       | cno |</span><br><span class="hljs-section">+-----------+-----+</span><br>| 200215123 | 6   |<br>| 200215125 | 6   |<br>| 200215123 | 4   |<br>| 200215125 | 4   |<br>| 200215123 | 7   |<br>| 200215125 | 7   |<br>| 200215123 | 5   |<br><span class="hljs-section">| 200215125 | 5   |</span><br><span class="hljs-section">+-----------+-----+</span><br>8 rows in set (0.00 sec)<br>（8）查询学生 200215121 选修课的最高分、最低分以及平均成绩；<br>mysql&gt; select max(grade),min(grade),avg(grade)<br><span class="hljs-code">    -&gt; from sc</span><br><span class="hljs-section">    -&gt; where sno = &#x27;200215121&#x27;;</span><br><span class="hljs-section">+------------+------------+------------+</span><br><span class="hljs-section">| max(grade) | min(grade) | avg(grade) |</span><br><span class="hljs-section">+------------+------------+------------+</span><br><span class="hljs-section">|         92 |         85 |    88.3333 |</span><br><span class="hljs-section">+------------+------------+------------+</span><br>1 row in set (0.01 sec)<br>（9）查询选修了 2 号课程的学生的学号及其成绩，查询结果按成绩升序排列；<br>mysql&gt; select sno,grade<br><span class="hljs-code">    -&gt; from sc</span><br><span class="hljs-code">    -&gt; where cno = &#x27;2&#x27;</span><br><span class="hljs-section">    -&gt; order by grade;</span><br><span class="hljs-section">+-----------+-------+</span><br><span class="hljs-section">| sno       | grade |</span><br><span class="hljs-section">+-----------+-------+</span><br>| 200215121 |    85 |<br><span class="hljs-section">| 200215122 |    90 |</span><br><span class="hljs-section">+-----------+-------+</span><br>2 rows in set (0.00 sec)<br>（10）查询每个系名及其学生的平均年龄。<br>mysql&gt; select sdept,avg(sage)<br><span class="hljs-code">    -&gt; from student</span><br><span class="hljs-section">    -&gt; group by sdept;</span><br><span class="hljs-section">+-------+-----------+</span><br><span class="hljs-section">| sdept | avg(sage) |</span><br><span class="hljs-section">+-------+-----------+</span><br>| CS    |   19.5000 |<br>| MA    |   18.0000 |<br><span class="hljs-section">| IS    |   19.0000 |</span><br><span class="hljs-section">+-------+-----------+</span><br>3 rows in set (0.01 sec)<br><span class="hljs-code"> （思考：如何查询学生平均年龄在 19 岁以下（含 19 岁）的系别及其学生的平均年龄？）</span><br><span class="hljs-code"> mysql&gt; select sdept,avg(sage)</span><br><span class="hljs-code">    -&gt; from student</span><br><span class="hljs-code">    -&gt; group by sdept</span><br><span class="hljs-section">    -&gt; having avg(sage)&lt;=19;</span><br><span class="hljs-section">+-------+-----------+</span><br><span class="hljs-section">| sdept | avg(sage) |</span><br><span class="hljs-section">+-------+-----------+</span><br>| MA    |   18.0000 |<br><span class="hljs-section">| IS    |   19.0000 |</span><br><span class="hljs-section">+-------+-----------+</span><br>2 rows in set (0.01 sec)<br><br>ps：where用于过滤指定的行，它后面的判断数据必须是存在的行，having用于对前面select的结果进行筛选，但having不一定非要配合group by使用，如果我前面select的结果中没有，就不能用having<br>总的来说，where直接对数据表中的字段进行直接筛选，而having是对前面筛选的结果进行筛选<br>参考链接:https://blog.csdn.net/yexudengzhidao/article/details/54924471<br>参考链接:https://www.jianshu.com/p/e66abfadcdca<br></code></pre></div></td></tr></table></figure><h2 id="实验二-SQL复杂操作练习"><a href="#实验二-SQL复杂操作练习" class="headerlink" title="实验二.SQL复杂操作练习"></a>实验二.SQL复杂操作练习</h2><p><img src="/2021/11/11/HUST%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C/1.png" srcset="/img/loading.gif" lazyload alt="1"></p><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc">（1）查询每门课程及其被选情况（输出所有课程中每门课的课程号、课程名称、选修该课程的学生<br>学号及成绩--如果没有学生选择该课，则相应的学生学号及成绩为空值）。<br>mysql&gt; select course.cno,cname,sno,grade<br><span class="hljs-section">    -&gt; from course left outer join sc on (course.cno = sc.cno);</span><br><span class="hljs-section">+-----+----------+-----------+-------+</span><br><span class="hljs-section">| cno | cname    | sno       | grade |</span><br><span class="hljs-section">+-----+----------+-----------+-------+</span><br>| 1   | 数据库   | 200215121 |    92 |<br>| 2   | 数学     | 200215122 |    90 |<br>| 2   | 数学     | 200215121 |    85 |<br>| 3   | 信息系统 | 200215122 |    80 |<br>| 3   | 信息系统 | 200215121 |    88 |<br>| 4   | 操作系统 | NULL      |  NULL |<br>| 5   | 数据结构 | NULL      |  NULL |<br>| 6   | 数据处理 | NULL      |  NULL |<br><span class="hljs-section">| 7   | java     | NULL      |  NULL |</span><br><span class="hljs-section">+-----+----------+-----------+-------+</span><br>9 rows in set (0.00 sec)<br><br>（2）查询与“张立”同岁的学生的学号、姓名和年龄。（要求使用至少 3 种方法求解）<br>第一种：<br>mysql&gt; select sno,sname,sage<br><span class="hljs-code">-&gt; from student</span><br><span class="hljs-section">-&gt; where sage = (select sage from student where sname = &#x27;张立&#x27;);</span><br><span class="hljs-section">+-----------+-------+------+</span><br><span class="hljs-section">| sno       | sname | sage |</span><br><span class="hljs-section">+-----------+-------+------+</span><br>| 200215122 | 刘晨  |   19 |<br><span class="hljs-section">| 200215125 | 张立  |   19 |</span><br><span class="hljs-section">+-----------+-------+------+</span><br>第二种：<br>mysql&gt; select sno,sname,sage<br><span class="hljs-code">    -&gt; from student</span><br><span class="hljs-section">    -&gt; where sage in(select sage from student where sname = &#x27;张立&#x27;);</span><br><span class="hljs-section">+-----------+-------+------+</span><br><span class="hljs-section">| sno       | sname | sage |</span><br><span class="hljs-section">+-----------+-------+------+</span><br>| 200215122 | 刘晨  |   19 |<br><span class="hljs-section">| 200215125 | 张立  |   19 |</span><br><span class="hljs-section">+-----------+-------+------+</span><br>2 rows in set (0.00 sec)<br>2 rows in set (0.01 sec)<br>第三种：(无语-_-)<br>mysql&gt; select s1.sno,s1.sname,s1.sage<br><span class="hljs-code">    -&gt; from student s1,student s2</span><br><span class="hljs-section">    -&gt; where s1.sage = s2.sage and s2.sname = &#x27;张立&#x27;;</span><br><span class="hljs-section">+-----------+-------+------+</span><br><span class="hljs-section">| sno       | sname | sage |</span><br><span class="hljs-section">+-----------+-------+------+</span><br>| 200215122 | 刘晨  |   19 |<br><span class="hljs-section">| 200215125 | 张立  |   19 |</span><br><span class="hljs-section">+-----------+-------+------+</span><br>2 rows in set (0.00 sec)<br><br>（3）查询选修了 3 号课程而且成绩为良好（80~89 分）的所有学生的学号和姓名。<br>mysql&gt; select student.sno,student.sname<br><span class="hljs-code">    -&gt; from student,sc</span><br><span class="hljs-section">    -&gt; where student.sno = sc.sno and sc.cno = &#x27;3&#x27; and sc.grade &gt;=80 and sc.grade &lt;=89;</span><br><span class="hljs-section">+-----------+-------+</span><br><span class="hljs-section">| sno       | sname |</span><br><span class="hljs-section">+-----------+-------+</span><br>| 200215121 | 李勇  |<br><span class="hljs-section">| 200215122 | 刘晨  |</span><br><span class="hljs-section">+-----------+-------+</span><br>2 rows in set (0.00 sec)<br><br>（4）查询学生 200215122 选修的课程号、课程名<br>mysql&gt; select course.cno,course.cname<br><span class="hljs-code">    -&gt; from course,sc</span><br><span class="hljs-section">    -&gt; where course.cno = sc.cno and sc.sno = &#x27;200215122&#x27;;</span><br><span class="hljs-section">+-----+----------+</span><br><span class="hljs-section">| cno | cname    |</span><br><span class="hljs-section">+-----+----------+</span><br>| 2   | 数学     |<br><span class="hljs-section">| 3   | 信息系统 |</span><br><span class="hljs-section">+-----+----------+</span><br>2 rows in set (0.00 sec)<br><span class="hljs-code"> （思考：如何查询学生 200215122 选修的课程号、课程名及成绩？）</span><br><span class="hljs-code"> mysql&gt; select course.cno,course.cname,sc.grade</span><br><span class="hljs-code">    -&gt; from course,sc</span><br><span class="hljs-section">    -&gt; where course.cno = sc.cno and sc.sno = &#x27;200215122&#x27;;</span><br><span class="hljs-section">+-----+----------+-------+</span><br><span class="hljs-section">| cno | cname    | grade |</span><br><span class="hljs-section">+-----+----------+-------+</span><br>| 2   | 数学     |    90 |<br><span class="hljs-section">| 3   | 信息系统 |    80 |</span><br><span class="hljs-section">+-----+----------+-------+</span><br>2 rows in set (0.00 sec)<br><br>（5）找出每个学生低于他所选修课程平均成绩 5 分以上的课程号。（输出学号和课程号）<br>mysql&gt; select sno,cno<br><span class="hljs-code">    -&gt; from sc s1</span><br><span class="hljs-code">    -&gt; where s1.grade+5&lt; (select avg(grade) from sc s2 where s1.sno = s2.sno);</span><br>Empty set (0.00 sec)<br><br>mysql&gt; select sno,cno<br><span class="hljs-code">    -&gt; from sc s1</span><br><span class="hljs-section">    -&gt; where s1.grade+5&lt;= (select avg(grade) from sc s2 where s1.sno = s2.sno);</span><br><span class="hljs-section">+-----------+-----+</span><br><span class="hljs-section">| sno       | cno |</span><br><span class="hljs-section">+-----------+-----+</span><br><span class="hljs-section">| 200215122 | 3   |</span><br><span class="hljs-section">+-----------+-----+</span><br>1 row in set (0.00 sec)<br><br>（6）查询比所有男生年龄都小的女生的学号、姓名和年龄。<br><span class="hljs-comment">//当前表</span><br><span class="hljs-section">mysql&gt; select * from student;</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br><span class="hljs-section">| Sno       | Sname | Ssex | Sage | Sdept | Scholarship |</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br>| 200215121 | 李勇  | 男   |   21 | CS    | 否          |<br>| 200215122 | 刘晨  | 女   |   20 | CS    | 否          |<br>| 200215123 | 王敏  | 女   |   19 | MA    | 否          |<br>| 200215125 | 张立  | 男   |   20 | IS    | 否          |<br>| 200215126 | 张三  | 女   |   19 | IS    | 否          |<br><span class="hljs-section">| 200215128 | 李四  | 男   |   21 | IS    | 否          |</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br>6 rows in set (0.00 sec)<br><br>mysql&gt; select sno,sname,sage<br><span class="hljs-code">    -&gt; from student</span><br><span class="hljs-section">    -&gt; where ssex = &#x27;女&#x27; and sage &lt;(select min(sage) from student where ssex = &#x27;男&#x27;);</span><br><span class="hljs-section">+-----------+-------+------+</span><br><span class="hljs-section">| sno       | sname | sage |</span><br><span class="hljs-section">+-----------+-------+------+</span><br>| 200215123 | 王敏  |   19 |<br><span class="hljs-section">| 200215126 | 张三  |   19 |</span><br><span class="hljs-section">+-----------+-------+------+</span><br>2 rows in set (0.01 sec)<br>（7）查询所有选修了 2 号课程的学生姓名及所在系。<br>mysql&gt; select sname,sdept<br><span class="hljs-code">    -&gt; from student,sc</span><br><span class="hljs-section">    -&gt; where sc.cno = &#x27;2&#x27; and student.sno = sc.sno;</span><br><span class="hljs-section">+-------+-------+</span><br><span class="hljs-section">| sname | sdept |</span><br><span class="hljs-section">+-------+-------+</span><br>| 李勇  | CS    |<br><span class="hljs-section">| 刘晨  | CS    |</span><br><span class="hljs-section">+-------+-------+</span><br>2 rows in set (0.00 sec)<br><br>（8）使用 update 语句把成绩为良的学生的年龄增加 2 岁，并查询出来。<br><span class="hljs-section">mysql&gt; select * from student;</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br><span class="hljs-section">| Sno       | Sname | Ssex | Sage | Sdept | Scholarship |</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br>| 200215121 | 李勇  | 男   |   20 | CS    | 否          |<br>| 200215122 | 刘晨  | 女   |   19 | CS    | 否          |<br>| 200215123 | 王敏  | 女   |   18 | MA    | 否          |<br><span class="hljs-section">| 200215125 | 张立  | 男   |   19 | IS    | 否          |</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br>4 rows in set (0.00 sec)<br><br><span class="hljs-section">mysql&gt; select * from sc;</span><br><span class="hljs-section">+-----------+-----+-------+</span><br><span class="hljs-section">| Sno       | Cno | Grade |</span><br><span class="hljs-section">+-----------+-----+-------+</span><br>| 200215121 | 1   |    92 |<br>| 200215121 | 2   |    85 |<br>| 200215121 | 3   |    88 |<br>| 200215122 | 2   |    90 |<br><span class="hljs-section">| 200215122 | 3   |    80 |</span><br><span class="hljs-section">+-----------+-----+-------+</span><br>5 rows in set (0.00 sec)<br><br>mysql&gt; update student<br><span class="hljs-code">    -&gt; set student.sage = student.sage+2</span><br><span class="hljs-code">    -&gt; where student.sno in(</span><br><span class="hljs-code">    -&gt; select sc.sno</span><br><span class="hljs-code">    -&gt; from sc</span><br><span class="hljs-code">    -&gt; where sc.grade &gt;=80 and sc.grade&lt;=89);</span><br>Query OK, 2 rows affected (0.01 sec)<br>Rows matched: 2  Changed: 2  Warnings: 0<br><br><span class="hljs-section">mysql&gt; select * from student;</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br><span class="hljs-section">| Sno       | Sname | Ssex | Sage | Sdept | Scholarship |</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br>| 200215121 | 李勇  | 男   |   22 | CS    | 否          |<br>| 200215122 | 刘晨  | 女   |   21 | CS    | 否          |<br>| 200215123 | 王敏  | 女   |   18 | MA    | 否          |<br><span class="hljs-section">| 200215125 | 张立  | 男   |   19 | IS    | 否          |</span><br><span class="hljs-section">+-----------+-------+------+------+-------+-------------+</span><br>4 rows in set (0.00 sec)<br><br>（9）使用 insert 语句增加两门课程：C 语言和人工智能，并查询出来<br><span class="hljs-section">mysql&gt; select * from course;</span><br><span class="hljs-section">+-----+----------+------+---------+</span><br><span class="hljs-section">| Cno | Cname    | Cpno | Ccredit |</span><br><span class="hljs-section">+-----+----------+------+---------+</span><br>| 1   | 数据库   | 5    |       4 |<br>| 2   | 数学     | NULL |       2 |<br>| 3   | 信息系统 | 1    |       4 |<br>| 4   | 操作系统 | 6    |       3 |<br>| 5   | 数据结构 | 7    |       4 |<br>| 6   | 数据处理 | NULL |       2 |<br><span class="hljs-section">| 7   | java     | 6    |       4 |</span><br><span class="hljs-section">+-----+----------+------+---------+</span><br>7 rows in set (0.00 sec)<br><br>mysql&gt; insert into course(cno,cname)<br><span class="hljs-code">    -&gt; values (&#x27;22&#x27;,&#x27;C语言&#x27;);</span><br>Query OK, 1 row affected (0.00 sec)<br><br>mysql&gt; insert into course(cno,cname)<br><span class="hljs-code">    -&gt; values (&#x27;88&#x27;,&#x27;人工智能&#x27;);</span><br>Query OK, 1 row affected (0.00 sec)<br><br><span class="hljs-section">mysql&gt; select * from course;</span><br><span class="hljs-section">+-----+----------+------+---------+</span><br><span class="hljs-section">| Cno | Cname    | Cpno | Ccredit |</span><br><span class="hljs-section">+-----+----------+------+---------+</span><br>| 1   | 数据库   | 5    |       4 |<br>| 2   | 数学     | NULL |       2 |<br>| 22  | C语言    | NULL |    NULL |<br>| 3   | 信息系统 | 1    |       4 |<br>| 4   | 操作系统 | 6    |       3 |<br>| 5   | 数据结构 | 7    |       4 |<br>| 6   | 数据处理 | NULL |       2 |<br>| 7   | java     | 6    |       4 |<br><span class="hljs-section">| 88  | 人工智能 | NULL |    NULL |</span><br><span class="hljs-section">+-----+----------+------+---------+</span><br>9 rows in set (0.00 sec)<br><br>（10）使用 delete 语句把人工智能课程删除，并查询出来。<br>mysql&gt; delete from course<br><span class="hljs-code">    -&gt; where cname = &#x27;人工智能&#x27;;</span><br>Query OK, 1 row affected (0.00 sec)<br><br><span class="hljs-section">mysql&gt; select * from course;</span><br><span class="hljs-section">+-----+----------+------+---------+</span><br><span class="hljs-section">| Cno | Cname    | Cpno | Ccredit |</span><br><span class="hljs-section">+-----+----------+------+---------+</span><br>| 1   | 数据库   | 5    |       4 |<br>| 2   | 数学     | NULL |       2 |<br>| 22  | C语言    | NULL |    NULL |<br>| 3   | 信息系统 | 1    |       4 |<br>| 4   | 操作系统 | 6    |       3 |<br>| 5   | 数据结构 | 7    |       4 |<br>| 6   | 数据处理 | NULL |       2 |<br><span class="hljs-section">| 7   | java     | 6    |       4 |</span><br><span class="hljs-section">+-----+----------+------+---------+</span><br>8 rows in set (0.00 sec)<br></code></pre></div></td></tr></table></figure><h2 id="实验三-SQL高级实验"><a href="#实验三-SQL高级实验" class="headerlink" title="实验三.SQL高级实验"></a>实验三.SQL高级实验</h2><figure class="highlight gherkin"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gherkin">(1)创建 CS 系的视图 CS_View<br><br>mysql&gt; create view cs_view as<br>    -&gt; select <span class="hljs-symbol">*</span><br>    -&gt; from student<br>    -&gt; where sdept = &#x27;CS&#x27;;<br>Query OK, 0 rows affected (0.04 sec)<br><br>mysql&gt; select <span class="hljs-symbol">*</span> from cs_view;<br>+-----------+-------+------+------+-------+-------------+<br>|<span class="hljs-string"> Sno       </span>|<span class="hljs-string"> Sname </span>|<span class="hljs-string"> Ssex </span>|<span class="hljs-string"> Sage </span>|<span class="hljs-string"> Sdept </span>|<span class="hljs-string"> Scholarship </span>|<br>+-----------+-------+------+------+-------+-------------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇  </span>|<span class="hljs-string"> 男   </span>|<span class="hljs-string">   20 </span>|<span class="hljs-string"> CS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 刘晨  </span>|<span class="hljs-string"> 女   </span>|<span class="hljs-string">   19 </span>|<span class="hljs-string"> CS    </span>|<span class="hljs-string"> 否          </span>|<br>+-----------+-------+------+------+-------+-------------+<br>2 rows in set (0.02 sec)<br>(2)在视图 CS_View 上查询 CS 系选修了 1 号课程的学生<br><br>mysql&gt; select cs_view.sno,sname,sage<br>    -&gt; from cs_view,sc<br>    -&gt; where cs_view.sno = sc.sno and sc.cno = &#x27;1&#x27;;<br>+-----------+-------+------+<br>|<span class="hljs-string"> Sno       </span>|<span class="hljs-string"> Sname </span>|<span class="hljs-string"> Sage </span>|<br>+-----------+-------+------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇  </span>|<span class="hljs-string">   20 </span>|<br>+-----------+-------+------+<br>1 row in set (0.02 sec)<br>(3)创建 IS 系成绩大于 80 的学生的视图 IS_View<br>mysql&gt; select <span class="hljs-symbol">*</span> from student;<br>+-----------+-------+------+------+-------+-------------+<br>|<span class="hljs-string"> Sno       </span>|<span class="hljs-string"> Sname </span>|<span class="hljs-string"> Ssex </span>|<span class="hljs-string"> Sage </span>|<span class="hljs-string"> Sdept </span>|<span class="hljs-string"> Scholarship </span>|<br>+-----------+-------+------+------+-------+-------------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇  </span>|<span class="hljs-string"> 男   </span>|<span class="hljs-string">   20 </span>|<span class="hljs-string"> CS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 刘晨  </span>|<span class="hljs-string"> 女   </span>|<span class="hljs-string">   19 </span>|<span class="hljs-string"> CS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215123 </span>|<span class="hljs-string"> 王敏  </span>|<span class="hljs-string"> 女   </span>|<span class="hljs-string">   18 </span>|<span class="hljs-string"> MA    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215125 </span>|<span class="hljs-string"> 张立  </span>|<span class="hljs-string"> 男   </span>|<span class="hljs-string">   19 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215126 </span>|<span class="hljs-string"> 张三  </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> NULL        </span>|<br>|<span class="hljs-string"> 200215128 </span>|<span class="hljs-string"> 李四  </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> NULL        </span>|<br>+-----------+-------+------+------+-------+-------------+<br>6 rows in set (0.00 sec)<br><br>mysql&gt; select <span class="hljs-symbol">*</span> from sc;<br>+-----------+-----+-------+<br>|<span class="hljs-string"> Sno       </span>|<span class="hljs-string"> Cno </span>|<span class="hljs-string"> Grade </span>|<br>+-----------+-----+-------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 1   </span>|<span class="hljs-string">    92 </span>|<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 2   </span>|<span class="hljs-string">    85 </span>|<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    88 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 2   </span>|<span class="hljs-string">    90 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    80 </span>|<br>|<span class="hljs-string"> 200215125 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    79 </span>|<br>|<span class="hljs-string"> 200215126 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    90 </span>|<br>|<span class="hljs-string"> 200215128 </span>|<span class="hljs-string"> 1   </span>|<span class="hljs-string">    88 </span>|<br>+-----------+-----+-------+<br>8 rows in set (0.00 sec)<br><br>mysql&gt; create view is_view as<br>    -&gt; select student.sno,sname,sage,ssex,sdept,cno,grade<br>    -&gt; from student,sc<br>    -&gt; where sdept = &#x27;IS&#x27; and student.sno = sc.sno and sc.grade &gt;=80;<br>Query OK, 0 rows affected (0.02 sec)<br><br>mysql&gt; select <span class="hljs-symbol">*</span> from is_view;<br>+-----------+-------+------+------+-------+-----+-------+<br>|<span class="hljs-string"> sno       </span>|<span class="hljs-string"> sname </span>|<span class="hljs-string"> sage </span>|<span class="hljs-string"> ssex </span>|<span class="hljs-string"> sdept </span>|<span class="hljs-string"> cno </span>|<span class="hljs-string"> grade </span>|<br>+-----------+-------+------+------+-------+-----+-------+<br>|<span class="hljs-string"> 200215126 </span>|<span class="hljs-string"> 张三  </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    90 </span>|<br>|<span class="hljs-string"> 200215128 </span>|<span class="hljs-string"> 李四  </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 1   </span>|<span class="hljs-string">    88 </span>|<br>+-----------+-------+------+------+-------+-----+-------+<br>2 rows in set (0.01 sec)<br>(4)在视图 IS_View 查询 IS 系成绩大于 80 的学生<br>mysql&gt; select <span class="hljs-symbol">*</span> from is_view where grade &gt;=80;<br>+-----------+-------+------+------+-------+-----+-------+<br>|<span class="hljs-string"> sno       </span>|<span class="hljs-string"> sname </span>|<span class="hljs-string"> sage </span>|<span class="hljs-string"> ssex </span>|<span class="hljs-string"> sdept </span>|<span class="hljs-string"> cno </span>|<span class="hljs-string"> grade </span>|<br>+-----------+-------+------+------+-------+-----+-------+<br>|<span class="hljs-string"> 200215126 </span>|<span class="hljs-string"> 张三  </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    90 </span>|<br>|<span class="hljs-string"> 200215128 </span>|<span class="hljs-string"> 李四  </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 1   </span>|<span class="hljs-string">    88 </span>|<br>+-----------+-------+------+------+-------+-----+-------+<br>2 rows in set (0.01 sec)<br>(5)删除视图 IS_View<br>mysql&gt; drop view is_view;<br>Query OK, 0 rows affected (0.02 sec)<br><br>mysql&gt; select <span class="hljs-symbol">*</span> from is_view;<br>ERROR 1146 (42S02): Table &#x27;csedb_u201911749.is_view&#x27; doesn&#x27;t exist<br>(6) 利用可视化窗口创建 2 个不同的用户 U1 和 U2,利用系统管理员给 U1 授予 Student 表的<br>查询和更新的权限，给 U2 对 SC 表授予插入的权限。然后用 U1 登录，分别 1）查询学生表<br>的信息；2）把所有学生的年龄增加 1 岁，然后查询；3）删除 IS 系的学生；4）查询 CS 系<br>的选课信息。用 U2 登录，分别 1）在 SC 表中插入 1 条记录（‘200215122’，‘1’，75）；2）<br>查询 SC 表的信息，3）查询视图 CS_View 的信息。<br>//创建用户u1<br>mysql&gt; create user &#x27;u1&#x27;<span class="hljs-meta">@&#x27;%&#x27;</span> identified by &#x27;123456&#x27;;<br>Query OK, 0 rows affected (0.05 sec)<br>//创建用户u2<br>mysql&gt; create user &#x27;u2&#x27;<span class="hljs-meta">@&#x27;%&#x27;</span> identified by &#x27;123456&#x27;;<br>Query OK, 0 rows affected (0.01 sec)<br>//为u1设置权限<br>mysql&gt; grant select,update on student to &#x27;u1&#x27;<span class="hljs-meta">@&#x27;%&#x27;;</span><br>Query OK, 0 rows affected (0.01 sec)<br>//为u2设置权限<br>mysql&gt; grant insert on sc to &#x27;u2&#x27;<span class="hljs-meta">@&#x27;%&#x27;;</span><br>Query OK, 0 rows affected (0.01 sec)<br>//刷新权限<br>mysql&gt; flush privileges;<br>Query OK, 0 rows affected (0.02 sec)<br>//查看用户<br>mysql&gt; SELECT DISTINCT CONCAT(&#x27;User: &#x27;&#x27;&#x27;,user,&#x27;&#x27;&#x27;<span class="hljs-meta">@&#x27;&#x27;&#x27;,host,&#x27;&#x27;&#x27;;&#x27;)</span> AS query FROM mysql.user;<br>+---------------------------------------+<br>|<span class="hljs-string"> query                                 </span>|<br>+---------------------------------------+<br>|<span class="hljs-string"> User: &#x27;u1&#x27;@&#x27;%&#x27;;                       </span>|<br>|<span class="hljs-string"> User: &#x27;u2&#x27;@&#x27;%&#x27;;                       </span>|<br>|<span class="hljs-string"> User: &#x27;mysql.infoschema&#x27;@&#x27;localhost&#x27;; </span>|<br>|<span class="hljs-string"> User: &#x27;mysql.session&#x27;@&#x27;localhost&#x27;;    </span>|<br>|<span class="hljs-string"> User: &#x27;mysql.sys&#x27;@&#x27;localhost&#x27;;        </span>|<br>|<span class="hljs-string"> User: &#x27;root&#x27;@&#x27;localhost&#x27;;             </span>|<br>+---------------------------------------+<br>6 rows in set (0.00 sec)<br>//命令行以不同的用户登录，先设置mysql环境变量，cmd命令行使用：mysql -u u1 -p 密码 以用户u1登录<br><span class="hljs-comment">###############################################################################</span><br>C:\Users\Ke&gt;mysql -u u1 -p<br>Enter password: <span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><br>Welcome to the MySQL monitor.  Commands end with ; or \g.<br>Your MySQL connection id is 12<br><br>mysql&gt; show databases;<br>+--------------------+<br>|<span class="hljs-string"> Database           </span>|<br>+--------------------+<br>|<span class="hljs-string"> csedb_u201911749   </span>|<br>|<span class="hljs-string"> information_schema </span>|<br>+--------------------+<br>2 rows in set (0.01 sec)<br><br>mysql&gt; use csedb_u201911749<br>Database changed<br>mysql&gt; show tables;   //可以看到，u1用户由于管理员设置的权限，只能看到student<br>+----------------------------+<br>|<span class="hljs-string"> Tables_in_csedb_u201911749 </span>|<br>+----------------------------+<br>|<span class="hljs-string"> student                    </span>|<br>+----------------------------+<br>1 row in set (0.00 sec)<br>//u1查询student表<br>mysql&gt; select <span class="hljs-symbol">*</span> from student;<br>+-----------+--------+------+------+-------+-------------+<br>|<span class="hljs-string"> Sno       </span>|<span class="hljs-string"> Sname  </span>|<span class="hljs-string"> Ssex </span>|<span class="hljs-string"> Sage </span>|<span class="hljs-string"> Sdept </span>|<span class="hljs-string"> Scholarship </span>|<br>+-----------+--------+------+------+-------+-------------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇   </span>|<span class="hljs-string"> 男   </span>|<span class="hljs-string">   20 </span>|<span class="hljs-string"> CS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 刘晨   </span>|<span class="hljs-string"> 女   </span>|<span class="hljs-string">   19 </span>|<span class="hljs-string"> CS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215123 </span>|<span class="hljs-string"> 王敏   </span>|<span class="hljs-string"> 女   </span>|<span class="hljs-string">   18 </span>|<span class="hljs-string"> MA    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215125 </span>|<span class="hljs-string"> 张立   </span>|<span class="hljs-string"> 男   </span>|<span class="hljs-string">   19 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215126 </span>|<span class="hljs-string"> 张三   </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string">   18 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> NULL        </span>|<br>|<span class="hljs-string"> 200215128 </span>|<span class="hljs-string"> 李四   </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string">   20 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> NULL        </span>|<br>+-----------+--------+------+------+-------+-------------+<br>6 rows in set (0.00 sec)<br>//u1更新年龄<br>mysql&gt; update student<br>    -&gt; set sage = sage+1;<br>Query OK, 6 rows affected (0.01 sec)<br>Rows matched: 6  Changed: 6  Warnings: 0<br>//u1重新查询student<br>mysql&gt; select <span class="hljs-symbol">*</span> from student;<br>+-----------+--------+------+------+-------+-------------+<br>|<span class="hljs-string"> Sno       </span>|<span class="hljs-string"> Sname  </span>|<span class="hljs-string"> Ssex </span>|<span class="hljs-string"> Sage </span>|<span class="hljs-string"> Sdept </span>|<span class="hljs-string"> Scholarship </span>|<br>+-----------+--------+------+------+-------+-------------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇   </span>|<span class="hljs-string"> 男   </span>|<span class="hljs-string">   21 </span>|<span class="hljs-string"> CS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 刘晨   </span>|<span class="hljs-string"> 女   </span>|<span class="hljs-string">   20 </span>|<span class="hljs-string"> CS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215123 </span>|<span class="hljs-string"> 王敏   </span>|<span class="hljs-string"> 女   </span>|<span class="hljs-string">   19 </span>|<span class="hljs-string"> MA    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215125 </span>|<span class="hljs-string"> 张立   </span>|<span class="hljs-string"> 男   </span>|<span class="hljs-string">   20 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215126 </span>|<span class="hljs-string"> 张三   </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string">   19 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> NULL        </span>|<br>|<span class="hljs-string"> 200215128 </span>|<span class="hljs-string"> 李四   </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string">   21 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> NULL        </span>|<br>+-----------+--------+------+------+-------+-------------+<br>6 rows in set (0.00 sec)<br><br>mysql&gt; delete from student<br>    -&gt; where sdept = &#x27;IS&#x27;;<br>ERROR 1142 (42000): DELETE command denied to user &#x27;u1&#x27;<span class="hljs-meta">@&#x27;localhost&#x27;</span> for table &#x27;student&#x27;   //u1没有权限<br>mysql&gt; select sc.sno,sc.cno<br>    -&gt; from student,sc<br>    -&gt; where student.sno = sc.sno;<br>ERROR 1142 (42000): SELECT command denied to user &#x27;u1&#x27;<span class="hljs-meta">@&#x27;localhost&#x27;</span> for table &#x27;sc&#x27;  //u1没有权限<br><span class="hljs-comment">##############################################################################</span><br>C:\Users\Ke&gt;mysql -u u2 -p   //以u2的身份登录<br>Enter password: <span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><br>Welcome to the MySQL monitor.  Commands end with ; or \g.<br>Your MySQL connection id is 13<br><br>mysql&gt; show databases;<br>+--------------------+<br>|<span class="hljs-string"> Database           </span>|<br>+--------------------+<br>|<span class="hljs-string"> csedb_u201911749   </span>|<br>|<span class="hljs-string"> information_schema </span>|<br>+--------------------+<br>2 rows in set (0.00 sec)<br><br>mysql&gt; use csedb_u201911749;<br>Database changed<br>mysql&gt; show tables;   //u2只能看到sc表<br>+----------------------------+<br>|<span class="hljs-string"> Tables_in_csedb_u201911749 </span>|<br>+----------------------------+<br>|<span class="hljs-string"> sc                         </span>|<br>+----------------------------+<br>1 row in set (0.00 sec)<br><br>mysql&gt; insert into sc<br>    -&gt; values(&#x27;200215122&#x27;,&#x27;1&#x27;,75);<br>Query OK, 1 row affected (0.01 sec)   //u2具有插入权限，插入成功<br><br>mysql&gt; select <span class="hljs-symbol">*</span> from sc;<br>ERROR 1142 (42000): SELECT command denied to user &#x27;u2&#x27;<span class="hljs-meta">@&#x27;localhost&#x27;</span> for table &#x27;sc&#x27;  //u2没有权限<br>mysql&gt; select <span class="hljs-symbol">*</span> from view cs_view;<br>ERROR 1142 (42000): SELECT command denied to user &#x27;u2&#x27;<span class="hljs-meta">@&#x27;localhost&#x27;</span> for table &#x27;view&#x27;  //u2没有权限<br><span class="hljs-comment">############################################################################</span><br>(7) 用系统管理员登录，收回 U1 的所有权限<br>mysql&gt; revoke select,update on student from &#x27;u1&#x27;<span class="hljs-meta">@&#x27;%&#x27;;</span><br>Query OK, 0 rows affected (0.01 sec)<br><span class="hljs-comment">##########################################################################</span><br>(8) 用 U1 登录，查询学生表的信息<br>C:\Users\Ke&gt;mysql -u u1 -p<br>Enter password: <span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><br>Welcome to the MySQL monitor.  Commands end with ; or \g.<br>Your MySQL connection id is 18<br><br>mysql&gt; use csedb_u201911749<br>Database changed<br>mysql&gt; select <span class="hljs-symbol">*</span> from student;<br>ERROR 1142 (42000): SELECT command denied to user &#x27;u1&#x27;<span class="hljs-meta">@&#x27;localhost&#x27;</span> for table &#x27;student&#x27; //u1已经没有的select权限<br><span class="hljs-comment">###########################################################################</span><br>(9) 用系统管理员登录<br>(10) 对 SC 表建立一个更新触发器，当更新了 SC 表的成绩时，如果更新后的成绩大于等于<br>95，则检查该成绩的学生是否有奖学金，如果奖学金是“否”，则修改为“是”。如果修改后的<br>成绩小于 95，则检查该学生的其他成绩是不是有大于 95 的，如果都没有，且修改前的成绩<br>是大于 95 时，则把其奖学金修改为”否”。然后进行成绩修改，并进行验证是否触发器正确<br>执行。1）首先把某个学生成绩修改为 98，查询其奖学金。2）再把刚才的成绩修改为 80，<br>再查询其奖学金。<br>//定义触发器<br>mysql&gt; delimiter $  //把终结符改为$,这样begin和end之间使用的‘;’会被存储进去<br>mysql&gt; create trigger sctr after update on sc<br>    -&gt; for each row<br>    -&gt; begin<br>    -&gt; declare max_grade int;<br>    -&gt; set max_grade = (select max(grade) from sc where sc.sno=new.sno);<br>    -&gt; update student set student.scholarship = &#x27;是&#x27; where student.sno = new.sno and max_grade &gt;=95;<br>    -&gt; update student set student.scholarship = &#x27;否&#x27; where student.sno = new.sno and max_grade <span class="hljs-variable">&lt;95;</span><br><span class="hljs-variable">    -&gt;</span> end$<br>Query OK, 0 rows affected (0.03 sec)<br><br>mysql&gt; delimiter ;<br>//初始数据如下：<br>mysql&gt; select <span class="hljs-symbol">*</span> from student;<br>+-----------+-------+------+------+-------+-------------+<br>|<span class="hljs-string"> Sno       </span>|<span class="hljs-string"> Sname </span>|<span class="hljs-string"> Ssex </span>|<span class="hljs-string"> Sage </span>|<span class="hljs-string"> Sdept </span>|<span class="hljs-string"> Scholarship </span>|<br>+-----------+-------+------+------+-------+-------------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇  </span>|<span class="hljs-string"> 男   </span>|<span class="hljs-string">   21 </span>|<span class="hljs-string"> CS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 刘晨  </span>|<span class="hljs-string"> 女   </span>|<span class="hljs-string">   20 </span>|<span class="hljs-string"> CS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215123 </span>|<span class="hljs-string"> 王敏  </span>|<span class="hljs-string"> 女   </span>|<span class="hljs-string">   19 </span>|<span class="hljs-string"> MA    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215125 </span>|<span class="hljs-string"> 张立  </span>|<span class="hljs-string"> 男   </span>|<span class="hljs-string">   20 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215126 </span>|<span class="hljs-string"> 张三  </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string">   19 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215128 </span>|<span class="hljs-string"> 李四  </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string">   21 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 否          </span>|<br>+-----------+-------+------+------+-------+-------------+<br>6 rows in set (0.00 sec)<br><br>mysql&gt; select <span class="hljs-symbol">*</span> from sc;<br>+-----------+-----+-------+<br>|<span class="hljs-string"> Sno       </span>|<span class="hljs-string"> Cno </span>|<span class="hljs-string"> Grade </span>|<br>+-----------+-----+-------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 1   </span>|<span class="hljs-string">    92 </span>|<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 2   </span>|<span class="hljs-string">    85 </span>|<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    88 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 1   </span>|<span class="hljs-string">    75 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 2   </span>|<span class="hljs-string">    90 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    80 </span>|<br>|<span class="hljs-string"> 200215125 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    79 </span>|<br>|<span class="hljs-string"> 200215126 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    90 </span>|<br>|<span class="hljs-string"> 200215128 </span>|<span class="hljs-string"> 1   </span>|<span class="hljs-string">    88 </span>|<br>+-----------+-----+-------+<br>9 rows in set (0.00 sec)<br>//修改200215121的1号课成绩为98<br>mysql&gt; update sc set grade = 98 where sno = &#x27;200215121&#x27; and cno = &#x27;1&#x27;;<br>Query OK, 1 row affected (0.02 sec)<br>Rows matched: 1  Changed: 1  Warnings: 0<br>//查看student，奖学金由否改为了是<br>mysql&gt; select <span class="hljs-symbol">*</span> from student;<br>+-----------+-------+------+------+-------+-------------+<br>|<span class="hljs-string"> Sno       </span>|<span class="hljs-string"> Sname </span>|<span class="hljs-string"> Ssex </span>|<span class="hljs-string"> Sage </span>|<span class="hljs-string"> Sdept </span>|<span class="hljs-string"> Scholarship </span>|<br>+-----------+-------+------+------+-------+-------------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇  </span>|<span class="hljs-string"> 男   </span>|<span class="hljs-string">   21 </span>|<span class="hljs-string"> CS    </span>|<span class="hljs-string"> 是          </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 刘晨  </span>|<span class="hljs-string"> 女   </span>|<span class="hljs-string">   20 </span>|<span class="hljs-string"> CS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215123 </span>|<span class="hljs-string"> 王敏  </span>|<span class="hljs-string"> 女   </span>|<span class="hljs-string">   19 </span>|<span class="hljs-string"> MA    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215125 </span>|<span class="hljs-string"> 张立  </span>|<span class="hljs-string"> 男   </span>|<span class="hljs-string">   20 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215126 </span>|<span class="hljs-string"> 张三  </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string">   19 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215128 </span>|<span class="hljs-string"> 李四  </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string">   21 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 否          </span>|<br>+-----------+-------+------+------+-------+-------------+<br>6 rows in set (0.00 sec)<br>//修改刚才的成绩为88<br>mysql&gt; update sc set grade = 88 where sno = &#x27;200215121&#x27; and cno = &#x27;1&#x27;;<br>Query OK, 1 row affected (0.01 sec)<br>Rows matched: 1  Changed: 1  Warnings: 0<br>//修改项的奖学金由是改成了否<br>mysql&gt; select <span class="hljs-symbol">*</span> from student;<br>+-----------+-------+------+------+-------+-------------+<br>|<span class="hljs-string"> Sno       </span>|<span class="hljs-string"> Sname </span>|<span class="hljs-string"> Ssex </span>|<span class="hljs-string"> Sage </span>|<span class="hljs-string"> Sdept </span>|<span class="hljs-string"> Scholarship </span>|<br>+-----------+-------+------+------+-------+-------------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇  </span>|<span class="hljs-string"> 男   </span>|<span class="hljs-string">   21 </span>|<span class="hljs-string"> CS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 刘晨  </span>|<span class="hljs-string"> 女   </span>|<span class="hljs-string">   20 </span>|<span class="hljs-string"> CS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215123 </span>|<span class="hljs-string"> 王敏  </span>|<span class="hljs-string"> 女   </span>|<span class="hljs-string">   19 </span>|<span class="hljs-string"> MA    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215125 </span>|<span class="hljs-string"> 张立  </span>|<span class="hljs-string"> 男   </span>|<span class="hljs-string">   20 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215126 </span>|<span class="hljs-string"> 张三  </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string">   19 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215128 </span>|<span class="hljs-string"> 李四  </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string">   21 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 否          </span>|<br>+-----------+-------+------+------+-------+-------------+<br>6 rows in set (0.00 sec)<br>（11）删除刚定义的触发器<br>//删除前查询触发器<br>mysql&gt; show triggers from csedb_u201911749\G;<br><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span> 1. row <span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><br>             Trigger: sctr<br>               Event: UPDATE<br>               Table: sc<br>           Statement: begin<br>declare max_grade int;<br>set max_grade = (select max(grade) from sc where sc.sno=new.sno);<br>update student set student.scholarship = &#x27;是&#x27; where student.sno = new.sno and max_grade &gt;=95;<br>update student set student.scholarship = &#x27;否&#x27; where student.sno = new.sno and max_grade <span class="hljs-variable">&lt;95;</span><br><span class="hljs-variable">end</span><br><span class="hljs-variable">              Timing: AFTER</span><br><span class="hljs-variable">             Created: 2021-11-12 21:32:29.26</span><br><span class="hljs-variable">            sql_mode: ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION</span><br><span class="hljs-variable">             Definer: root@localhost</span><br><span class="hljs-variable">character_set_client: gbk</span><br><span class="hljs-variable">collation_connection: gbk_chinese_ci</span><br><span class="hljs-variable">  Database Collation: utf8mb4_0900_ai_ci</span><br><span class="hljs-variable">1 row in set (0.00 sec)</span><br><span class="hljs-variable"></span><br><span class="hljs-variable">ERROR:</span><br><span class="hljs-variable">No query specified</span><br><span class="hljs-variable">//删除触发器</span><br><span class="hljs-variable">mysql&gt;</span> drop trigger sctr;<br>Query OK, 0 rows affected (0.02 sec)<br>//重新查询，触发器已被删除<br>mysql&gt; show triggers from csedb_u201911749\G;<br>Empty set (0.00 sec)<br><br>ERROR:<br>No query specified<br>（12）定义一个存储过程计算 CS 系的课程的平均成绩和最高成绩，在查询分析器或查询编<br>辑器中执行存储过程，查看结果。<br>mysql&gt; select <span class="hljs-symbol">*</span> from student;<br>+-----------+-------+------+------+-------+-------------+<br>|<span class="hljs-string"> Sno       </span>|<span class="hljs-string"> Sname </span>|<span class="hljs-string"> Ssex </span>|<span class="hljs-string"> Sage </span>|<span class="hljs-string"> Sdept </span>|<span class="hljs-string"> Scholarship </span>|<br>+-----------+-------+------+------+-------+-------------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇  </span>|<span class="hljs-string"> 男   </span>|<span class="hljs-string">   21 </span>|<span class="hljs-string"> CS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 刘晨  </span>|<span class="hljs-string"> 女   </span>|<span class="hljs-string">   20 </span>|<span class="hljs-string"> CS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215123 </span>|<span class="hljs-string"> 王敏  </span>|<span class="hljs-string"> 女   </span>|<span class="hljs-string">   19 </span>|<span class="hljs-string"> MA    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215125 </span>|<span class="hljs-string"> 张立  </span>|<span class="hljs-string"> 男   </span>|<span class="hljs-string">   20 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215126 </span>|<span class="hljs-string"> 张三  </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string">   19 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 否          </span>|<br>|<span class="hljs-string"> 200215128 </span>|<span class="hljs-string"> 李四  </span>|<span class="hljs-string"> NULL </span>|<span class="hljs-string">   21 </span>|<span class="hljs-string"> IS    </span>|<span class="hljs-string"> 否          </span>|<br>+-----------+-------+------+------+-------+-------------+<br>6 rows in set (0.00 sec)<br>mysql&gt; select <span class="hljs-symbol">*</span> from sc;<br>+-----------+-----+-------+<br>|<span class="hljs-string"> Sno       </span>|<span class="hljs-string"> Cno </span>|<span class="hljs-string"> Grade </span>|<br>+-----------+-----+-------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 1   </span>|<span class="hljs-string">    88 </span>|<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 2   </span>|<span class="hljs-string">    85 </span>|<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    88 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 1   </span>|<span class="hljs-string">    75 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 2   </span>|<span class="hljs-string">    90 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    80 </span>|<br>|<span class="hljs-string"> 200215125 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    79 </span>|<br>|<span class="hljs-string"> 200215126 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    90 </span>|<br>|<span class="hljs-string"> 200215128 </span>|<span class="hljs-string"> 1   </span>|<span class="hljs-string">    88 </span>|<br>+-----------+-----+-------+<br>9 rows in set (0.00 sec)<br>mysql&gt; delimiter $ //创建存储过程<br>mysql&gt; create procedure cs_grade(<br>    -&gt; out avg_grade int,<br>    -&gt; out max_grade int)<br>    -&gt; begin<br>    -&gt; select avg(grade)<br>    -&gt; into avg_grade<br>    -&gt; from student,sc<br>    -&gt; where student.sdept = &#x27;cs&#x27; and student.sno = sc.sno;<br>    -&gt; select max(grade)<br>    -&gt; into max_grade<br>    -&gt; from student,sc<br>    -&gt; where student.sdept = &#x27;cs&#x27; and student.sno = sc.sno;<br>    -&gt; end $<br>Query OK, 0 rows affected (0.01 sec)<br>mysql&gt; delimiter ; //重新定义终结符为&#x27;;&#x27;<br>mysql&gt; call cs_grade(<span class="hljs-meta">@avg_grade,</span><span class="hljs-meta">@max_grade);//调用存储过程</span><br>Query OK, 1 row affected (0.00 sec)<br><br>mysql&gt; select <span class="hljs-meta">@avg_grade,</span><span class="hljs-meta">@max_grade;</span><br>+------------+------------+<br>|<span class="hljs-string"> @avg_grade </span>|<span class="hljs-string"> @max_grade </span>|<br>+------------+------------+<br>|<span class="hljs-string">         84 </span>|<span class="hljs-string">         90 </span>|<br>+------------+------------+<br>1 row in set (0.00 sec)<br><br>（13）定义一个带学号为参数的查看某个学号的所有课程的成绩，查询结果要包含学生姓<br>名。进行验证。<br>//先创建临时表保存数据<br>mysql&gt; create temporary table stu_info(<br>    -&gt; sno  char(9) null,<br>    -&gt; sname char(20) null,<br>    -&gt; cno char(5) null,<br>    -&gt; cname char(20)null,<br>    -&gt; grade int);<br>Query OK, 0 rows affected (0.00 sec)<br>mysql&gt; delimiter $  //改变终结符<br>//建立存储过程，传入sid char(9) ,insert into table select.....把select的结果插入table<br>mysql&gt; create procedure stu_grade(<br>    -&gt; in sid char(9))<br>    -&gt; begin<br>    -&gt; insert into stu_info<br>    -&gt; select sc.sno,sname,sc.cno,cname,grade from student,course,sc where sid = sc.sno and sc.sno = student.sno and sc.cno =course.cno;<br>    -&gt; end$<br>Query OK, 0 rows affected (0.01 sec)<br><br>mysql&gt; delimiter ;  //未调用存储过程前，临时表为空<br>mysql&gt; select <span class="hljs-symbol">*</span> from stu_info;<br>Empty set (0.00 sec)<br>//调用存储过程<br>mysql&gt; call stu_grade(&#x27;200215121&#x27;);<br>Query OK, 3 rows affected (0.01 sec)<br>//查看临时表结果<br>mysql&gt; select <span class="hljs-symbol">*</span> from stu_info;<br>+-----------+-------+------+----------+-------+<br>|<span class="hljs-string"> sno       </span>|<span class="hljs-string"> sname </span>|<span class="hljs-string"> cno  </span>|<span class="hljs-string"> cname    </span>|<span class="hljs-string"> grade </span>|<br>+-----------+-------+------+----------+-------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇  </span>|<span class="hljs-string"> 1    </span>|<span class="hljs-string"> 数据库   </span>|<span class="hljs-string">    88 </span>|<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇  </span>|<span class="hljs-string"> 2    </span>|<span class="hljs-string"> 数学     </span>|<span class="hljs-string">    85 </span>|<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇  </span>|<span class="hljs-string"> 3    </span>|<span class="hljs-string"> 信息系统 </span>|<span class="hljs-string">    88 </span>|<br>+-----------+-------+------+----------+-------+<br>3 rows in set (0.00 sec)<br>（14）把上一题改成函数。再进行验证。<br>//先把创建函数的功能打开，检查下面的变量是不是on<br>mysql&gt; show variables like &#x27;%func%&#x27;;<br>+---------------------------------+-------+<br>|<span class="hljs-string"> Variable_name                   </span>|<span class="hljs-string"> Value </span>|<br>+---------------------------------+-------+<br>|<span class="hljs-string"> log_bin_trust_function_creators </span>|<span class="hljs-string"> OFF   </span>|<br>+---------------------------------+-------+<br>1 row in set, 1 warning (0.01 sec)<br><br>mysql&gt; set global log_bin_trust_function_creators =1;<br>Query OK, 0 rows affected (0.00 sec)<br><br>mysql&gt; show variables like &#x27;%func%&#x27;;<br>+---------------------------------+-------+<br>|<span class="hljs-string"> Variable_name                   </span>|<span class="hljs-string"> Value </span>|<br>+---------------------------------+-------+<br>|<span class="hljs-string"> log_bin_trust_function_creators </span>|<span class="hljs-string"> ON    </span>|<br>+---------------------------------+-------+<br>1 row in set, 1 warning (0.00 sec)<br>//创建函数，传入sid<br>mysql&gt; delimiter $<br>mysql&gt; create function stu_grade2(sid char(9))<br>    -&gt; returns tinyint<br>    -&gt; begin<br>    -&gt; insert into stu_info<br>    -&gt; select sc.sno,sname,sc.cno,cname,grade from student,course,sc where sid = sc.sno and sc.sno = student.sno and sc.cno =course.cno;<br>    -&gt; return 1;<br>    -&gt; end$<br>Query OK, 0 rows affected (0.01 sec)<br><br>mysql&gt; delimiter ;<br>mysql&gt; select <span class="hljs-symbol">*</span> from stu_info; //未调用函数前的临时表<br>+-----------+-------+------+----------+-------+<br>|<span class="hljs-string"> sno       </span>|<span class="hljs-string"> sname </span>|<span class="hljs-string"> cno  </span>|<span class="hljs-string"> cname    </span>|<span class="hljs-string"> grade </span>|<br>+-----------+-------+------+----------+-------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇  </span>|<span class="hljs-string"> 1    </span>|<span class="hljs-string"> 数据库   </span>|<span class="hljs-string">    88 </span>|<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇  </span>|<span class="hljs-string"> 2    </span>|<span class="hljs-string"> 数学     </span>|<span class="hljs-string">    85 </span>|<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇  </span>|<span class="hljs-string"> 3    </span>|<span class="hljs-string"> 信息系统 </span>|<span class="hljs-string">    88 </span>|<br>+-----------+-------+------+----------+-------+<br>3 rows in set (0.00 sec)<br>//执行函数，显示的1时返回值1<br>mysql&gt; select stu_grade2(&#x27;200215122&#x27;);<br>+-------------------------+<br>|<span class="hljs-string"> stu_grade2(&#x27;200215122&#x27;) </span>|<br>+-------------------------+<br>|<span class="hljs-string">                       1 </span>|<br>+-------------------------+<br>1 row in set (0.01 sec)<br>//再次查看临时表<br>mysql&gt; select <span class="hljs-symbol">*</span> from stu_info;<br>+-----------+-------+------+----------+-------+<br>|<span class="hljs-string"> sno       </span>|<span class="hljs-string"> sname </span>|<span class="hljs-string"> cno  </span>|<span class="hljs-string"> cname    </span>|<span class="hljs-string"> grade </span>|<br>+-----------+-------+------+----------+-------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇  </span>|<span class="hljs-string"> 1    </span>|<span class="hljs-string"> 数据库   </span>|<span class="hljs-string">    88 </span>|<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇  </span>|<span class="hljs-string"> 2    </span>|<span class="hljs-string"> 数学     </span>|<span class="hljs-string">    85 </span>|<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 李勇  </span>|<span class="hljs-string"> 3    </span>|<span class="hljs-string"> 信息系统 </span>|<span class="hljs-string">    88 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 刘晨  </span>|<span class="hljs-string"> 1    </span>|<span class="hljs-string"> 数据库   </span>|<span class="hljs-string">    75 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 刘晨  </span>|<span class="hljs-string"> 2    </span>|<span class="hljs-string"> 数学     </span>|<span class="hljs-string">    90 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 刘晨  </span>|<span class="hljs-string"> 3    </span>|<span class="hljs-string"> 信息系统 </span>|<span class="hljs-string">    80 </span>|<br>+-----------+-------+------+----------+-------+<br>6 rows in set (0.00 sec)<br>（15）在 SC 表上定义一个完整性约束，要求成绩再 0-100 之间。定义约束前，先把某个学<br>生的成绩修改成 120，进行查询，再修改回来。定义约束后，再把该学生成绩修改为 120，<br>然后进行查询<br><br>mysql&gt; update sc set grade = 120<br>    -&gt; where sno = &#x27;200215121&#x27; and cno =&#x27;1&#x27;;<br>Query OK, 1 row affected (0.01 sec)<br>Rows matched: 1  Changed: 1  Warnings: 0<br><br>mysql&gt; select <span class="hljs-symbol">*</span> from sc;<br>+-----------+-----+-------+<br>|<span class="hljs-string"> Sno       </span>|<span class="hljs-string"> Cno </span>|<span class="hljs-string"> Grade </span>|<br>+-----------+-----+-------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 1   </span>|<span class="hljs-string">   120 </span>|<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 2   </span>|<span class="hljs-string">    85 </span>|<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    88 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 1   </span>|<span class="hljs-string">    75 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 2   </span>|<span class="hljs-string">    90 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    80 </span>|<br>|<span class="hljs-string"> 200215125 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    79 </span>|<br>|<span class="hljs-string"> 200215126 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    90 </span>|<br>|<span class="hljs-string"> 200215128 </span>|<span class="hljs-string"> 1   </span>|<span class="hljs-string">    88 </span>|<br>+-----------+-----+-------+<br>9 rows in set (0.00 sec)<br><br>mysql&gt; update sc set grade = 88<br>    -&gt; where sno = &#x27;200215121&#x27; and cno =&#x27;1&#x27;;<br>Query OK, 1 row affected (0.01 sec)<br>Rows matched: 1  Changed: 1  Warnings: 0<br><br>mysql&gt; select <span class="hljs-symbol">*</span> from sc;<br>+-----------+-----+-------+<br>|<span class="hljs-string"> Sno       </span>|<span class="hljs-string"> Cno </span>|<span class="hljs-string"> Grade </span>|<br>+-----------+-----+-------+<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 1   </span>|<span class="hljs-string">    88 </span>|<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 2   </span>|<span class="hljs-string">    85 </span>|<br>|<span class="hljs-string"> 200215121 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    88 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 1   </span>|<span class="hljs-string">    75 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 2   </span>|<span class="hljs-string">    90 </span>|<br>|<span class="hljs-string"> 200215122 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    80 </span>|<br>|<span class="hljs-string"> 200215125 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    79 </span>|<br>|<span class="hljs-string"> 200215126 </span>|<span class="hljs-string"> 3   </span>|<span class="hljs-string">    90 </span>|<br>|<span class="hljs-string"> 200215128 </span>|<span class="hljs-string"> 1   </span>|<span class="hljs-string">    88 </span>|<br>+-----------+-----+-------+<br>9 rows in set (0.00 sec)<br>//设置用户自定义约束<br>mysql&gt; alter table sc add constraint check_grade check(grade &gt;=0 and grade <span class="hljs-variable">&lt;=100);</span><br><span class="hljs-variable">Query OK, 9 rows affected (0.09 sec)</span><br><span class="hljs-variable">Records: 9  Duplicates: 0  Warnings: 0</span><br><span class="hljs-variable">//更新失败，提示检查约束不通过</span><br><span class="hljs-variable">mysql&gt;</span> update sc set grade = 120<br>    -&gt; where sno = &#x27;200215121&#x27; and cno =&#x27;1&#x27;;<br>ERROR 3819 (HY000): Check constraint &#x27;check_grade&#x27; is violated.<br></code></pre></div></td></tr></table></figure><h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><p><a href="https://www.runoob.com/mysql/mysql-tutorial.html">MySQL 教程 | 菜鸟教程 (runoob.com)</a></p><p><a href="https://www.cnblogs.com/qlqwjy/p/7842647.html">【触发器】MySQL触发器使用详解 - QiaoZhi - 博客园 (cnblogs.com)</a></p><p><a href="https://www.jianshu.com/p/7b2d74701ccd">mysql存储过程详细教程 - 简书 (jianshu.com)</a></p><p><a href="https://www.yiibai.com/mysql/getting-started-with-mysql-stored-procedures.html">MySQL存储过程入门 - MySQL教程™ (yiibai.com)</a></p><p><a href="https://www.runoob.com/sql/sql-insert-into-select.html">SQL INSERT INTO SELECT 语句 | 菜鸟教程 (runoob.com)</a></p><p><a href="https://www.php.cn/mysql-tutorials-460561.html#:~:text=mysql">mysql里怎样创建函数-mysql教程-PHP中文网</a></p><p><a href="https://blog.csdn.net/liyazhen2011/article/details/82870406"> MySql创建自定义函数（Function）_万里归来少年心-CSDN博客_mysql 自定义函数</a></p>]]></content>
    
    
    <categories>
      
      <category>HUST</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HUST</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>三.Redis基础</title>
    <link href="/2021/11/10/Redis%E5%9F%BA%E7%A1%80/"/>
    <url>/2021/11/10/Redis%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<h1 id="Redis基础"><a href="#Redis基础" class="headerlink" title="Redis基础"></a>Redis基础</h1><h2 id="基础操作"><a href="#基础操作" class="headerlink" title="基础操作"></a>基础操作</h2><ul><li>redis默认有16个数据库，在redis.conf中由<code>database 16</code>标识</li><li>默认使用第0个数据库，可以使用<code>select num</code>切换数据库</li><li>选择数据库后，使用命令<code>DBSIZE</code>可查看当前库中的数据量</li><li><code>keys *</code>,查看当前库中的所有key的name</li><li><code>flushdb</code>  清除当前库；<code>FLUSHALL</code>  清空全部数据库内容</li><li><code>EXIST  [key-name]</code>,判断一个key是否存在，存在返回1，不存在返回0</li><li><code>MOVE [key-name]</code>，移除一个key</li><li><code>set  [key-name]  [key-value]</code>，为一个key设置具体值</li><li><code>get  [key-name]</code>，获取key的具体值</li><li><code>EXPIRE  [key-name]  [int]</code>，设置key的过期时间</li><li><code>ttl  [key-name]</code>，查询key当前的剩余时间，过期之后get的值为nul</li><li><code>type  [key-name]</code>，查看当前key的类型</li></ul><h2 id="Redis是单线程的"><a href="#Redis是单线程的" class="headerlink" title="Redis是单线程的"></a>Redis是单线程的</h2><p>官方表示，Redis是基于内存操作，CPU不是Redis的性能瓶颈，Redis的瓶颈来源于机器的内存和网络带宽，既然可以使用单线程来实现，那就使用单线程。</p><p>Redis是由C编写，官方数据说明Redis的QPS可达到100000+，完全不比同样是KV存储的Memcached差。</p><h2 id="Redis为什么单线程还这么快？"><a href="#Redis为什么单线程还这么快？" class="headerlink" title="Redis为什么单线程还这么快？"></a>Redis为什么单线程还这么快？</h2><ul><li>误区1：高性能的服务器一定是多线程的？</li><li>误区2：多线程（存在CPU上下文切换成本）一定比单线程效率高？</li><li>核心：Redis是将所有的数据全部放在内存中的，所以使用单线程去操作的效率就是最高的，多线程反而会由于CPU上下文切换产生耗时操作。对于内存系统来说，如果没有上下文切换，那效率就是最高的，多次读写都在一个CPU上，在数据保存在内存上是，单线程就是最佳方案！</li></ul>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>二.Redis安装配置</title>
    <link href="/2021/11/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/"/>
    <url>/2021/11/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="Redis安装与配置"><a href="#Redis安装与配置" class="headerlink" title="Redis安装与配置"></a>Redis安装与配置</h1><ol><li><p>首先通过ssh远程连接服务器或在虚拟机中安装</p></li><li><p>执行命令：<code>wget https://download.redis.io/releases/redis-6.2.6.tar.gz</code>，下载压缩包到本地/opt目录下，如图：</p><p><img src="/2021/11/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/1.png" srcset="/img/loading.gif" lazyload alt="1"></p></li><li><p> 执行命令:<code>tar  -zxvf  redis-6.2.6.tat.gz </code>,将压缩包解压大当前目录</p></li><li><p>解压完成之后，可进入解压目录查看当前文件：</p><p><img src="/2021/11/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/2.png" srcset="/img/loading.gif" lazyload alt="2"></p><p>其中<code>redis.conf</code>为配置文件</p></li><li><p>基本环境安装与redis安装：</p><ul><li><p><code>yum install gcc-c++ </code>   安装 gcc 编译工具</p><p><img src="/2021/11/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/3.png" srcset="/img/loading.gif" lazyload alt="3"></p></li><li><p>在redis目录下执行<code>make</code>编译安装redis，可能会花费一定的时间，因为要安装一系列的环境</p><p><img src="/2021/11/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/4.png" srcset="/img/loading.gif" lazyload alt="4"></p><p><code>make</code>完成后会显示在src目录下增加了内容，可以继续使用<code>make</code>或<code>make install</code>进行检验，因为环境已经配置好，所以之后的<code>make</code>速度很快</p></li><li><p>redis的默认安装路径在<code>/usr/local/bin</code></p><p><img src="/2021/11/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/5.png" srcset="/img/loading.gif" lazyload alt="5"></p></li></ul></li><li><p> 将redis的配置文件复制到当前的程序目录下，新建一个目录<code>kconfig</code>，保存配置文件</p></li></ol><p>   <img src="/2021/11/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/6.png" srcset="/img/loading.gif" lazyload alt="6"></p><ol start="7"><li> redis默认不是后台启动的，需要修改配置文件，使用<code>vim  redis.conf</code>修改配置文件，将图中的选项由<code>no</code>修改为’yes’</li></ol><p>   <img src="/2021/11/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/7.png" srcset="/img/loading.gif" lazyload alt="7"></p><ol start="8"><li><p>经过上述配置之后，便可以启动redis服务，使用命令<code>redis-server /kconfig/redis.conf </code></p><p><img src="/2021/11/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/8.png" srcset="/img/loading.gif" lazyload alt="8"></p></li><li><p>启动redis客户端连接服务端，使用命令<code>redis-cli -p 6379</code>连接端口6379</p><p><img src="/2021/11/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/9.png" srcset="/img/loading.gif" lazyload alt="9"></p></li><li><p>查看redis的进程运行状态，使用命令<code>ps -ef |grep redis</code></p><p><img src="/2021/11/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/10.png" srcset="/img/loading.gif" lazyload alt="10"></p></li><li><p>如何关闭redis服务？在客户端执行<code>shutdown</code>命令关闭服务器，执行<code>exit</code>退出客户端</p><p><img src="/2021/11/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/11.png" srcset="/img/loading.gif" lazyload alt="11"></p></li></ol><h1 id="redis-benchmark"><a href="#redis-benchmark" class="headerlink" title="redis-benchmark"></a>redis-benchmark</h1><p>​    官方自带的性能测试工具，如何使用? <code>redis-benchmark  [option]  [option value]</code>，该命令在redis的目录下执行，而不是客户端的内部之灵，具体参数如下：</p><p><img src="/2021/11/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/13.png" srcset="/img/loading.gif" lazyload alt="12"></p><p>简单测试：</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-comment"># 测试100个并发连接 100000个请求</span><br><span class="hljs-attribute">redis</span>-benchmark -h localhost -p <span class="hljs-number">6379</span> -c <span class="hljs-number">100</span> -n <span class="hljs-number">100000</span><br></code></pre></div></td></tr></table></figure><p>测试结果与分析：</p><p><img src="/2021/11/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/12.png" srcset="/img/loading.gif" lazyload alt="13"></p><h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><p><a href="https://www.runoob.com/redis/redis-tutorial.html">Redis 教程 | 菜鸟教程 (runoob.com)</a></p>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>一.Redis概述</title>
    <link href="/2021/11/09/Redis%E6%A6%82%E8%BF%B0/"/>
    <url>/2021/11/09/Redis%E6%A6%82%E8%BF%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="一-Redis概述"><a href="#一-Redis概述" class="headerlink" title="一.Redis概述"></a>一.Redis概述</h1><h2 id="1-数据库发展演变"><a href="#1-数据库发展演变" class="headerlink" title="1. 数据库发展演变"></a>1. 数据库发展演变</h2><ol><li><p>单机Mysql的年代：</p><p><img src="/2021/11/09/Redis%E6%A6%82%E8%BF%B0/1.png" srcset="/img/loading.gif" lazyload alt="1"></p><p>起初网站访问量并不是很大，单个数据库就可以满足需求，且当时更多的使用静态网页Html，服务器并没有很大的压力，但是可能存在很多瓶颈:</p><ul><li>数据量如果太大，一个机器放不下</li><li>数据的索引(B+ Tree)，一个机器的内存也放不下</li><li>访问量(读写混合)，一个服务器承受不了</li></ul><p>出现以上问题的话，单机模式无法解决。</p></li><li><p>Memcached(缓存)+Mysql+垂直拆分(读写分离)</p><p><img src="/2021/11/09/Redis%E6%A6%82%E8%BF%B0/2.png" srcset="/img/loading.gif" lazyload alt="2"></p><p>我们采用读写分离，由一个库来进行写数据，其他数据库同步写库的数据，提供读数据服务。</p><p>当网站大部分时候都是在读时，每次都要查询数据库的话就很麻烦，因此希望减轻数据库的读压力，我们可以使用缓存(Cache)来缓解读压力。</p><p>发展过程：优化数据结构和索引—&gt;文件缓存(但文件读写(IO)压力增大，也会降低效率)—&gt;Memchched(当时的热门技术)。</p></li><li><p>分库分表 + 分库分表 + Mysql集群</p><p><img src="/2021/11/09/Redis%E6%A6%82%E8%BF%B0/3.png" srcset="/img/loading.gif" lazyload alt="3"></p><p>尽管实现了分库分表，但是由于数据类型，数据量的增加(地图定位，音乐，热榜等数据)</p><p>Mysql等关系型数据库就不够用了，数据量很多，变化很大，例如给一个10万行的数据增加一个列属性，将需要修改所有10万条数据。</p><p>如果使用Mysql来存储比较大的文件，博客，图片等，数据库的表将会变得很大，效率也会降低，如果有一种数据库专门来处理这种数据，Mysql的压力就会变得十分小。</p></li><li><p>当前时代的互联网项目</p><p><img src="/2021/11/09/Redis%E6%A6%82%E8%BF%B0/4.png" srcset="/img/loading.gif" lazyload alt="4"></p></li></ol><h2 id="2-什么是NoSQL？"><a href="#2-什么是NoSQL？" class="headerlink" title="2. 什么是NoSQL？"></a>2. 什么是NoSQL？</h2><h3 id="2-1-NoSQL定义"><a href="#2-1-NoSQL定义" class="headerlink" title="2.1 NoSQL定义"></a>2.1 NoSQL定义</h3><p>​    NoSQL = Not  Only  SQL(不仅仅是SQL)</p><p>​    泛指非关系型数据库，随着Web2.0互联网的诞生，传统的关系型数据库很难应对Web2.0时代。尤其是超大规模的高并发社区，暴露出    很多难以克服的问题。NoSQL在当今大数据环境下发展十分迅速，Redis是发展最快的，也是我们当下必须要掌握的技术。</p><p>​    很多数据类型用户的个人信息，社交网络，地理位置，这些数据类型的存储不需要一个特定的格式，不需要多少的操作就可以横向扩展    的。例如可以使用Map&lt;String,Object&gt;键值对来存储。而关系型数据库中的数据一般以表格的形式存在，具有固定的行和列。</p><h3 id="2-2-NoSQL特点"><a href="#2-2-NoSQL特点" class="headerlink" title="2.2 NoSQL特点"></a>2.2 NoSQL特点</h3><p>​    <strong>解耦！</strong></p><ol><li><p>方便扩展（数据之间没有关系，很好扩展）</p></li><li><p>大数据量的高性能（Redis一秒写8万次，读取11万次，NoSQL的缓存记录级，是一种细粒度的缓存，性能会比较高）</p></li><li><p>数据类型是多样性的（不需要实现设计数据库，随取随用，如果数据量很大，设计表结构是很难的）</p></li><li><p>传统RDBMS与NoSQL的对比</p><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc">传统的RDBMS：<br><span class="hljs-bullet">- </span>结构化组织<br><span class="hljs-bullet">- </span>SQL<br><span class="hljs-bullet">- </span>数据与关系都存储在单独的表中<br><span class="hljs-bullet">- </span>具有操作语言，数据定义语言<br><span class="hljs-bullet">- </span>严格的一致性<br><span class="hljs-bullet">- </span>基础的事务<br><span class="hljs-bullet">- </span>......<br></code></pre></div></td></tr></table></figure><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc">NoSQL:<br><span class="hljs-bullet">- </span>不仅仅是数据<br><span class="hljs-bullet">- </span>没有固定的查询语言，可以定义语法<br><span class="hljs-bullet">- </span>键值对存储，列存储，文档存储，图形数据库（社交关系存储）<br><span class="hljs-bullet">- </span>最终一致性<br><span class="hljs-bullet">- </span>CAP定理和BASE（异地多活）<br><span class="hljs-bullet">- </span>高性能，高可用，高可扩展<br><span class="hljs-bullet">- </span>.....<br></code></pre></div></td></tr></table></figure></li><li><p>3v：海量，多样，实时（大数据时代面临的问题）</p><p> 3高：高并发，高可扩，高xingneng </p></li></ol><h2 id="3-NoSQL四大分类"><a href="#3-NoSQL四大分类" class="headerlink" title="3. NoSQL四大分类"></a>3. NoSQL四大分类</h2><ol><li><p>KV键值对：Redis，Tair，Memcached….</p></li><li><p>文档型数据库（bson格式，与json相同）：</p><ul><li>MongoDB：<ul><li>一个基于分布式文件存储的数据库，c++编写，主要用于处理大量的文档。</li><li>一个介于关系型数据库和非关系型数据库中间的产品，是非关系行数据库中功能最丰富，最像关系型数据库的。</li></ul></li><li>ConthDB</li></ul></li><li><p>列存储数据库：HBase，分布式文件系统</p></li><li><p>图关系数据库(使用图结构存储关系)</p><p><img src="/2021/11/09/Redis%E6%A6%82%E8%BF%B0/5.png" srcset="/img/loading.gif" lazyload alt="图关系"></p></li></ol><p><strong>四种类型对比:</strong></p><p><img src="/2021/11/09/Redis%E6%A6%82%E8%BF%B0/6.png" srcset="/img/loading.gif" lazyload alt="四种NoSQL数据库对比"></p><h2 id="4-Redis简介"><a href="#4-Redis简介" class="headerlink" title="4. Redis简介"></a>4. Redis简介</h2><ul><li><p>Redis(Remote Dictionary Server)，远程字典服务。</p></li><li><p>是一个开源的使用ANSI <a href="https://baike.baidu.com/item/C%E8%AF%AD%E8%A8%80">C语言</a>编写、支持网络、可基于内存亦可持久化的日志型、Key-Value<a href="https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E5%BA%93/103728">数据库</a>，并提供多种语言的API。</p></li><li><p>功能</p><ul><li>内存存储，持久化，内存中是断电即失，因此需要做持久化（rbd，aof   ???)</li><li>效率高，可用于高速缓存</li><li>发布订阅系统</li><li>地图信息分析</li><li>计时器，计数器（统计浏览量…）</li><li>……</li></ul></li><li><p>特性</p><ul><li>多样的数据类型</li><li>持久化</li><li>集群</li><li>事务</li><li>…….</li></ul></li><li><p>参考</p><ul><li><a href="https://redis.io/">Redis官网</a></li><li><a href="http://www.redis.cn/">Redis中文官网</a></li></ul></li><li><p>一般在Linux服务器上部署Redis</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo常用操作</title>
    <link href="/2021/11/09/Hexo%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/"/>
    <url>/2021/11/09/Hexo%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h2 id="Hexo框架操作"><a href="#Hexo框架操作" class="headerlink" title="Hexo框架操作"></a>Hexo框架操作</h2><ul><li>hexo -clean    清除旧文件</li><li>hexo -g           生成最新</li><li>hexo -d          提交</li><li>hexo -s          启动本地预览</li><li>ssh -T  <a href="mailto:&#x67;&#x69;&#116;&#x40;&#103;&#105;&#x74;&#104;&#x75;&#98;&#46;&#99;&#111;&#x6d;">&#x67;&#x69;&#116;&#x40;&#103;&#105;&#x74;&#104;&#x75;&#98;&#46;&#99;&#111;&#x6d;</a>    验证是否与服务器连接成功</li></ul><h2 id="Front-matter变量"><a href="#Front-matter变量" class="headerlink" title="Front-matter变量"></a>Front-matter变量</h2><ul><li>title    文章标题</li><li>index_img     首页显示图片</li><li>date    日期</li><li>hide    文章是否隐藏</li><li>tags      文章标签</li><li>categories    分类</li><li>sticky    优先级，数值越大越靠前</li><li>top    与sticky功能一致</li><li>banner_img    文章页顶部放大图，图片路径为（/img/name.jpg）</li><li>excerpt    摘要，首页显示</li></ul><h2 id="添加便签"><a href="#添加便签" class="headerlink" title="添加便签"></a>添加便签</h2><p>​    在markdown中使用如下代码添加便签：</p><figure class="highlight mel"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mel">&#123;% note success %&#125;   <span class="hljs-comment">//单独一行，success为便签类别，具体种类如下</span><br>文字 或者 <span class="hljs-string">`markdown`</span> 均可<br>&#123;% endnote %&#125;    <span class="hljs-comment">//单独一行</span><br></code></pre></div></td></tr></table></figure><p>​    便签种类如下：<img src="/2021/11/09/Hexo%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/1.png" srcset="/img/loading.gif" lazyload alt="便签种类"></p><h2 id="行内便签"><a href="#行内便签" class="headerlink" title="行内便签"></a>行内便签</h2><p>​    在markdown中加入如下代码来使用Lable:</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">&#123;% label <span class="hljs-keyword">primary</span> @<span class="hljs-type">text</span> %&#125; //label  ***为便签种类，@+<span class="hljs-type">text</span>为显示文字，但<span class="hljs-type">text</span>不能以@开头<br></code></pre></div></td></tr></table></figure><p>​    Lable种类如下：</p><p>​    <span class="label label-primary">primary</span> <span class="label label-default">default</span> <span class="label label-info">info</span> <span class="label label-success">success</span> <span class="label label-warning">warning</span> <span class="label label-danger">danger</span></p><p>​    示例：写下代码<code>&#123;% label primary @12345 %&#125;</code>，将会出现一个Lable：<span class="label label-primary">12345</span></p>]]></content>
    
    
    <categories>
      
      <category>Hexo</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>欢迎到访！</title>
    <link href="/2021/11/09/%E6%AC%A2%E8%BF%8E%E5%88%B0%E8%AE%BF%EF%BC%81/"/>
    <url>/2021/11/09/%E6%AC%A2%E8%BF%8E%E5%88%B0%E8%AE%BF%EF%BC%81/</url>
    
    <content type="html"><![CDATA[<div class="note note-success">            <p><strong>所谓理想，只是同时拥有实力的人才能说的“现实”。</strong></p>          </div><h1 id="本站更新记录"><a href="#本站更新记录" class="headerlink" title="本站更新记录"></a>本站更新记录</h1><h2 id="2021-11-9"><a href="#2021-11-9" class="headerlink" title="2021.11.9"></a>2021.11.9</h2><ul><li>字体修改完成，教程在下面</li><li>增加ICP备案号</li></ul><h2 id="2021-11-6"><a href="#2021-11-6" class="headerlink" title="2021.11.6"></a>2021.11.6</h2><ul><li>利用hexo-asset-image插件解决了图片上传的问题，具体见文章</li><li>为域名加上了SSL证书（阿里云可免费申请，百度教程，很快解决），并在github上设置pages为强制HTTPS，这样就算输入HTTP，也会强转为HTTPS，终于是一个安全的站点了</li></ul><h2 id="2021-10-20"><a href="#2021-10-20" class="headerlink" title="2021.10.20"></a>2021.10.20</h2><ul><li>增加了运行时间</li><li>增加了转载版权标识（链接内容有问题，未解决）</li><li>页面底部内容修改</li><li>字体修改：参考：<a href="https://bestzuo.cn/posts/notoserifsc.html">博客网站字体设置：思源宋体 (bestzuo.cn)</a>，<a href="https://www.erenship.com/posts/40222.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%97%E4%BD%93">Hexo’s Fluid 主题私人定制（持续更新） - Eren の 宇宙船 (erenship.com)</a></li></ul><h2 id="2021-10-19"><a href="#2021-10-19" class="headerlink" title="2021.10.19"></a>2021.10.19</h2><ul><li>完善个人信息</li><li>增加了网页访问量统计</li><li>发现首页的文章是可以配图的（原来不是主题不好，是我太菜不会用π_π）</li><li>不会加评论功能。。。</li><li>woc，两个小时候评论功能成功了，其实设置好简单。。</li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hexo解决图片链接问题</title>
    <link href="/2021/11/06/hexo%E8%A7%A3%E5%86%B3%E5%9B%BE%E7%89%87%E9%93%BE%E6%8E%A5%E9%97%AE%E9%A2%98/"/>
    <url>/2021/11/06/hexo%E8%A7%A3%E5%86%B3%E5%9B%BE%E7%89%87%E9%93%BE%E6%8E%A5%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<p>在使用 Hexo 撰写博文时，时常需要将图片嵌入 md 文章中，但往往由于图片保存在本地主机，因此在网页中链接图片时，会无法获取本地主机的图片，导致图片不正常显示，在这里我通过使用Hexo插件的方式，保证图片可以正常上传。</p><ol><li><p>首先安装一个图片路径转换的插件：<code>hexo-asset-image</code>，在Hexo主文件夹下使用如下命令：</p><p><code>npm install https://github.com/CodeFalling/hexo-asset-image --save</code></p></li><li><p> 打开_config.yml文件，将<code>post_asset_folder: false</code>修改为<code>true</code></p></li><li><p> 由于该插件本身可能会存在一下Bug，因此将<code>/node_modules/hexo-asset-image/index.js</code>文件的内容更改为如下代码：</p></li></ol>   <figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-meta">&#x27;use strict&#x27;</span>;<br><span class="hljs-keyword">var</span> cheerio = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;cheerio&#x27;</span>);<br><br><span class="hljs-comment">// http://stackoverflow.com/questions/14480345/how-to-get-the-nth-occurrence-in-a-string</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPosition</span>(<span class="hljs-params">str, m, i</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> str.split(m, i).join(m).length;<br>&#125;<br><br><span class="hljs-keyword">var</span> version = <span class="hljs-built_in">String</span>(hexo.version).split(<span class="hljs-string">&#x27;.&#x27;</span>);<br>hexo.extend.filter.register(<span class="hljs-string">&#x27;after_post_render&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)</span>&#123;<br>  <span class="hljs-keyword">var</span> config = hexo.config;<br>  <span class="hljs-keyword">if</span>(config.post_asset_folder)&#123;<br>    <span class="hljs-keyword">var</span> link = data.permalink;<br><span class="hljs-keyword">if</span>(version.length &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-built_in">Number</span>(version[<span class="hljs-number">0</span>]) == <span class="hljs-number">3</span>)<br>   <span class="hljs-keyword">var</span> beginPos = getPosition(link, <span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-number">1</span>) + <span class="hljs-number">1</span>;<br><span class="hljs-keyword">else</span><br>   <span class="hljs-keyword">var</span> beginPos = getPosition(link, <span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-number">3</span>) + <span class="hljs-number">1</span>;<br><span class="hljs-comment">// In hexo 3.1.1, the permalink of &quot;about&quot; page is like &quot;.../about/index.html&quot;.</span><br><span class="hljs-keyword">var</span> endPos = link.lastIndexOf(<span class="hljs-string">&#x27;/&#x27;</span>) + <span class="hljs-number">1</span>;<br>    link = link.substring(beginPos, endPos);<br><br>    <span class="hljs-keyword">var</span> toprocess = [<span class="hljs-string">&#x27;excerpt&#x27;</span>, <span class="hljs-string">&#x27;more&#x27;</span>, <span class="hljs-string">&#x27;content&#x27;</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; toprocess.length; i++)&#123;<br>      <span class="hljs-keyword">var</span> key = toprocess[i];<br> <br>      <span class="hljs-keyword">var</span> $ = cheerio.load(data[key], &#123;<br>        <span class="hljs-attr">ignoreWhitespace</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">xmlMode</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">lowerCaseTags</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">decodeEntities</span>: <span class="hljs-literal">false</span><br>      &#125;);<br><br>      $(<span class="hljs-string">&#x27;img&#x27;</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br><span class="hljs-keyword">if</span> ($(<span class="hljs-built_in">this</span>).attr(<span class="hljs-string">&#x27;src&#x27;</span>))&#123;<br><span class="hljs-comment">// For windows style path, we replace &#x27;\&#x27; to &#x27;/&#x27;.</span><br><span class="hljs-keyword">var</span> src = $(<span class="hljs-built_in">this</span>).attr(<span class="hljs-string">&#x27;src&#x27;</span>).replace(<span class="hljs-string">&#x27;\\&#x27;</span>, <span class="hljs-string">&#x27;/&#x27;</span>);<br><span class="hljs-keyword">if</span>(!<span class="hljs-regexp">/http[s]*.*|\/\/.*/</span>.test(src) &amp;&amp;<br>   !<span class="hljs-regexp">/^\s*\//</span>.test(src)) &#123;<br>  <span class="hljs-comment">// For &quot;about&quot; page, the first part of &quot;src&quot; can&#x27;t be removed.</span><br>  <span class="hljs-comment">// In addition, to support multi-level local directory.</span><br>  <span class="hljs-keyword">var</span> linkArray = link.split(<span class="hljs-string">&#x27;/&#x27;</span>).filter(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem</span>)</span>&#123;<br><span class="hljs-keyword">return</span> elem != <span class="hljs-string">&#x27;&#x27;</span>;<br>  &#125;);<br>  <span class="hljs-keyword">var</span> srcArray = src.split(<span class="hljs-string">&#x27;/&#x27;</span>).filter(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem</span>)</span>&#123;<br><span class="hljs-keyword">return</span> elem != <span class="hljs-string">&#x27;&#x27;</span> &amp;&amp; elem != <span class="hljs-string">&#x27;.&#x27;</span>;<br>  &#125;);<br>  <span class="hljs-keyword">if</span>(srcArray.length &gt; <span class="hljs-number">1</span>)<br>srcArray.shift();<br>  src = srcArray.join(<span class="hljs-string">&#x27;/&#x27;</span>);<br>  $(<span class="hljs-built_in">this</span>).attr(<span class="hljs-string">&#x27;src&#x27;</span>, config.root + link + src);<br>  <span class="hljs-built_in">console</span>.info&amp;&amp;<span class="hljs-built_in">console</span>.info(<span class="hljs-string">&quot;update link as:--&gt;&quot;</span>+config.root + link + src);<br>&#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br><span class="hljs-built_in">console</span>.info&amp;&amp;<span class="hljs-built_in">console</span>.info(<span class="hljs-string">&quot;no src attr, skipped...&quot;</span>);<br><span class="hljs-built_in">console</span>.info&amp;&amp;<span class="hljs-built_in">console</span>.info($(<span class="hljs-built_in">this</span>));<br>&#125;<br>      &#125;);<br>      data[key] = $.html();<br>    &#125;<br>  &#125;<br>&#125;);<br><br><br></code></pre></div></td></tr></table></figure><ol start="4"><li><p>尝试新建一个md文件，插件会自动在_post目录下生成一个与md文件同名的目录，之后向md文件中加入图片时，需要将该图片先放到同名目录下，然后使用图片链接加入图片，实例：</p><ul><li><p><code>hexo -new &quot;hexo解决图片链接问题&quot;</code></p></li><li><p>接下来会看到_post目录下生成了md文件和同名的文件夹，如图：<img src="/2021/11/06/hexo%E8%A7%A3%E5%86%B3%E5%9B%BE%E7%89%87%E9%93%BE%E6%8E%A5%E9%97%AE%E9%A2%98/1.png" srcset="/img/loading.gif" lazyload alt="生成结果"></p></li><li><p>使用规定的图片链接语法便可以链接图片：<code>[生成结果](1.png)</code>，不需要写路径，插件可以自己转换，只需要把图片名写出来就行。</p></li></ul><p>参考链接：</p><p>​    <a href="https://blog.csdn.net/xjm850552586/article/details/84101345?spm=1001.2101.3001.6650.5&utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-5.no_search_link&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-5.no_search_link"> hexo引用本地图片无法显示_Ericam_-CSDN博客_hexo 图片</a></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>Hexo</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Add Domain</title>
    <link href="/2021/10/23/add-domain/"/>
    <url>/2021/10/23/add-domain/</url>
    
    <content type="html"><![CDATA[<h1 id="域名添加"><a href="#域名添加" class="headerlink" title="域名添加"></a>域名添加</h1><p>​    在成功配置好博客并部署在github上之后，我们可以通过<code>xxxxx.github.io</code>的方式去访问博客，但是我想为自己的博客配置一个自己    的域名，例如本博客的域名：<a href="www.ziyikee.fun">www.ziyikee.fun</a> ,因此便需要去配置一个自己想要的域名。</p><p>​    首先需要在阿里云或腾讯云等厂商那里去买一个域名，比如我的域名是在阿里云上购买的，在购买域名之后，本来以为需要对域名进行    备案才可以使用该域名，然而在进行IPC备案时，对域名备案又需要备案服务码，你必须有自己的服务器才能获得这个备案服务码，因    此我一直以为还需要再买一台服务器才行，但是由于我的博客是直接部署在github上的，并不需要自己配置服务器，现在也没有使用服    务器的需求（服务器贵的一批），所以我以为配置域名估计要gg了。</p><p>​    但是在知乎查教程发现，将一个域名指向另一个域名其实并不需要备案（π—π），只需要下面几步简单的操作就行了：</p><ul><li><p>首先要购买一个域名，各大厂商都有卖，直接百度搜索即可</p></li><li><p>在域名管理处进行域名解析，添加两条新的记录</p><ol><li>记录类型为：CNAME（将一个域名执行另一个域名），主机记录为：www，记录值为：xxxxx.github.io，保存记录</li><li>记录类型为：CNAME（将一个域名执行另一个域名），主机记录为：@，记录值为：xxxxx.github.io，保存记录</li></ol></li></ul><ul><li><p>之后再本地hexo的source目录下，新建一个CNAME文件，文件内容为你的域名，如ziyikee.fun，保存文件</p></li><li><p>hexo g   hexo d，部署到github之后，便可以通过你的域名直接访问博客。</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>Hexo</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>背包九讲-自译版背包</title>
    <link href="/2021/10/18/%E8%83%8C%E5%8C%85%E4%B9%9D%E8%AE%B2-%E8%87%AA%E8%AF%91%E7%89%88/"/>
    <url>/2021/10/18/%E8%83%8C%E5%8C%85%E4%B9%9D%E8%AE%B2-%E8%87%AA%E8%AF%91%E7%89%88/</url>
    
    <content type="html"><![CDATA[<h1 id="背包九讲—自译版"><a href="#背包九讲—自译版" class="headerlink" title="背包九讲—自译版"></a>背包九讲—自译版</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>所谓自译版，就是将某崔大神的背包九讲，用自己理解的意思抄一遍π﹏π（基本结构与内容与原版一致），在最初理解背包问题时，感觉十分难懂，看半天不知所云，因此本文用自己更容易理解的语言复述一遍“背包九讲”，方便日后复习时更方便快捷。</p><h2 id="1-01背包问题"><a href="#1-01背包问题" class="headerlink" title="1.01背包问题"></a>1.01背包问题</h2><p><strong>题目</strong></p><p>有N件物品和一个容量为V的背包。放入第i件物品所占用的容量是c [ i ] ，得到的价值是w [ i ] ,求将哪些物品装入背包可使价值总和最大.（简单来说，就是怎么在容量有限的情况下，使得这个背包里的物品价值总和最大）。</p><p><strong>基本思路</strong></p><p>这是最基础的背包问题，特点是：每件物品仅有一件，可以选择放或不放（这一条件在后面背包问题的延伸中会有所变化，这里是最典型最基础的背包问题。</p><p>用子问题定义状态：即f [ i ] [ j ]表示前  i 件物品恰放入一个容量为  j 的背包可以获得的最大价值（这里原文中使用了“恰”，但实际并不需要正好装满，在初始化可以区分开这两种情况，下文有提及）。则其状态转移方程便是：</p><figure class="highlight inform7"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs inform7">f<span class="hljs-comment">[i]</span><span class="hljs-comment">[j]</span>=max(f<span class="hljs-comment">[i−1]</span><span class="hljs-comment">[j]</span>,f<span class="hljs-comment">[i−1]</span><span class="hljs-comment">[j−c<span class="hljs-comment">[i]</span>]</span>+w<span class="hljs-comment">[i]</span>)<br></code></pre></div></td></tr></table></figure><p>这个方程非常重要，基本上所有跟背包相关的问题的方程都是由它衍生出来的，因此有必要详细解释一下：“将前 i 件物品放入容量为 j 的背包中”这个子问题，若只考虑第 i 件物品的策略（放或不放），那么就可以转化为一个只与前 i - 1 件物品的问题。如果不放第 i 件物品，那么就转化为“前 i- 1 件物品放入容量为 j 的背包中”，其最大价值为 <em>f</em> [i-1] [j]; 如果放第 i 件物品，那么问题就转化为“前 i -1件物品放入剩下的容量为 j - c[j]的背包中”，此时能获取的最大价值就是 <em>f</em> [i-1] [ j - c[ i ]]再加上第 i 件物品获得的价值 w[i]。其伪代码如下：</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">F</span>[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>..V ] ← <span class="hljs-number">0</span> //初始值为<span class="hljs-number">0</span>，这与具体问题有关，下面会详细解释<br><span class="hljs-attribute">for</span> i ← <span class="hljs-number">1</span> to N //第<span class="hljs-number">1</span>个装入V，第<span class="hljs-number">2</span>个装入V......<br><span class="hljs-attribute">for</span> v ← Ci to V //第i个装入v，装入v-<span class="hljs-number">1</span>.....<br><span class="hljs-attribute">F</span>[i, v] ← max&#123;F[i − <span class="hljs-number">1</span>, v], F[i − <span class="hljs-number">1</span>, v − Ci] + Wi&#125;<br><br></code></pre></div></td></tr></table></figure><p><strong>优化空间复杂度</strong></p><p>上述方法的时间和空间复杂度均为<em>O</em>（V *N）,其中时间复杂度已经无法继续优化，但空间复杂度可以优化到 <em>O</em>(N)。</p><p>因为每次循环的内部都是：<code>f[i][j]=max(f[i−1][j],f[i−1][j−c[i]]+w[i])</code>，因此在外层循环中，是变量i在已知进行+1的循环，那么如果我们只用<em>f</em> [ j ]用来表示每次循环时，当前循环第 i 次时向容量为 j 的背包中进行选择（针对第 i 个物品放与不放的选择），那么上一次循环（第 i -1次，第 i - 1个物品）计算的结果，到当前循环（第 i 次，第 i 个物品）时，在第二次循环到 j 时，我们的 <em>f</em> [ j ]的值，其实就是 <em>f</em> [ i-1] [ j ]，<em>f</em> [ j - c[i]]的值其实就是上一轮的 <em>f</em> [ i-1] [ j - c[i]]，因此如果我们在第二层循环中使用倒序：j 从V到 c [ i ]，那么我们在计算时，就可以利用上一轮的计算值，将循环语句改为：<code> f[j] = max(f[j], f[j - c[i]] + w[i]);</code>，因为是倒序，所以在未改变前面的值之前，他们保存的是上一轮（第 i - 1轮）的结果，所以核心代码可优化为：</p><figure class="highlight inform7"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs inform7">for (int i = 1; i &lt;= n; i++)<br>    for (int j = V; j &gt;= c<span class="hljs-comment">[i]</span>; j--)<br>        f<span class="hljs-comment">[j]</span> = max(f<span class="hljs-comment">[j]</span>, f<span class="hljs-comment">[j - c<span class="hljs-comment">[i]</span>]</span> + w<span class="hljs-comment">[i]</span>);<br></code></pre></div></td></tr></table></figure><p>因为每次循环都要利用上一次循环运算结果前面的那些值（ j 要用到上一次的 j 和 j - c [i] )，所以要使用倒序来利用上一轮的值，如果使用顺序的话，当前值改变之后，后面的值就无法利用当前值上一轮的结果了，因为已经发生了改变。</p><p><strong>初始化的细节问题</strong></p><p>这里有一个很巧妙的问题，就是在初始化<em>f</em> [ 0 ] [ j ] ( j 从 0 到 V) 或 <em>f</em> [ j ] ( j 从 0 到 V ) 时，是初始化为 0 还是初始化为 负无穷，这两个值其实是针对不同的问题的：</p><ul><li>如果我们要求最终恰好装满背包，那么除了<em>f</em> [ 0 ]以外的数组值，其初始化的值应该设置为负无穷；</li></ul><ul><li>如果我们要求在背包容量的限制下装价值最大就行，并不要求装满，那么初始化的值应该设置为 0；</li></ul><p>造成该差别的原因依然在循环语句中，我们可以仔细分析一下这句：</p><figure class="highlight inform7"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs inform7">f<span class="hljs-comment">[j]</span> = max(f<span class="hljs-comment">[j]</span>, f<span class="hljs-comment">[j - c<span class="hljs-comment">[i]</span>]</span> + w<span class="hljs-comment">[i]</span>);<br></code></pre></div></td></tr></table></figure><p>当我们把值设为负无穷时，在最初，<em>f</em> [ j ]是负无穷，当我们装入第 i 件物品时，如果恰好装满，那么此时 j  - c [ i ] 等于0，这个时候才可以利用 <em>f</em> [0] = 0，再加上w[i]，使得<em>f</em> [ j ]的值被更新为正的，才能保证后续也恰好装满的时候，值为正的。倘若不能恰好装满，我们是没有办法凑出所有 i 的容量加起来等于V，那么在循环过程中 j  - c [ i ] 永远无法等于0，那就算加上了w[ i ]，也是在负无穷上加一个数还是负的，因此只有恰好装满时，最后再能得到正的价值值。</p><p>但如果我们将初始值都设置为 0 时，不管有没有恰好装满，只要可以装进去就行，我们就能在f[j] 和f[j - c[i]]之间选择一个最大的，即在当前容量下，针对 i 件物品所能装的最大价值值，这时是否恰好装满将不再产生影响。</p><p><strong>小结</strong></p><p>01背包问题是最基本的背包问题，它包含了背包问题中设计状态、方程的最基本思想，另外，别的类型的背包问题往往也可以转换成01背包问题求解。故一定要仔细体会上面基本思路的得出方法，状态转移方程的意义，以及最后怎样优化的空间复杂度。</p><p><strong>例题</strong></p><p><a href="https://www.acwing.com/problem/content/2/">AcWing 01背包问题</a><br><a href="https://www.luogu.org/problemnew/show/P2925">Luogu P2925干草出售</a><br><a href="https://www.luogu.org/problemnew/show/P1616">Luogu P1616疯狂的采药</a><br><a href="http://acm.hdu.edu.cn/showproblem.php?pid=3466">HDU 3466 Proud Merchants</a></p><h2 id="2-完全背包问题（待补充）"><a href="#2-完全背包问题（待补充）" class="headerlink" title="2.完全背包问题（待补充）"></a>2.完全背包问题（待补充）</h2><h2 id="参考链接："><a href="#参考链接：" class="headerlink" title="参考链接："></a>参考链接：</h2><p><a href="https://blog.csdn.net/yandaoqiusheng/article/details/84782655">背包九讲通俗易懂版—我就是抄人家的，写的真好</a></p>]]></content>
    
    
    <categories>
      
      <category>算法与刷题</category>
      
    </categories>
    
    
    <tags>
      
      <tag>动态规划</tag>
      
      <tag>背包问题</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>自旋锁</title>
    <link href="/2021/10/18/%E8%87%AA%E6%97%8B%E9%94%81/"/>
    <url>/2021/10/18/%E8%87%AA%E6%97%8B%E9%94%81/</url>
    
    <content type="html"><![CDATA[<h1 id="自旋锁"><a href="#自旋锁" class="headerlink" title="自旋锁"></a>自旋锁</h1><h2 id="1-提出背景："><a href="#1-提出背景：" class="headerlink" title="1.提出背景："></a>1.提出背景：</h2><p>​    由于多处理器环境中，某些资源的有限性，对于多个线程共享的资源进行访问时，需要进行互斥访问，便需要引入锁的概念，只有获取了锁的线程才可以对资源进行访问，由于多线程的核心是CPU的时间分片，所以同一时刻只能有一个线程获取锁。</p><p>​    当锁没有被占用时，尝试获取锁的线程成功获取到锁，之后若有另外的线程尝试获取锁，通常有两种处理方式：</p><p>​        1.没有获取到锁的线程就一直循环等待判断该资源是否已经释放锁，这种锁叫做自旋锁。</p><p>​        2.没有获取到锁的线程将自己阻塞起来，等待重新调度请求，这种锁叫互斥锁。</p><h2 id="2-自旋锁的定义"><a href="#2-自旋锁的定义" class="headerlink" title="2.自旋锁的定义"></a>2.自旋锁的定义</h2><p>​    自旋锁的定义：当一个线程尝试去获取某一把锁的时候，如果这个锁此时已经被别人获取(占用)，那么此线程就无法获取到这把锁，该线程将会等待，间隔一段时间后会再次尝试获取。这种采用循环加锁 -&gt; 等待的机制被称为<code>自旋锁(spinlock)</code>。</p><h2 id="3-自旋锁的原理"><a href="#3-自旋锁的原理" class="headerlink" title="3.自旋锁的原理"></a>3.自旋锁的原理</h2><p>​    如果持有锁的线程能在短时间内释放资源，那么那些等待竞争锁的线程就不需要进行内核态和用户态之间的切换进入阻塞状态，只需要等待锁的释放（自旋一小段时间），等到持有锁的线程释放锁之后即可获取到锁，这样做的好处是避免了用户进程和内核态切换的消耗。</p><p>​    自旋锁适用于临界区代码执行时间较短的情况，其他竞争线程只需要等待一小会儿便可以获取到锁，而不用在操作系统的调度下进入阻塞状态然后再切换回来，减少了上下文切换的次数，因此获取自旋锁的进程实际上一直处于用户态，并未进行用户态与内核态的切换。但如果获取锁的线程需要长时间的占用锁，则此时使用自旋锁的效率并不高，大量线程竞争一个锁，会导致获取锁的时间很长，线程自旋的消耗大于线程阻塞挂起的消耗，其他需要CPU的线程有不能获取到CPU，会造成CPU的浪费。</p><p>​    自旋锁广泛的应用于操作系统内核，是一种轻量级的互斥锁，但是未申请到锁的线程不会被挂起，而是进入忙等待状态。</p><p>​    重点：自旋锁在使用是会自动禁止抢占，这也是为什么不会被操作系统调度的原因，因此如果一个线程一直在自旋等待锁被释放，那么这段时间他还是一直在占用CPU，其他的线程无法抢占他的CPU。</p><h2 id="4-使用自旋锁的注意事项"><a href="#4-使用自旋锁的注意事项" class="headerlink" title="4.使用自旋锁的注意事项"></a>4.使用自旋锁的注意事项</h2><ul><li><p>不应用于长时间加锁</p></li><li><p>被自旋锁保护的临界区不能调用引起睡眠和阻塞的API函数，否则会造成死锁：</p><p>如果线程 A 在持有锁期间进入了休眠状态，那么线程 A 会自动放弃 CPU 使用权。线程 B 开始运行，线程 B 也想要获取锁，但是此时锁被 A 线程持有，而且内核抢占还被禁止了！线程 B 无法被调度出去，那么线程 A 就无法运行，锁也就无法释放，好了，死锁发生了！</p></li><li><p>不能递归申请自旋锁，因为一旦通过递归的方式申请一个你正在持有的锁，那么你就必须“自旋”，等待锁被释放，然而你正处于“自旋”状态，根本没法释放锁。结果就是自己把自己锁死了！</p></li><li><p>在获取锁之前一定要进行之本地中断（当前CPU中断）</p><p>中断中可以使用自旋锁，但是在进入自旋锁的临界区后，又发生了中断，此时新的中断尝试获取锁，但锁正在被原中断持有，现中断无法获取锁，原中断又被打断，无法释放锁，则会造成死锁。</p><p><img src="https://img-blog.csdnimg.cn/20210704161013832.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjA5NzEwOA==,size_16,color_FFFFFF,t_70" srcset="/img/loading.gif" lazyload alt="本地中断导致死锁"></p></li></ul><h2 id="5-具体实现例子待补充……"><a href="#5-具体实现例子待补充……" class="headerlink" title="5.具体实现例子待补充…….."></a>5.具体实现例子待补充……..</h2><h2 id="6-参考链接（纯搬砖）"><a href="#6-参考链接（纯搬砖）" class="headerlink" title="6.参考链接（纯搬砖）"></a>6.参考链接（纯搬砖）</h2><p><a href="http://www.blogjava.net/jinfeng_wang/archive/2016/12/14/432088.html">Java线程 - CAS自旋锁(spin-lock)</a></p><p><a href="https://blog.csdn.net/zhoutianzi12/article/details/103373976"> 什么是自旋锁+自旋锁和互斥锁的区别</a></p><p><a href="https://www.cnblogs.com/cxuanBlog/p/11679883.html">看完你就明白的锁系列之自旋锁</a></p>]]></content>
    
    
    <categories>
      
      <category>OS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>OS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>剑指32-1</title>
    <link href="/2021/09/24/%E5%89%91%E6%8C%8732-1/"/>
    <url>/2021/09/24/%E5%89%91%E6%8C%8732-1/</url>
    
    <content type="html"><![CDATA[<h1 id="剑指-Offer32-I-从上到下打印二叉树"><a href="#剑指-Offer32-I-从上到下打印二叉树" class="headerlink" title="剑指 Offer32-I.从上到下打印二叉树"></a>剑指 Offer32-I.从上到下打印二叉树</h1><hr><p><strong>题目要求：</strong></p><p>从上到下打印出二叉树的每个节点，同一层的节点按照从左到右的顺序打印.</p><p>例如：给定二叉树[3,9,20,null,null,15,7]</p><div class="hljs code-wrapper"><pre><code>    3   / \  9  20     / \    15 7 </code></pre></div><p>返回：[3,9,20,15,7]</p><p><strong>题目分析:</strong></p><ul><li>对二叉树进行打印实际就是对其进行遍历，根据题目要求，同一层节点按照从左到右的顺序进行遍历，所以应采用层序遍历的方法去遍历。</li><li>层序遍历：借助队列进行实现，要保证读取当前节点后，接下里读取器左右节点，然后是左子节点的左右节点，然后是右子节点的左右节点。起初思路有些错误，想通过递归去进行读取，但是递归一旦深入到一棵子树中，便会继续深入下去，是无法返回保证按层读取的，实际上并不需要递归处理。</li><li>通过队列实现层序遍历：首先将根节点加入队列，然后当队列不为空时进入循环，每一次循环，取出队列头结点，并读取节点数据，然后将其左右节点加入队列（子节点不为空），这样的话，下一次左子节点从队列头取出，同时将其左右子节点加入队列，这样就保证了队列中的数据顺序是按照层序遍历的顺序弹出的。</li><li>注意事项：针对根节点为空，做出针对处理。队列集合对象为Integer,先用Integer数组保存数据，然后转化成int[],返回数组。</li></ul><p><strong>代码实现：</strong></p><div class="hljs code-wrapper"><pre><code>class Solution &#123;ArrayList&lt;Integer&gt; b = new ArrayList&lt;Integer&gt;(1004);Queue&lt;TreeNode&gt; q = new ArrayDeque&lt;&gt;(1004);public int[] levelOrder(TreeNode root) &#123;    if(root == null) &#123;        int[] a = new int[0];        return a;    &#125;    q.add(root);    int i = 0;    TreeNode tem  =  new TreeNode(0) ;    while(!(q.isEmpty()))&#123;        tem = q.remove();        b.add(tem.val);        if(tem.left != null)&#123;            q.add(tem.left);        &#125;        if(tem.right != null)&#123;            q.add(tem.right);        &#125;    &#125;    int[] a = new int[b.size()];    Iterator&lt;Integer&gt; in = b.iterator();    while(in.hasNext())&#123;        a[i++] = in.next();    &#125;    return a;    &#125;&#125;</code></pre></div><p>通过本题主要复习一下使用队列进行层序遍历，以及熟悉Markdown写法。</p>]]></content>
    
    
    <categories>
      
      <category>算法与刷题</category>
      
    </categories>
    
    
    <tags>
      
      <tag>刷题笔记</tag>
      
      <tag>二叉树</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
