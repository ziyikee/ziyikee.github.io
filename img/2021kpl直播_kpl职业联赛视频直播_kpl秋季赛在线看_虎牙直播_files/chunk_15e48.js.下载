(window.HUYA_MAIN_APP_WEBPACK_JSONP=window.HUYA_MAIN_APP_WEBPACK_JSONP||[]).push([[319],{312:function(n,t,e){"use strict";e.d(t,"f",(function(){return E})),e.d(t,"i",(function(){return M})),e.d(t,"l",(function(){return S})),e.d(t,"k",(function(){return A})),e.d(t,"j",(function(){return _})),e.d(t,"e",(function(){return N})),e.d(t,"h",(function(){return T})),e.d(t,"g",(function(){return C})),e.d(t,"a",(function(){return D})),e.d(t,"o",(function(){return U})),e.d(t,"c",(function(){return x})),e.d(t,"d",(function(){return k})),e.d(t,"m",(function(){return B})),e.d(t,"n",(function(){return W}));var o=e(19),r=e.n(o);function c(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,o)}return e}function i(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?c(Object(e),!0).forEach((function(t){u(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):c(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function u(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var a="//liveapi.huya.com",m="".concat(a,"/moment/getSectionsByPidOrGameId"),f="".concat(a,"/moment/getSectionMomentList"),s="".concat(a,"/moment/getUserSectionMomentList"),d="".concat(a,"/moment/removeMoment"),p="".concat(a,"/moment/sectionStatus"),l="".concat(a,"/moment/checkUserPassedAnswer"),v="".concat(a,"/moment/VoteMomentAndCheckStat"),g="".concat(a,"/moment/postMoment"),h="".concat(a,"/moment/postComment"),b="".concat(a,"/moment/getMomentContent"),P="".concat(a,"/moment/favorComment"),w="".concat(a,"/moment/favorMoment"),O="".concat(a,"/moment/stepOnMoment"),y=new r.a;function I(n,t){var e="string"==typeof n?{url:n,data:t}:i({},n);return new Promise((function(n,t){$.ajax(i({type:"GET",dataType:"json",cache:!1,xhrFields:{withCredentials:!0},__forceTrace:!0,timeout:8e3},e)).done((function(e){var o=e.status,r=e.data,c=e.msg;if(200==o)if(r&&j(r.msg)){var i=new Error(r.msg);i.name="SafeAuthError",y.emit(i.name,i.message),t(i)}else n(r);else if(j(c)){var u=new Error(c);u.name="SafeAuthError",y.emit(u.name,u.message),t(u)}else t(new Error("".concat(c,"(").concat(o,")")))})).fail((function(n,e){t(new Error("网络异常(".concat(e,")")))}))}))}function j(n){return"string"==typeof n&&/^http/.test(n)}function E(n){var t=n.uid,e=n.seed,o=n.section,r=n.iWhichTab;return I(f,{uid:t,seed:e,section:o,iWhichTab:void 0===r?0:r}).then((function(n){var t=n||{},e=t.moment,o=void 0===e?[]:e,r=t.seed,c=void 0===r?0:r,u=t.commNum,a=void 0===u?0:u,m=t.browseNum,f=void 0===m?0:m;return{moments:o.map((function(n){var t=n.momentInfo,e=n.voteInfo;return i(i({},t),{},{voteInfo:e})})),seed:c,commNum:a,browseNum:f}}))}function M(n){var t=n.uid,e=n.seed;return I(s,{uid:t,seed:e,status:0}).then((function(n){var t=n||{},e=t.moment,o=void 0===e?[]:e,r=t.seed;return{moments:o.map((function(n){var t=n.momentInfo,e=n.voteInfo;return i(i({},t),{},{voteInfo:e})})),seed:r}}))}function S(n){var t=n.uid,e=n.momId,o=n.belongPlate;return I(d,{uid:t,momId:e,belongPlate:o})}function A(n){var t=n.uid,e=n.text,o=n.images,r=n.vote,c=n.belongPlate;return new Promise((function(n,u){var a=o.map((function(n){return{url:n.url,corverUrl:n.corverUrl,fileMD5:n.md5}}));I(g,{uid:t,title:e,type:a.length?4:3,files:JSON.stringify(a),voteTitle:r.title,voteOption:r.options.map((function(n,t){return[t+1,n.content,""].join(",")})).join(";"),vBelongPlate:c}).then((function(t){t?""==t.sMsg?n(i(i({},t.tMoment),{},{voteInfo:t.momentVoteInfo})):u(new Error("".concat(t.sMsg))):u(new Error("响应数据为空"))})).catch(u)}))}function _(n){return I(h,n)}function N(n){return I(b,i(i({},n),{},{noEscape:!0}))}function T(n,t){return I({url:m,data:{uid:n,gameIdOrPid:t},cache:!0})}function C(){return I({url:p,cache:!0})}function D(n){return I(l,{uid:n})}function U(n,t,e){return I(v,{uid:n,sVoteId:t,sOptionId:e})}function x(n,t,e,o){return I(P,{uid:n,momId:t,comId:e,op:o})}function k(n,t,e){return I(w,{uid:n,momId:t,op:e})}function B(n,t,e){return I(O,{uid:n,momId:t,op:e})}function W(n){return new Promise((function(t,e){$.ajax({url:"".concat("https://q.huya.com","/matchguess/index.php?m=MomentImage&do=upload"),type:"POST",data:n,dataType:"json",processData:!1,contentType:!1}).done((function(n){var o=n.status,r=n.data,c=n.msg;1==o?t(r):e(new Error("".concat(c,"(").concat(o,")")))})).fail((function(n,t){e(new Error("网络异常(".concat(t,")")))}))}))}t.b={on:y.on.bind(y),off:y.off.bind(y)}}}]);