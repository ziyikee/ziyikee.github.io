(window.HUYA_MAIN_APP_WEBPACK_JSONP=window.HUYA_MAIN_APP_WEBPACK_JSONP||[]).push([[75],{49:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FramePicMatcher=t.PetSourceType=void 0;var a,r=n(12),o=(0,r.__importDefault)(n(19)),i=(0,r.__importStar)(n(350)),u=(0,r.__importDefault)(n(0)),s=n(842);(0,r.__exportStar)(n(843),t),function(e){e[e.Pic=0]="Pic",e[e.Name=1]="Name",e[e.FramePic=2]="FramePic",e[e.VapConf=3]="VapConf",e[e.DynamicVapConf=4]="DynamicVapConf",e[e.Grade=5]="Grade",e[e.Score=6]="Score"}(a=t.PetSourceType||(t.PetSourceType={})),t.FramePicMatcher=/card_anim_(\d+)/i;var c=function(e){function t(){var t=e.call(this)||this;return t.memoReq=null,t.info={vMountsInfoList:{value:[]},tExterInfo:{sDIYDomain:""}},t.list=t.info.vMountsInfoList.value,u.default.isH5&&u.default.ready((function(e){e.addTafListener("6575",(function(e){t.emit("UserDIYMountsChange",e)}))})),t}return(0,r.__extends)(t,e),t.prototype.find=function(e){return this.list.find((function(t){var n=t.lMountsId;return e==n}))},t.prototype.getInfo=function(){var e=this;if(null===this.memoReq){var t=(0,s.getMountsList)();t.then((function(t){e.info=t,e.list=t.vMountsInfoList.value,e.emit("update")})).catch((function(t){e.emit("error",t)})),this.memoReq=t}return this.memoReq},t.prototype.readAssets=function(e,t){var n=this,r=e.lPetId,o=e.iPetType,u=e.mPetDetail;return new Promise((function(e,s){var c=n.find(r);if(!c)throw new Error("NOT FOUND ("+r+")");var f=c.sWEBZipUrl;if(!f)throw new Error("NO RESOURCES");var d=f.replace(/^http\:/,"https:"),m=(u||{value:{}}).value,l=(m.id,m.score),_=void 0===l?"0":l,v=m.level,P=void 0===v?"0":v;if(t!==a.FramePic)if(t!==a.Score){var M="",h="";switch(t){case a.Name:M=2===o?"pet_name_"+P+".png":"pet_name.png",h="base64";break;case a.Pic:M=2===o?"pet_pic_"+P+".png":"pet_pic.png",h="base64";break;case a.Grade:M="card_grade_"+P+".png",h="base64";break;case a.VapConf:M="vapc.json",h="text";break;case a.DynamicVapConf:M="dynamic_vapc.json",h="text";break;default:throw new Error("Invalid PetSourceType '"+t+"'")}e((0,i.default)(d,M,h).then((function(e){var t;switch(h){case"base64":t={name:M,type:"img",data:"data:image/png;base64,"+e};break;case"text":t={name:M,type:/\.json$/.test(M)?"json":"text",data:/\.json$/.test(M)?JSON.parse(e):e};break;default:t={name:M,type:h,data:e}}return t})))}else e((0,i.loadZip)(d).then((function(e){return function(e,t){return new Promise((function(n,a){var r=(parseInt(t,10)>0?t:"0").split("").map((function(e){return"iscore_"+e+".png"})),o=r.map((function(t){return(0,i.readFile)(e,t,"base64")}));n(Promise.all(o).then((function(e){return{name:r.join(","),type:"img",data:e.map((function(e){return"data:image/png;base64,"+e}))}})))}))}(e,_)})));else e((0,i.loadZip)(d).then(p))}))},t}(o.default);function p(e){return new Promise((function(n,a){var r=Object.keys(e.files||{}).find((function(e){return t.FramePicMatcher.test(e)}));r?n((0,i.readFile)(e,r,"base64").then((function(e){return{name:r,type:"img",data:"data:image/png;base64,"+e}}))):a(new Error("NOT FOUND FOR FRAME PICTURE"))}))}t.default=new c},842:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMountsList=void 0;var a=(0,n(12).__importDefault)(n(0));t.getMountsList=function(){return new Promise((function(e,t){var n=setTimeout((function(){t(new Error("timeout"))}),8e3);a.default.on("getMountsListRsp",(function(t){clearTimeout(n),e(t)}),!0)}))}},843:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EDIYMountsType=t.EDIYMountsChangedType=void 0,function(e){e[e.MountsObtain=0]="MountsObtain",e[e.MountsUpgrade=1]="MountsUpgrade",e[e.ModuleScoreUp=2]="ModuleScoreUp",e[e.ModuleUpgrade=3]="ModuleUpgrade"}(t.EDIYMountsChangedType||(t.EDIYMountsChangedType={})),function(e){e[e.Car=1]="Car",e[e.Pet=2]="Pet"}(t.EDIYMountsType||(t.EDIYMountsType={}))}}]);