(window.HUYA_MAIN_APP_WEBPACK_JSONP=window.HUYA_MAIN_APP_WEBPACK_JSONP||[]).push([[357],{147:function(e,t,n){"use strict";n.r(t);n(451);var a=n(34),i=n(14),o=n(68),r=n(292),u=n(291),c=n(1430),d=n(361),f=n(431),l=Object(d.e)(c.a,u.g,Object(d.a)(f.a)),s=n(0),g=n(3),p=n(296),m=n(307),T=n(309),b=["6294","6295","6296","6231","6232","6298"],I={uri_6294:function(e){l.getState().panelUI.isShow&&l.dispatch(Object(T.i)(e))},uri_6295:function(e){l.getState().panelUI.isShow&&l.dispatch(Object(T.i)(e))},uri_6296:function(e){l.getState().panelUI.isShow&&l.dispatch(Object(T.a)(e))},uri_6231:function(e){l.getState().panelUI.isShow&&g.default.lp==e.lBadgeId&&l.dispatch(Object(T.g)(e))},uri_6232:function(e){var t=l.getState(),n=t.anchorInfo;if(t.panelUI.isShow){var a=!1;!n.badge||!e.iBadgeLevelChanged&&!e.iSuperFansInfoChanged||e.tBadgeInfo.sBadgeName!=n.badge.name&&e.tBadgeInfo.tFaithInfo.sFaithName!=n.badge.name||(a=!0),a&&l.dispatch(Object(T.b)(e))}},uri_6298:function(e){Object(m.e)({uid:e.lUid,nick:e.sNickName,nobleLevel:e.iNobleLevel,isLegendary:66==e.tNobleLv.iAttrType,badge:{level:e.iBadgeLevel,name:e.sBadgeName,id:e.lBadgeId,type:e.iBadgeType,isSuperFans:parseInt(e.iSFFlag||0),iCustomBadgeFlag:e.iCustomBadgeFlag},msg:e.tBarrage.sContent,color:u.h[e.tBarrage.iTVColor],msgIcon:!!e.sDiyIcon&&e.sDiyIcon.replace(/<size>|&lt;size&gt;/,"26_26").replace(/<ua>|&lt;ua&gt;/,"web")})}};function h(e,t){s.default.ready((function(n){"function"!=typeof t&&(t=function(){}),n.addTafListener(e,(function(n){TT.log(e,n),t(n)}))}))}!function(){for(var e=0;e<b.length;e++)h(b[e],I["uri_"+b[e]])}(),TT.getUserInfo().done((function(e){p.default.add(e.uid,g.default.lp,(function(e){l.dispatch(Object(T.d)(e));var t=l.getState();if(t.playerInfo.following){l.dispatch(Object(T.e)(!1));var n=t.panelInfo.info.pack[t.playerInfo.giftTVChoice],a=n.iItemId,i=n.iItemNum;Object(m.g)(a,i),l.dispatch(Object(T.c)(""))}})).state&&l.dispatch(Object(T.d)(!0))})),s.default.on("onTVTimer",(function(e){l.getState().panelUI.isShow&&l.dispatch(Object(T.m)(e))})),s.default.on("SendCardPackageItemRspTV",(function(e){if(l.getState().panelUI.isShow&&e.isTv){try{ya.reportProductEvent({eid:"click/onTVLottery/giftSuccess",eid_desc:"点击/上电视/礼物弹幕发送成功",gameid:TTR.gid,ayyuid:g.default.lp})}catch(e){}Object(m.h)(React.createElement(React.Fragment,null,"弹幕已收到~ ",React.createElement("br",null)," 稍后将会选出幸运观众！"))}}));var E=n(1429);function S(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function v(){l.dispatch(Object(T.n)())}var y=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.createWrap(),Object(o.render)(i.default.createElement(r.a,{store:l},i.default.createElement(E.a,{clickCloseBtn:function(){t.destory()}})),this.onTVLotteryWrap),!l.getState().anchorInfo.badge&&l.dispatch(Object(T.f)()),l.dispatch(Object(T.h)()).then((function(){l.dispatch(Object(T.j)())}))}var t,n,a;return t=e,(n=[{key:"createWrap",value:function(){var e=document.createElement("div");e.id="wrap-onTVLottery",document.body.appendChild(e),this.onTVLotteryWrap=e}},{key:"destory",value:function(){this.onTVLotteryWrap.remove(),v()}}])&&S(t.prototype,n),a&&S(t,a),e}(),_=null;TTP.on("liveStatusChange",(function(e){l.getState().panelUI.isShow&&0==e.status&&_.destory()}));t.default=function(){l.getState().panelUI.isShow==u.f.PANEL_SHOW?(_.destory(),_=null):a.default.then((function(){_=new y,v()}))}},291:function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return f}));var a={PANEL_SHOW:1,PANEL_HIDE:0},i={STATE_NONE:0,STATE_START:1,STATE_SETTLE:2,STATE_RESULT:3},o={MODE_MANUAL:0,MODE_AUTO:1,MODE_GIFT:2,MODE_BEFANS:4,MODE_Stalk:5},r={TYPE_BLACK_WHITE:0,TYPE_COLOR:1,TYPE_LARGE_COLOR:2},u={PARTIC_ALL:0,PARTIC_FANS:1,PARTIC_SUB:2,PARTIC_SFANS:3},c={FALSE:0,TRUE:1,YEAR:2},d=["#4B4B4B","#9FDE33","#33DE65","#50DBDB","#1ABBFF","#FF76B6","#FF5151","#FF8300","#FFDE00"],f={panelUI:{isShow:a.PANEL_HIDE,showDialog:""},anchorInfo:{badge:!1,defaultGift:{type:"",name:"",amount:0}},panelInfo:{state:i.STATE_NONE,isDiy:!1,diyInfo:{},info:{onTVId:0,mode:o.MODE_AUTO,partic:u.PARTIC_ALL,title:"主题",anchorLogo:"主播头像",award:{amount:0,name:"名称"},tvQueue:[{forFree:1,type:r.TYPE_BLACK_WHITE,typeName:"黑白",price:0,amount:1},{forFree:4,type:r.TYPE_COLOR,typeName:"彩电",price:0,amount:5},{forFree:10,type:r.TYPE_LARGE_COLOR,typeName:"大彩电",price:0,amount:3}],tvQueue_superFans:[{type:c.TRUE,price:0,amount:6},{type:c.YEAR,price:0,amount:3}],pack:[],leftTime:0,receivedAmount:0}},playerInfo:{follow:!1,isFollowing:!1,fansLevel:0,isSuperFans:0,iCustomBadgeFlag:0,tvType:r.TYPE_BLACK_WHITE,tvColor:0,sentAmount:0,placeholder:"我要上电视",msg:"",giftTVChoice:0},result:{info:[]}}},307:function(e,t,n){"use strict";n.d(t,"e",(function(){return h})),n.d(t,"f",(function(){return E})),n.d(t,"i",(function(){return S})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return y})),n.d(t,"b",(function(){return _})),n.d(t,"g",(function(){return A})),n.d(t,"a",(function(){return L})),n.d(t,"h",(function(){return O}));var a=n(28),i=n.n(a),o=n(42),r=n.n(o),u=n(0),c=n(3),d=n(2),f=n(74),l=n(296),s=n(51),g=n(78),p=n(33),m=n.n(p),T=n(321),b=n(158),I=n(1248);function h(e){if(!g.default.test(e.msg)){var t=f.CustomFansBadge.getCustomBadgeAssets(e.badge.iCustomBadgeFlag,{lBadgeId:e.badge.id,iBadgeLevel:e.badge.level,tSuperFansInfo:{iSFFlag:e.badge.isSuperFans}}),n={nobleLevel:e.nobleLevel,isLegendary:e.isLegendary,fansLabel:t?T.a.createCustom(e.badge.level,e.badge.name,e.badge.id,e.badge.isSuperFans,t):T.a.create(e.badge.level,e.badge.name,e.badge.id,e.badge.type,e.badge.isSuperFans),uid:e.uid,nickName:e.nick,msg:HUYA_UTIL.unescape(e.msg),color:e.color,msgIcon:e.msgIcon};m.a.append((function(e,t){var a=document.createElement("div");return r.a.render(i.a.createElement(I.a,n),a),t((function(){r.a.unmountComponentAtNode(a)})),a}))}}function E(){Object(s.default)(c.default.lp,d.default.id,d.default.sid,d.default.gid)}function S(e){return e.replace(/(^\s*)|(\s*$)/g,"")}function v(e){if(e){var t=parseInt(e/60),n=e%60;return(t=t<10?"0"+t:t)+":"+(n=n<10?"0"+n:n)}return"00:00"}function y(e,t){var n=e.info.tvQueue[t.tvType];return t.fansLevel>=n.forFree||t.isSuperFans?0:parseInt(n.price)}function _(e){return e>=1e4?(e%1e4<1e3?parseInt(e/1e4):(e/1e4).toFixed(1))+"万":e}function A(e,t){u.default.call("giveGift",{num:t,fromType:1,type:e,isTv:!0})}function L(e){return new Promise((function(t,n){var a=l.default.get(c.default.lp);(e?a.on():a.off()).done((function(){t(a.state)}))}))}function O(e){Object(b.toast)({content:e,feature:"onTVLottery",container:document.getElementById("onTVLottery-panel"),duration:1500})}},451:function(e,t,n){}}]);