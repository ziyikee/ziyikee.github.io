(window.HUYA_MAIN_APP_WEBPACK_JSONP=window.HUYA_MAIN_APP_WEBPACK_JSONP||[]).push([[490],{1262:function(t,e,n){},1263:function(module,exports){module.exports=function anonymous(locals,escapeFn,include,rethrow){rethrow=rethrow||function(t,e,n,a,r){var o=e.split("\n"),c=Math.max(a-3,0),i=Math.min(o.length,a+3),p=r(n),l=o.slice(c,i).map((function(t,e){var n=e+c+1;return(n==a?" >> ":"    ")+n+"| "+t})).join("\n");throw t.path=p,t.message=(p||"ejs")+":"+a+"\n"+l+"\n\n"+t.message,t},escapeFn=escapeFn||function(t){return null==t?"":String(t).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(t){return _ENCODE_HTML_RULES[t]||t}var __line=1,__lines='<div class="room-gg-chat" area="<%= container %>" data-ggid="<%= data.id %>">\n\n    <% if(data.jump_url){ %>\n    <a class="pic J_pic" href="<%= $.trim(data.jump_url) %>" title="<%= data.title %>" target="_blank">\n        <img class="pic-img" src="<%= TT.trimUrl(data.img_url) %>">\n    </a>\n    <% }else{ %>\n    <span class="pic J_pic" title="<%= data.title %>">\n        <img class="pic-img" src="<%= TT.trimUrl(data.img_url) %>">\n    </span>\n    <% } %>\n\n    <% if(data.close_way == 1 || data.close_way == 4){ %>\n    <span class="ps_close J_close"></span>\n    <% } %>\n</div>',__filename="widget/roomGgChat/tpl.tmpl";try{var __output="";function __append(t){null!=t&&(__output+=t)}with(locals||{})__append('<div class="room-gg-chat" area="'),__append(escapeFn(container)),__append('" data-ggid="'),__append(escapeFn(data.id)),__append('">\n\n    '),__line=3,data.jump_url?(__append('\n    <a class="pic J_pic" href="'),__line=4,__append(escapeFn($.trim(data.jump_url))),__append('" title="'),__append(escapeFn(data.title)),__append('" target="_blank">\n        <img class="pic-img" src="'),__line=5,__append(escapeFn(TT.trimUrl(data.img_url))),__append('">\n    </a>\n    '),__line=7):(__append('\n    <span class="pic J_pic" title="'),__line=8,__append(escapeFn(data.title)),__append('">\n        <img class="pic-img" src="'),__line=9,__append(escapeFn(TT.trimUrl(data.img_url))),__append('">\n    </span>\n    '),__line=11),__append("\n\n    "),__line=13,1!=data.close_way&&4!=data.close_way||(__append('\n    <span class="ps_close J_close"></span>\n    '),__line=15),__append("\n</div>"),__line=16;return __output}catch(e){rethrow(e,__lines,__filename,__line,escapeFn)}}},148:function(t,e,n){"use strict";n.r(e);n(1262);var a=n(19),r=n.n(a),o=n(3),c=n(2);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=s(t);if(e){var r=s(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return u(this,n)}}function u(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(n,t);var e=l(n);function n(){var t,a,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(t=e.call(this)).stroageName="TT_ROOM_GG_CHAT_CLOSE",t.data=null,(a=o.default.lp,r=c.default.gid,new Promise((function(t,e){$.ajax({url:"//g.huya.com/cache1min.php?m=Api&do=getPositionContent&position_id=11",type:"GET",dataType:"jsonp",jsonpCallback:"roomGgChatJsonpCallback",data:{pid:a,gid:r},cache:!0}).done((function(e){200==e.status&&e.data&&t(e.data)}))}))).then((function(e){var n=parseInt(localStorage.getItem(t.stroageName),10),a=e[0];!a||1!=a.close_way&&4!=a.close_way||-1!=a.day_close_click_count&&n&&!(a.day_close_click_count>n)||(t.data=a,t.emit("update"))})),t}return n}(r.a)),d=n(76),f=n(44),m=n.n(f);d.default.on("update:roomGgChat",(function(){var t=$('.room-gg-chat[area="chat"]');if(t.length){var e=$("#wrap-"+d.default.topPanel()),n=e.length?e.height()+60+"px":"135px";t.css("top",n)}}));e.default=function(){_.on("update",(function(){var t=null,e=n(1263),a=$(e({container:"chat",data:_.data})),r=$(e({container:"player",data:_.data}));function o(){a.remove(),r.remove()}$("#chatRoom").append(a),$("#player-resource-wrap").length&&$("#player-resource-wrap").append(r),d.default.emit("update:roomGgChat"),setTimeout((function(){try{ya.reportProductEvent({eid:"pageview/position",position:"room/gg/chat",resourceid:_.data.id})}catch(t){}}),2e3),$(".room-gg-chat").on("click",".J_pic",(function(t){$.trim(_.data.jump_url)||t.preventDefault();var e=$(this).parents(".room-gg-chat")[0].getAttribute("area");try{ya.reportProductEvent({eid:"click/position",position:"room/gg/chat"+("player"==e?"player":""),resourceid:_.data.id})}catch(t){}})).on("click",".J_close",(function(e){var n=parseInt(localStorage.getItem(_.stroageName),10);n?n++:n=1,localStorage.setItem(_.stroageName,n),clearTimeout(t),o();var a=$(this).parents(".room-gg-chat")[0].getAttribute("area");try{ya.reportProductEvent({eid:"click/room/gg/chat"+("player"==a?"player":"")+"/close",eid_desc:"点击/直播间/广告/chat"+("player"==a?"player":"")+"/关闭"})}catch(e){}})),4==_.data.close_way&&function(){clearTimeout(t);var e=parseInt((new Date).getTime()/1e3)+_.data.display_duration;!function n(){var a=parseInt((new Date).getTime()/1e3);e-a>0?t=setTimeout((function(){n()}),1e3):(clearTimeout(t),o())}()}(),m.a.on("change",(function(t){m.a.cfg[3e4]&&o()}))}))}}}]);