(window.HUYA_MAIN_APP_WEBPACK_JSONP=window.HUYA_MAIN_APP_WEBPACK_JSONP||[]).push([[200],{1082:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),r=function(e){function t(t,r,a,s,o){var c=e.call(this)||this;return c.data=null,c.__startTime=0,c.__lastTimming=0,c.data=t,c.__startTime=(new Date).getTime(),Promise.resolve().then((function(){return(0,i.__importStar)(n(1083))})).then((function(e){(0,e.show)({container:a[0],data:t,cfg:r,onStart:function(){c.__startTime=(new Date).getTime()},onEnd:function(){var e=(new Date).getTime()-c.__startTime,t=c.__lastTimming-c.__startTime>.75*e;o(t?c.data:null,!1)},listenComb:function(e){return c.on("comb",e)},unlistenComb:function(e){return c.off("comb",e)}})})).catch((function(e){o(null,!1)})),c}return(0,i.__extends)(t,e),t.prototype.comb=function(e){this.__lastTimming=(new Date).getTime(),this.data=e,this.emit("comb",this.data=e)},t}((0,i.__importDefault)(n(19)).default);t.default=r},1100:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),r=function(e){function t(t,r,a,s,o){var c=e.call(this)||this;return c.data=null,c.__startTime=0,c.__lastTimming=0,c.data=t,c.__startTime=(new Date).getTime(),Promise.resolve().then((function(){return(0,i.__importStar)(n(1101))})).then((function(e){(0,e.show)({container:a[0],data:t,cfg:r,onStart:function(){c.__startTime=(new Date).getTime()},onEnd:function(){var e=(new Date).getTime()-c.__startTime,t=c.__lastTimming-c.__startTime>.75*e;o(t?c.data:null,!1)},onError:function(e){c.emit("error",e)},listenComb:function(e){return c.on("comb",e)},unlistenComb:function(e){return c.off("comb",e)}})})).catch((function(e){c.emit("error",e)})),c}return(0,i.__extends)(t,e),t.prototype.comb=function(e){this.__lastTimming=(new Date).getTime(),this.data=e,this.emit("comb",this.data=e)},t}((0,i.__importDefault)(n(19)).default);t.default=r},143:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),a=n(44),s=n.n(a),o=n(4),c=n.n(o),u=n(349),l=n(350),f=n.n(l),p=n(322),d=n.n(p),m=n(429),g=n.n(m),v=n(359),h=n.n(v),b=function(e){this.defaults={ele:null,times:10,dir:"x",duration:1e3,widthOrHeight:1e3,steps:10},this.settings=$.extend(this.defaults,e,!0),this.obj=this.settings.ele,this.times=this.settings.times,this.duration=this.settings.duration,this.steps=this.settings.steps,this.oneStep=this.settings.widthOrHeight/this.settings.steps,this.speed=this.duration/this.steps,this.dir=this.settings.dir,this.handler=null,this.step=0,this.time=0};b.prototype={constructor:b,play:function(){this.step>=this.steps&&(this.step=0,this.time++),0==this.times||this.time<this.times?("y"==this.dir?this.obj.style.backgroundPosition="0px "+-this.oneStep*this.step+"px":this.obj.style.backgroundPosition=-this.oneStep*this.step+"px 0px",this.step++):this.stop()},start:function(){var e=this;this.handler=setInterval((function(){e.play()}),this.speed)},stop:function(){clearInterval(this.handler),this.handler=this.obj=null}};var y=n(319),T=n(360),I=n(294),S=n(1082),w=n.n(S),P=n(1100),O=n.n(P);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){L(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function N(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"low",r=arguments.length>4?arguments[4]:void 0;this.data=e;var a='<div class="g-bigStreamer"><div class="g-bigStreamer-prop"></div><div class="g-bigStreamer-comb"><i class="g-bigStreamer-x"></i><span class="g-bigStreamer-count">'+N.createN(e.iItemCount*e.iItemGroup)+'</span></div><div class="g-bigStreamer-ft"><div class="g-bigStreamer-tips"><span class="g-bigStreamer-avatar J_sender" data-uid="'+e.lSenderUid+'">'+(e.tNobleLevel.iNobleLevel?'<i class="noble-bg noble-bg-'+e.tNobleLevel.iNobleLevel+(66==e.tNobleLevel.iAttrType?" legendary":"")+'"></i><i class="noble-icon noble-level-'+e.tNobleLevel.iNobleLevel+(66==e.tNobleLevel.iAttrType?" legendary":"")+'"></i>':"")+'<img src="'+TT.trimUrl(e.iSenderIcon)+'" data-default-img="normal" alt="avatar" /></span><span class="g-bigStreamer-sender J_sender" data-uid="'+e.lSenderUid+'" title="'+_.escape(HUYA_UTIL.unescape(e.sSenderNick))+'">'+_.escape(HUYA_UTIL.unescape(e.sSenderNick))+'</span><span>&nbsp;送&nbsp;</span><span class="g-bigStreamer-pName">'+t.sPropsName||!1;n.html(a);var s=Object(T.default)(t,n.find(".g-bigStreamer-prop"),66==e.tNobleLevel.iAttrType,i,n);s.start();var o=(new Date).getTime(),c=!1,u=!1;function l(r){this.data=e=r;var a=e,l=a.iItemCount,f=a.iItemGroup,p=a.iUpgradeLevel;(n.find(".g-bigStreamer-count").html(N.createN(l*f)),"low"===i&&t.iPropsUpgradeType>0&&p>0)?(u=!0,c=!0):(new Date).getTime()-o>.75*s.duration&&(c=!0)}setTimeout((function(){s.stop(),n.empty(),r(c?e:null,u)}),s.duration),this.comb=l}N.createN=function(e){for(var t=(e+"").split(""),n="",i=0;i<t.length;i++)n+='<b class="g-bigStreamer-n n-'+t[i]+'"></b>';return n};var x=null,G=[];$("#J_bigStreamerStage").on("click",".J_sender",(function(){var e=$(this).data("uid");e&&I.default.open({uid:e,muteText:"[大礼物特效]"})}));var j=function(e){d()().then((function(t){var n=t.map;if(n[e.iItemType]){var i=!1;if(e.iItemGroup>1){var r=h.a.createGroupId(e),a=[].concat(G).reverse().find((function(e){return r===h.a.createGroupId(e)}));a?e.iItemGroup>a.iItemGroup&&G.splice(G.indexOf(a),1,e):x&&r===h.a.createGroupId(x.data)?e.iItemGroup>x.data.iItemGroup&&x.comb(e):i=!0}else i=!0;i&&(G.push(e),y.default.process((function(e,t){var i=G.shift(),r=n[i.iItemType],a=r.iPropsUpgradeType>0&&i.iUpgradeLevel>0?"high":"low";!function e(t,n,i,r,a){var s=N;switch(n.iPropsUseType){case 2:s=w.a;break;case 3:s=O.a;break;default:s=N}x=new s(t,n,i,r,(function(t,s){t?e(t,n,i,s?"high":r,a):(x=null,a())})),s===O.a&&x.on("error",(function(s){console.log(s),e(t,U(U({},n),{},{iPropsUseType:1}),i,r,a)}))}(i,r,$("#J_bigStreamerStage"),a,e)})))}else TT.log("礼物（"+e.iItemType+"）流光数据未配置")}))},k=n(8),A=new function(e){var t=new k.a;return t.info=e,t.update=function(e){t.info=e,t.emit("change",e)},t.find=function(e){if(0!==t.info.iType)for(var n=0,i=t.info.vInfo.value.length;n<i;n++)if(t.info.vInfo.value[n].lXid==e)return t.info.vInfo.value[n];return null},t.parseText=function(e){for(var t="",n=0,i=e.length;n<i;n++)0==(1&n)?n!=i-1&&(t+='<span style="color:'+e[n]+'">'):t+=e[n]+"</span>";return t},t}({iType:0}),E=new function(e){var t=new k.a;return t.info=e,t.update=function(e){t.info=e,t.emit("change",e)},t}({lXid:0}),D={camp:A,support:E};i.default.isH5?i.default.one("SupportCampInfoRsp",A.update,!0):i.default.on("SupportCampInfoRsp",(function(e){A.update(e.param)}),!0),i.default.ready((function(e){i.default.isH5&&e.addTafListener("1025300",A.update)})),i.default.isH5?i.default.one("UserSupportCampRsp",E.update,!0):i.default.on("UserSupportCampRsp",(function(e){E.update(e.param)}),!0),i.default.ready((function(e){i.default.isH5&&e.addTafListener("1025301",E.update)}));var H=n(33),M=n.n(H),q=D.camp,J=null,R=new $.Deferred;try{J=JSON.parse(localStorage.getItem("TT_PROP_MSG_CFG"))}catch(e){}J&&R.resolve(),d()().then((function(e){var t=e.list;J={},t.forEach((function(e){var t=J[e.iPropsId]={iDisplayCd:e.iDisplayCd,iCount:e.iCount};t.gif="";try{var n=e.vPropsIdentity.value[0].sPropsWeb,i=n.indexOf("&"),r=-1==i?n:n.substring(0,i);t.gif=TT.trimUrl(r)}catch(e){}}));try{localStorage.setItem("TT_PROP_MSG_CFG",JSON.stringify(J))}catch(e){}R.resolve()})),R.done((function(){g.a.on("fire",(function(e){if(!s.a.cfg[20001]){!function(e){var t=J[e.iItemType],n=e.lSenderUid,i=B[n];if(t)if(t.iCount>0){var r=e.iItemType+"x"+e.iItemCount;i&&i.id==r?i.add(e):(i&&i.off(),B[n]=new W({id:r,displayDelay:1e3*t.iDisplayCd,count:t.iCount,displayCallback:function(e,t){F(t.pop(),e)},offCallback:function(){B[n]=null}}),B[n].add(e))}else i&&i.off(),F(e);else i&&i.off(),F(e)}(e);try{TT.emit("LIVE_ROOM_PROP_NOTICE",{data:e})}catch(e){}}}))}));var B={};function W(e){e=$.extend({id:"",displayDelay:0,count:1,offDelay:3e4,displayCallback:function(){},offCallback:function(){}},e);var t=c.a.debounce(s,e.offDelay),n=c.a.debounce(a,e.displayDelay),i=0,r=[];function a(){r.length&&(n.cancel(),e.displayCallback(i,r),r=[])}function s(){t.cancel(),a(),e.offCallback()}return{id:e.id,add:function(s){t(),i=s.iItemGroup,r.push(s),1==i||i%e.count==0?a():n()},off:s}}var Y={};function F(e,t){t=t||1;var n=e.iItemType,i=Y[n],a=J[n]?J[n].gif:"";if(!i)if(i=Y[n]=new $.Deferred,a){var s=new Image;s.onload=function(){i.resolve()},s.onerror=function(){i.reject()},s.src=a,i.always((function(){s.onload=s.onerror=null,s=null}))}else i.reject();i.always((function(){var n={};try{n=JSON.parse(HUYA_UTIL.unescape(e.sSendContent))}catch(e){}var i=n.supportCamp?q.find(n.supportCamp.id):null,s="";i&&(s='<p class="cont-item supportCampText">'+q.parseText(i.vChatText.value)+"</p>",s+='<span class="cont-item supportCampPic"><img src="'+TT.trimUrl(i.sLogoUrl).replace(".png","_3.png")+'" /></span>');try{e.sSenderNick=decodeURIComponent(e.sSenderNick)}catch(e){}var o='<div class="tit-h-send"><span class="cont-item name J_userMenu" title="点击查看个人信息">'+HUYA_UTIL.xssFilter(HUYA_UTIL.unescape(e.sSenderNick))+'</span><span class="cont-item">送</span><span class="cont-item send-gift"><img src="'+a+'" alt="'+e.sPropsName+'" /></span><span class="cont-item">'+e.iItemCount+"</span>"+(t>1?'<span class="cont-item send-comb">'+t+"连击</span>":"")+s+(10==r.default.liveSourceType?'<span class="cont-item gGive">给</span><span class="cont-item pName">'+HUYA_UTIL.xssFilter(HUYA_UTIL.unescape(e.sPresenterNick))+"</span>":"")+"</div>";M.a.append((function(t,n){var i=document.createElement("div");return i.innerHTML=o,i.addEventListener("click",(function(t){t.target&&-1!=t.target.className.indexOf("J_userMenu")&&I.default.open({uid:e.lSenderUid,muteText:"[礼物消息]"})}),!1),i}))}))}function K(e){d()().then((function(t){var n=t.map;n[e.iItemType]&&n[e.iLotteryItemType]&&(c.a.getUid()&&c.a.getUid()==e.lSenderUid&&i.default.isH5?y.default.preprocess((function(t,i){new X(e,n[e.iItemType],n[e.iLotteryItemType],$("#J_bigStreamerStage"),(function(){t(),V(e,n)}))})):V(e,n))}))}function X(e,t,n,i,r){var a='<div class="ssq-bigStreamer"><div class="ssq-bigStreamer-prop"></div><div class="ssq-bigStreamer-comb"><i class="ssq-bigStreamer-x"></i><span class="ssq-bigStreamer-count">'+X.createN(e.iItemCount)+'</span></div><div class="ssq-bigStreamer-ft"><div class="ssq-bigStreamer-tips">抽签中...</div></div><div class="ssq-bigStreamer-award"></div></div>';i.html(a);var s=Object(T.default)(t,i.find(".ssq-bigStreamer-prop"),66==e.tNobleLevel.iAttrType);s.start(),setTimeout((function(){var r=new Image;r.src=Z(n,"sPropsPic108"),i.find(".ssq-bigStreamer-award").append(r),i.find(".ssq-bigStreamer-tips").html("你送给主播"+t.sPropsName+"*"+e.iItemCount+"，抽出&nbsp;<span>"+n.sPropsName+"</span>")}),s.duration/2),setTimeout((function(){s.stop(),i.empty(),r()}),s.duration)}function V(e,t){var n='<div class="ssq-msg"><span class="cont-item name J_userMenu" title="点击查看个人信息">'+HUYA_UTIL.xssFilter(HUYA_UTIL.unescape(e.sSenderNick))+'</span><span class="cont-item">送</span><span class="cont-item send-gift"><img src="'+Z(t[e.iItemType],"sPropsWeb")+'" alt="礼物-'+e.iItemType+'" /></span><span class="cont-item">'+e.iItemCount+'&nbsp;，抽出</span><span class="cont-item send-gift"><img src="'+Z(t[e.iLotteryItemType],"sPropsWeb")+'" alt="礼物-'+e.iLotteryItemType+'" /></span></div>';M.a.append((function(t,i){var r=document.createElement("div");return r.innerHTML=n,r.querySelector(".J_userMenu").addEventListener("click",(function(){I.default.open({uid:e.lSenderUid,muteText:"[礼物消息]"})}),!1),r}))}function Z(e,t){var n=e.vPropsIdentity.value[0][t]||"",i=n.indexOf("&");return TT.trimUrl(-1==i?n:n.substring(0,i))}i.default.isH5?i.default.ready((function(e){e.addTafListener("6616",K)})):i.default.on("lotterySubNotify",(function(e){K(e.param)})),X.createN=function(e){for(var t=(e+"").split(""),n="",i=0;i<t.length;i++)n+='<b class="ssq-bigStreamer-n n-'+t[i]+'"></b>';return n};var z=n(1116);function Q(e){d()().then((function(t){var n=t.map,i=document.getElementById("J_bigStreamerStage");i&&!s.a.cfg[20002]&&y.default.process((function(t){Object(z.a)({container:i,data:e,giftConf:n,onUnmount:t})}))}))}i.default.isH5&&i.default.ready((function(e){e.addTafListener("6514",Q)}));n(1119);var ee=n(1120),te=n.n(ee),ne=n(1121),ie=n.n(ne),re=n(1122),ae=n.n(re),se=n(1123),oe=n.n(se);function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){le(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fe(e){return function(e){if(Array.isArray(e))return pe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pe(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var de=D.camp,me=!1,ge={};function ve(e){var t=[];for(var n in e){var i=e[n],r=i.id,a=i.url,s=i.widthOrHeight,o=i.steps,c=i.duration,u=i.iStreamId,l="".concat("huya-room-gif").concat(r).concat(u||"");t.push("@keyframes ".concat(l," {\n    0% {\n        background-position: 0 0;\n    }\n    100% {\n        background-position: -").concat(s,'px 0;\n    }\n}\n.gif-animation[data-type="').concat(l,'"] {\n    width: ').concat(s/o,'px;\n    background: url("').concat(TT.trimUrl(a),'");\n}\n.show[data-type="').concat(l,'"] {\n    animation: ').concat(l," ").concat(c,"ms steps(").concat(o,") infinite;\n}\n"))}return t.join("")}!function(){for(var e=[te.a,ie.a,ae.a,oe.a],t=e.length;t--;)(new Image).src=e[t]}();var he=function(e){this.settings=$.extend({id:0,count:1,hideTime:2e3,speed:300,userInfo:null,gifInfo:null,callback:function(){}},e),this.id=this.settings.id,this.gift=null,this.timer=null,this.animation=null,this.bgAnimation=null,this.container=this.settings.container,this.showTime=(new Date).getTime()+this.settings.speed,this.init()};he.prototype={constructor:he,init:function(){var e=this;this.gift=this.createEle();var t=null;this.setHideTimer=function(n){clearTimeout(t),t=setTimeout((function(){e.hide()}),n)},this.groupCount=c.a.throttle((function(){var t='<i class="g-combo"></i>'+e.creatNumber(e.settings.totalGroup),n=e.gift.find(".combo-wrap").removeClass("show").html(t);setTimeout((function(){n.addClass("show")}),10)}),220),setTimeout((function(){e.show((function(){e.groupCount()})),2==e.settings.userInfo.streamerInfo.iStreamerLevel&&e.high()}),16),e.setHideTimer(e.settings.speed+e.settings.hideTime)},add:function(e){this.settings.hideTime+=300,this.setHideTimer(this.settings.hideTime-((new Date).getTime()-this.showTime)),2==e.streamerInfo.iStreamerLevel&&this.high(),this.settings.totalGroup=e.iItemGroup,this.groupCount()},createEle:function(){var e=this.settings,t=e.userInfo,n=(e.type,e.id),i=this.container.height()/4,r='<div class="g-gift" id="gift'+n+'" style="top:'+(60*e.index+i)+'px">';return r+=this.settings.sendText,r+='<span class="count">'+$.map((t.iItemCountByGroup+"").split(""),(function(e){return'<i class="n-'+e+'"></i>'})).join("")+"</span>",r+='<div class="combo-wrap"></div>',r+='<div class="bg glv-'+t.streamerInfo.iGiftLevel+" slv-"+t.streamerInfo.iStreamerLevel+" mrt-"+t.streamerInfo.iMaterialType+'"></div>',r+="</div>",this.container.append(r),$("#gift"+n)},show:function(e){var t=this.gift,n=t.find(".gif-animation");n.addClass("show"),t.addClass("g-show"),setTimeout(e,this.settings.speed)},high:function(){if(!this.bgAnimation){var e=this.gift.find(".bg");e.addClass("slv-2"),e.addClass("show")}},hide:function(){var e=this,t=e.gift;e.animation,e.bgAnimation;e.settings.hideBefore.call(this),t.removeClass("g-show").addClass("g-hide"),t.on("transitionend webkitTransitionEnd oTransitionEnd",(function(){t.remove(),e.gift=null,e.container=null,e.settings.hideAfter()}))},creatNumber:function(e){for(var t=(e+"").split(""),n="",i=0;i<t.length;i++)n+='<span class="combo-num combo-num'+t[i]+'"></span>';return n}};var be=new u.a(3);d()().then((function(e){var t,n=e.list;t={},n.forEach((function(e){var n=e.iPropsId,i=e.vPropsIdentity.value[0];if(i){var r=i.sPropStreamerResource,a=i.iStreamerFrameRate;t[n]={id:n,url:r,widthOrHeight:60*a,steps:a,duration:1e3*Math.round(a/10)}}})),ge=t,HUYA_UTIL.createStyleSheet(ve(ge)),me=!0}));var ye={init:function(){var e=this;this.$container=$(".chat-room__bd"),s.a.on("change",(function(t){s.a.cfg[20002]&&(be.clear(),e.queueStreamerEffects=[])}))},currentStreamerEffects:[],queueStreamerEffects:[],receivePropMessage:function(e,t){var n=this,i=this.$container;e.iItemType;try{e.sSenderNick=decodeURIComponent(e.sSenderNick)}catch(e){}var r=_.escape(e.sSenderNick),a=ge[e.iItemType],s="".concat((new Date).getTime(),"-").concat(Math.floor(1e6*Math.random())),o=e.tNobleLevel.iNobleLevel,c=66==e.tNobleLevel.iAttrType,u={};try{u=JSON.parse(HUYA_UTIL.unescape(e.sSendContent))}catch(e){}var l=null,f=u.supportCamp&&(l=de.find(u.supportCamp.id))?function(e,t,n,i,r,a){return'<div class="g-textStream2"><p class="nick">'+(e>0?'<span class="noble-icon noble-level-'+e+(t?" legendary":"")+'"></span>':"")+'<span class="name">'+i+'</span></p><p class="camp">'+de.parseText(a.vFlowText.value)+'</p></div><div class="gif-wrap"><div class="gif-animation" data-type="'+"".concat("huya-room-gif").concat(r).concat(n||"")+'"></div></div>'}(o,c,t,r,e.iItemType,l):function(e,t,n,i,r){var a='<div class="g-textStream">';e>0&&(a+='<span class="noble-icon noble-level-'+e+(t?" legendary":"")+'"></span>');return a+='<span class="nick">'+i+"</span>",a+='<span class="send">送</span>',a+="</div>",a+='<div class="gif-wrap">',a+='<div class="gif-animation" data-type="'+"".concat("huya-room-gif").concat(r).concat(n||"")+'"></div>',a+="</div>"}(o,c,t,r,e.iItemType),p=!1;if(e.iItemGroup>1){var d=h.a.createGroupId(e),m=fe(n.queueStreamerEffects).reverse().find((function(e){return d===h.a.createGroupId(e)})),g=fe(n.currentStreamerEffects).reverse().find((function(e){var t=e.settings.userInfo;return d===h.a.createGroupId(t)}));if(m)e.iItemGroup>m.iItemGroup&&n.queueStreamerEffects.splice(n.queueStreamerEffects.indexOf(m),1,e);else if(g){var v=g.settings.userInfo;e.iItemGroup>v.iItemGroup&&g.add(e)}else p=!0}else p=!0;p&&(n.queueStreamerEffects.push(e),be.process((function(e,t){var r=n.queueStreamerEffects.shift(),o=new he({id:s,nick:r.sSenderNick,index:t,totalGroup:r.iItemGroup,userInfo:r,gifInfo:a,sendText:f,container:i,hideBefore:function(){var e=n.currentStreamerEffects.indexOf(o);-1!==e&&n.currentStreamerEffects.splice(e,1)},hideAfter:e});n.currentStreamerEffects.push(o)})))}};ye.init(),d()().then((function(e){var t=e.map;g.a.on("comb",(function(e){if(1!=i.default.displayMode&&2!=i.default.displayMode&&!s.a.cfg[20002]&&me){var n=e.streamerInfo,r=n.iGiftLevel,a=n.iStreamerLevel;if(3==r)i.default.isH5&&j(e);else if(1==a||2==a){var o=t[e.iItemType];if(o){var c=3===o.iPropsUseType,u=(o.vPropsIdentity.value[0]||{}).sPropStreamerResourceZip,l=e.tEffectInfo.iStreamId;c&&u&&l>0?f()("".concat(u).split("&")[0],"".concat(l,".png"),"base64").then((function(t){HUYA_UTIL.createStyleSheet(ve(le({},e.iItemType,ue(ue({},ge[e.iItemType]),{},{url:"data:image/png;base64,".concat(t),iStreamId:l})))),ye.receivePropMessage(e,l)})).catch((function(t){ye.receivePropMessage(e),console.error(t)})):ye.receivePropMessage(e)}}}}))}))},322:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),r=n(4),a=(0,i.__importDefault)(n(0));var s=(0,r.once)((function(){return new Promise((function(e){a.default.on("getGifObj",(function(t){var n,i={},r=(n=t.param,"[object Array]"===Object.prototype.toString.call(n)?t.param:t.param.vPropsItemList.value);r.forEach((function(e){i[e.iPropsId]=e})),e({map:i,list:r,getPropsIcon:function(e){var t="";try{t=i[e].vPropsIdentity.value[0].sPropsWeb}catch(e){}var n=t.indexOf("&");return-1==n?t:t.substring(0,n)}})}),!0)}))}));t.default=s},359:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamerGroup=void 0;var i=function(){function e(t){this.id="",this.info={},t&&(this.id=e.createGroupId(t),this.info=t)}return e.createGroupId=function(e){return e.lSenderUid+"-"+e.iItemType+"-"+e.lComboSeqId},e}();t.StreamerGroup=i,t.default=i},360:function(e,t,n){"use strict";n.r(t),n.d(t,"createCssAnimation",(function(){return l}));var i=n(4),r=n.n(i),a=n(430),s=n.n(a),o="",c=r.a.supportsStyle("animation",(function(e){e&&(o="-"+e.toLowerCase()+"-")}));var u={};function l(e,t){var n="".concat(e.iPropsId,"_").concat(e.type).concat(e.isLegendary?"_god":"");return u[n]||(e.name="bigStreamer"+n,r.a.importStyle(function(e){var t="";return t+="@"+o+"keyframes "+e.name+" {",t+="0% { background-position: 0 bottom; }",t+="100% { background-position: -"+e.width*e.steps+"px bottom; }",t+="}",t+=".animation-"+e.name+"{",t+='background: url("'+e.bgImg+'") no-repeat;',t+=o+"animation: "+e.name+" "+e.duration+"ms steps("+e.steps+") infinite;",t+="}"}(e)),u[n]=e),$.extend({},u[n],{start:function(){$(t).addClass("animation-"+u[n].name)},stop:function(){$(t).removeClass("animation-"+u[n].name)}})}function f(e,t){var n=0,i=null,r=function(n){t.css("backgroundPosition","-"+e.width*(n-1)+"px bottom")};return $.extend({},e,{start:function(){t.css("backgroundImage","url("+e.bgImg+")"),r(n=1),i=setInterval((function(){n=n+1<=e.steps?n+1:1,r(n)}),e.duration/e.steps)},stop:function(){clearInterval(i)}})}t.default=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"low",r=arguments.length>4?arguments[4]:void 0,a=s()(e,i,n),o=a.width,u=a.steps,p=a.bgImg,d=a.duration,m=/\.apng$/.test(p),g={iPropsId:e.iPropsId,width:o,steps:u,bgImg:p,duration:d,isLegendary:n,type:i},v=c?l(g,t):f(g,t);return $.extend({},v,{start:function(){m&&r.addClass("streamer-full"),v.start()},stop:function(){m&&r.removeClass("streamer-full"),v.stop()}})}},429:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Notify=t.Comb=void 0;var i=n(12),r=(0,i.__importDefault)(n(19)),a=n(4),s=(0,i.__importDefault)(n(359)),o=(0,i.__importDefault)(n(0)),c=function(e){function t(t){void 0===t&&(t=5e3);var n=e.call(this)||this;return n.count=0,n.reset=(0,a.debounce)(n.end.bind(n),t),n}return(0,i.__extends)(t,e),t.prototype.end=function(){this.emit("end")},t.prototype.add=function(e){return e>this.count&&(this.count=e,this.reset(),!0)},t}(r.default);t.Comb=c;var u=function(e){function t(){var t=e.call(this)||this;return t.groups={},o.default.ready((function(e){o.default.isH5?e.addTafListener("6501",(function(e){return t.fire(e)})):o.default.on("SendItemEx",(function(e){var n=e.param.data;return t.fire(n)}))})),t}return(0,i.__extends)(t,e),t.prototype.fire=function(e){var t=this;this.emit("fire",e);var n=s.default.createGroupId(e),i=this.groups[n];i||(i=this.groups[n]=new c).on("end",(function(){t.groups[n]=null})),i.add(e.iItemGroup)&&this.emit("comb",e)},t}(r.default);t.Notify=u,t.default=new u},430:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={iWebBigGiftFrameRate:0,sPropBigGiftWeb:"",iWebBigGiftFrameRateHigh:0,sPropBigGiftWebHigh:""};function r(e,t){void 0===e&&(e=i);var n=e.iWebBigGiftFrameRate,r=e.sPropBigGiftWeb,a=e.iWebBigGiftFrameRateHigh,s=e.sPropBigGiftWebHigh,o=n,c=TT.trimUrl(r.split("&")[0]);return"high"===t&&a&&s&&(o=a,c=TT.trimUrl(s.split("&")[0])),{steps:o,bgImg:c}}t.default=function(e,t,n){var i=e.vPropsIdentity,a=e.vPropsIdentityGod;void 0===t&&(t="low"),void 0===n&&(n=!1);var s=r((n?a:i).value[0],t),o=s.steps,c=s.bgImg;if(n&&(!c||!o)){var u=r(i.value[0],t);o=u.steps,c=u.bgImg}return{width:340,steps:o,bgImg:c,duration:1e3*Math.round(o/10)}}}}]);