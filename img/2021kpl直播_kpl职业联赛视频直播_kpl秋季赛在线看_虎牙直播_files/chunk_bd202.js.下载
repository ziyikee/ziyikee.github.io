(window.HUYA_MAIN_APP_WEBPACK_JSONP=window.HUYA_MAIN_APP_WEBPACK_JSONP||[]).push([[66],{301:function(e,t,n){"use strict";n.d(t,"b",(function(){return T})),n.d(t,"a",(function(){return O})),n.d(t,"d",(function(){return y})),n.d(t,"c",(function(){return S}));var r=n(0),o=n(2),i=n(3),u=n(50),s=n(19),a=n.n(s),l=n(4);function c(e){return new Promise((function(t,n){var o=setTimeout((function(){return n(new Error("TIMEOUT"))}),5e3);r.default.isH5?r.default.ready((function(n){var r=Object.assign(new n.taf.HUYA.AlterAuditorReq,{tId:n.userId},e);n.sendWup2("liveui","alterAuditor",r,(function(e){clearTimeout(o),t(e)}))})):n(new Error("NOT SUPPORTING FLASH"))}))}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b(e);if(t){var o=b(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return g(this,n)}}function g(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return R(e)}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T={SUPER_MANAGER:1,NORMAL_MANAGER:2,NET_POLICE:3,ZHIXU:4,GUILD_MANAGER:5,NORMAL_USER:6},O={All:-1,Null:0,Mute:1,UnMute:2,AddBlack:4,RevokeBlack:8,DelComment:16,Waring:32},y={MuteSpeak:0,AddBlackList:1,MuteIP:2,DeleteVedioBarrage:3,DeleteVedioComment:4,Warning:5},S={NULL:0,MUTED_PID:1,MUTED_GLOBAL:2,BLACKLIST_PID:3,BLACKLIST_GLOBAL:4,WARNING:5},M=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(a,e);var t,n,i,s=U(a);function a(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var i,c=R(n=s.call(this));function f(n){var r=n.param?n.param.data:n,o=r.lPid,i=r.lUid,u=(r.sNick,r.bSendMessagePopUp),s=r.sSendMessageTips,a=r.iSendMessagePopUpAmtTime,l=r.tRoleStatu,f=l.tRole,d=l.iType;if((!o||e==o)&&(c.emit("changeNoticeGlobal",r),t&&i&&t==i)){Object.assign(c.__roleInfo,{bSendMessagePopUp:u,sSendMessageTips:s,iSendMessagePopUpAmtTime:a});var p=0!=(1&d);p&&Object.assign(c.__roleInfo,{tRole:f}),p&&c.emit("roleChange",c.__roleInfo),c.emit("changeNotice",c.__roleInfo)}}return n.__presenter=e,n.__roleInfo={lUid:t||0,sNick:"",bSendMessagePopUp:!1,sSendMessageTips:"",iSendMessagePopUpAmtTime:0,tRole:{iRole:0,lPermission:0}},n.getMyRoleInfo=(i=Object(l.once)((function(){return new Promise((function(n,i){if(t){var s=setTimeout((function(){return i(new Error("TIMEOUT"))}),5e3),a=Object(l.once)((function(e){var r=e.param?e.param.data:e,o=r.lUid,i=r.sNick,u=r.bSendMessagePopUp,a=r.sSendMessageTips,l=r.iSendMessagePopUpAmtTime,f=r.tRoleStatuInfo.tRole;t==o&&(clearTimeout(s),c.__roleInfo={lUid:o,sNick:i,bSendMessagePopUp:u,sSendMessageTips:a,iSendMessagePopUpAmtTime:l,tRole:f},n())}));r.default.isH5?(u.a.on("10040",a,!0),(f={lPresenterUid:e,lSid:o.default.id,lSubSid:o.default.sid},d=f.lPresenterUid,p=f.lSid,v=f.lSubSid,new Promise((function(e,t){var n=setTimeout((function(){return t(new Error("TIMEOUT"))}),5e3);r.default.isH5?r.default.ready((function(t){var r=Object.assign(new t.taf.HUYA.GetAuditorRoleReq,{tId:t.userId,lPresenterUid:d,lSid:p,lSubSid:v});t.sendWup2("liveui","getAuditorRole",r,(function(t){clearTimeout(n),e(t)}))})):t(new Error("NOT SUPPORTING FLASH"))}))).then(a).catch(i)):r.default.on("onAuditorEnter",a,!0)}else n();var f,d,p,v}))})),function(){return i().then((function(){return c.__roleInfo}))}),r.default.isH5?r.default.ready((function(e){return e.addTafListener("10041",f)})):r.default.on("onAuditorRoleChange",f),r.default.isH5&&r.default.ready((function(t){t.addTafListener("10039",(function(t){t.lPid==e&&c.emit("warningNotice",t)}))})),n}return t=a,(n=[{key:"mute",value:function(e){return function(e){return new Promise((function(t,n){var o=setTimeout((function(){return n(new Error("TIMEOUT"))}),5e3);r.default.isH5?r.default.ready((function(r){var i=Object.assign(new r.taf.HUYA.MuteRoomUserReq,{tId:r.userId},e);r.sendWup2("liveui","muteRoomUser",i,(function(e){var r=e.iRetCode,i=e.sMsg;clearTimeout(o),0===r?t({iRetCode:r,sMsg:i}):n(new Error(i))}))})):n(new Error("NOT SUPPORTING FLASH"))}))}(p({lPresenterUid:this.__presenter,lSubcid:o.default.sid,iRole:this.__roleInfo.tRole.iRole},e))}},{key:"batchMute",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return new Promise((function(o,i){var u=setTimeout((function(){return i(new Error("TIMEOUT"))}),5e3);r.default.isH5?r.default.ready((function(r){var s=new r.taf.HUYA.BatchMuteRoomUserReq;n.forEach((function(e){return s.vMute.value.push(Object.assign(new r.taf.HUYA.MuteInfo,e))})),Object.assign(s,p({tId:r.userId,lPid:t.__presenter,iRole:t.__roleInfo.tRole.iRole},e)),r.sendWup2("liveui","batchMuteRoomUser",s,(function(e){var t=e.iCode,n=e.sMsg;clearTimeout(u),0===t?o({iCode:t,sMsg:n}):i(new Error(n))}))})):i(new Error("NOT SUPPORTING FLASH"))}))}},{key:"unMute",value:function(e){return function(e){return new Promise((function(t,n){var o=setTimeout((function(){return n(new Error("TIMEOUT"))}),5e3);r.default.isH5?r.default.ready((function(r){var i=Object.assign(new r.taf.HUYA.UnMuteRoomUserReq,{tId:r.userId},e);r.sendWup2("liveui","unMuteRoomUser",i,(function(e){var r=e.iRetCode,i=e.sMsg;clearTimeout(o),0===r?t({iRetCode:r,sMsg:i}):n(new Error(i))}))})):n(new Error("NOT SUPPORTING FLASH"))}))}(p({lTid:o.default.id,lSubcid:o.default.sid},e))}},{key:"dealReportMessage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new Promise((function(n,i){var u=setTimeout((function(){return i(new Error("TIMEOUT"))}),5e3);r.default.isH5?r.default.ready((function(r){var s=new r.taf.HUYA.DealReportMessageReq;t.forEach((function(e){s.vMsg.value.push(Object.assign(new r.taf.HUYA.RMessageBase,e))})),Object.assign(s,{tId:r.userId,sLiveId:o.default.liveId,lPid:e.__presenter,iType:1}),r.sendWup2("mobileui","dealReportMessage",s,(function(e){var t=e.iCode,r=e.sMsg;clearTimeout(u),0===t?n({iCode:t,sMsg:r}):i(new Error(r))}))})):i(new Error("NOT SUPPORTING FLASH"))}))}},{key:"addRoomKeeper",value:function(e){var t=this,n=e.lAuditorUid,r=e.lExpireTime,o=e.lPermission;return new Promise((function(e,i){c({iAction:1,lAuditorUid:n,lExpireTime:r,lPermission:o,lPresenterUid:t.__presenter}).then((function(t){var n=t.iRetCode,r=t.sMsg;0===n?e({iRetCode:n,sMsg:r}):i(new Error(r))})).catch(i)}))}},{key:"removeRoomKeeper",value:function(e){var t=this,n=e.lAuditorUid;return new Promise((function(e,r){c({iAction:2,lAuditorUid:n,lPresenterUid:t.__presenter}).then((function(t){var n=t.iRetCode,o=t.sMsg;0===n?e({iRetCode:n,sMsg:o}):r(new Error(o))})).catch(r)}))}},{key:"getUserType",value:function(e){return function(e){var t=e.lUid,n=e.lPresenterUid,o=e.lSid,i=e.lSubSid;return new Promise((function(e,u){var s=setTimeout((function(){return u(new Error("TIMEOUT"))}),5e3);r.default.isH5?r.default.ready((function(r){var u=Object.assign(new r.taf.HUYA.GetUserTypeReq,{tId:r.userId,lUid:t,lPresenterUid:n,lSid:o,lSubSid:i});r.sendWup2("liveui","getUserType",u,(function(t){clearTimeout(s),e(t)}))})):u(new Error("NOT SUPPORTING FLASH"))}))}({lUid:e,lPresenterUid:this.__presenter,lSid:o.default.id,lSubSid:o.default.sid})}},{key:"isManager",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.__roleInfo.tRole.iRole,t=T.SUPER_MANAGER,n=T.NORMAL_MANAGER,r=T.GUILD_MANAGER;return e===t||e===n||e===r}},{key:"hasPermission",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.__roleInfo.tRole.lPermission,t=arguments.length>1?arguments[1]:void 0;return t===O.All||(t&e)===e}},{key:"containsStatus",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return!!t.find((function(t){return t.iStatu===e}))}}])&&m(t.prototype,n),i&&m(t,i),a}(a.a);t.e=new M(i.default.lp,Object(l.getUid)())}}]);