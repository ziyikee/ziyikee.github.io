(window.HUYA_MAIN_APP_WEBPACK_JSONP=window.HUYA_MAIN_APP_WEBPACK_JSONP||[]).push([[509],{1133:function(e,t,a){},121:function(e,t,a){"use strict";a.r(t);var n=a(2),i=a(3),l=a(24),r=(a(302),a(34)),o=a(1128),c=a.n(o),s=(a(1133),"//q.huya.com");var d;function u(e){e=$.extend({index:0,className:"",init:function(){},change:function(){}},e);var t=-1,a=$(e.nav),n=$(e.pane),i=$.Callbacks();function l(l){t!==l&&(t=l,a.removeClass(e.className).eq(t).addClass(e.className),n.hide().eq(t).show(),i.fire(t))}return l(e.index),e.init(t),i.add(e.change),a.on("click",(function(e){e.preventDefault(),l($(this).index())})),{index:function(){return t},change:function(e){i.add(e)},go:l}}function f(e){var t=a(1129),n="";return $.each(e,(function(e,a){a&&(n+="<li>"+t({data:a,giftShelfMap:r.giftShelfMap,imgAvatar:c.a})+"</li>")})),{html:"<ul>"+n+"</ul>"}}function p(e,t){var n=a(1130),l=$('<div class="gwr-rank-list"></div>');return l.html(function(e){var t=[];return $.each(e,(function(e,a){a&&t.push(n({data:a,giftShelfMap:r.giftShelfMap,imgAvatar:c.a}))})),'<div class="gwr-rank-item">'+t.join('</div><div class="gwr-rank-item">')+"</div>"}(e)),l.off("mouseenter",".J_cr").on("mouseenter",".J_cr",(function(e){var a=$(this),n=a.find(".J_crAnchorInfo");n.hasClass("loading")&&$.ajax({type:"GET",url:s+"/?m=GiftWeekStar&do=getUserRankingNew",dataType:"jsonp",data:{uid:i.default.lp,propid:a.data("pid"),weekStarType:t}}).always((function(){n.removeClass("loading")})).done((function(e){if(200==e.status)if(e.data){var t=e.data.iRanking;n.html('<img class="avatar" src="'+TT.trimUrl(e.data.avatar)+'" alt="'+_.escape(i.default.nick)+'" /><div class="info"><p class="name" title="'+_.escape(i.default.nick)+'">'+_.escape(i.default.nick)+'</p><p class="count">收到: '+e.data.iPropsNum+'</p><p class="num">'+(t>0?"排名: "+(t<100?t:"99+"):"未上榜")+"</p></div>")}else n.html('<p style="text-align:center;">-- 获取数据失败，请稍后重试 --</p>');else n.html('<p style="text-align:center;">-- 获取数据失败: '+e.msg+" --</p>")})).fail((function(e,t){n.html('<p style="text-align:center;">-- 获取数据失败: '+t+" --</p>")}))})),{view:l}}function m(e){var t=a(1131),n=$(t()),i=n.find(".J_gwrRanks");i.addClass("loading"),$.ajax({type:"GET",url:e.url,dataType:"jsonp"}).done((function(t){if(200==t.status){if(!t.data)return void i.html('<p style="text-align:center;">-- 榜上无名 --</p>');t.data.sTitle&&t.data.sUrl&&($("#J_gwr").addClass("gwr-active"),n.find(".J_gwrDztTit").text(t.data.sTitle).attr({href:t.data.sUrl,title:t.data.sUrl})),t.data.vStartProps?i.append(new p(t.data.vStartProps,e.weekStarType).view):i.html('<p style="text-align:center;">-- 榜上无名 --</p>')}else i.html('<p style="text-align:center;">-- 获取数据失败: '+t.msg+" --</p>")})).fail((function(e,t){i.html('<p style="text-align:center;">-- 获取数据失败: '+t+" --</p>")})).always((function(){i.removeClass("loading"),e.initComplete()}));var l=e.cd,r=n.find(".J_gwrCd").html(l+"S"),o=setInterval((function(){r.html(--l+"S"),0===l&&(clearInterval(o),e.timeout())}),1e3);return{view:n}}function v(e,t,n,i){var l={view:a(1132)},r=$(l.view());r.on("click",".J_gwrStar li",(function(e){var t=$(this).index();try{ya.reportProductEvent({eid:"click/weekStar/"+{2:"game",3:"show"}[i]+"/last/"+t,eid_desc:"点击/周星榜/"+{2:"游戏",3:"娱乐"}[i]+"/上周周星/"+t})}catch(e){}})),r.on("click",".J_gwrRanks li",(function(e){try{ya.reportProductEvent({eid:"click/weekStar/"+{2:"game",3:"show"}[i]+"/this",eid_desc:"点击/周星榜/"+{2:"游戏",3:"娱乐"}[i]+"/本周周星"})}catch(e){}}));var o=r.find(".J_gwrStar");$.ajax({type:"GET",url:e,dataType:"jsonp"}).always((function(){o.removeClass("loading")})).done((function(e){if(200==e.status){var t=e.data&&$.isArray(e.data.vStartProps)?e.data.vStartProps:[];t.length?o.html(new f(t.slice(0,4)).html):o.addClass("null")}else o.html('<p style="text-align:center;">-- 获取数据失败: '+e.msg+" --</p>")})).fail((function(e,t){o.html('<p style="text-align:center;">-- 获取数据失败: '+t+" --</p>")}));var c,s=!1;function d(e){c=!1;var a=new m({url:t,weekStarType:i,initComplete:e||function(){},cd:60,timeout:function(){c=!0,s||d()}});r.find(".gwr-mod-rank").empty().append(a.view)}return d(n),{view:r,lock:function(){s||(s=!0)},unlock:function(){s&&(s=!1,c&&d())}}}function g(e){var t,n,i=a(1134),r=l.default.layer({view:i(),zIndex:29999,lock:!1}),o=r.view,c=!1,d=!1,f=function(){var e=!1,t="Webkit Moz O ms Khtml".split(" "),a="",n=document.createElement("div");if(void 0!==n.style.animationName&&(e=!0),!1===e)for(var i=0;i<t.length;i++)if(void 0!==n.style[t[i]+"AnimationName"]){(a=t[i])+"Animation","-"+a.toLowerCase()+"-",e=!0;break}return e}(),p=function(){c||d||(c=!0,r.open(),t&&t.unlock(),n&&n.unlock(),f&&(d=!0,o.addClass("zoomIn"),setTimeout((function(){o.removeClass("zoomIn"),d=!1}),500)))},m=function(){c&&!d&&(c=!1,t&&t.lock(),n&&n.lock(),f?(d=!0,o.addClass("zoomOut"),setTimeout((function(){r.hide(),o.removeClass("zoomOut"),d=!1}),500)):r.hide())};o.find(".J_gwrCls").on("click",(function(e){e.preventDefault(),m()}));var g=o.find("#gwr-scroll").jScrollPane({mouseWheelSpeed:20,animateScroll:!0}).data("jsp"),w=function(){return t||(t=new v(s+"/?m=GiftWeekStar&do=getLastGameWeekStars",s+"/?m=GiftWeekStar&do=getGameWeekStars",(function(){g.reinitialise()}),2),o.find(".category-item").eq(0).append(t.view)),t},h=function(){return n||(n=new v(s+"/?m=GiftWeekStar&do=getLastShowWeekStars",s+"/?m=GiftWeekStar&do=getShowWeekStars",(function(){g.reinitialise()}),3),o.find(".category-item").eq(1).append(n.view)),n};new u({index:e,nav:o.find(".category-nav a"),pane:o.find(".category-item"),className:"on",init:function(e){0==e&&w(),1==e&&h()},change:function(e){0==e?w().unlock():w().lock(),1==e?h().unlock():h().lock()}});return{open:p,close:m,toggle:function(){c?m():p()}}}var w=(6==n.default.liveSourceType&&0==n.default.screenType||2==n.default.liveSourceType)&&2168==n.default.gid;t.default=function(){(d||(d=new g(w||8==n.default.bussType?1:0))).toggle()}}}]);