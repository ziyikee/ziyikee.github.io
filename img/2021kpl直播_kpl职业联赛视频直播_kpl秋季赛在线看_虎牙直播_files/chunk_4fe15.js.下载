(window.HUYA_MAIN_APP_WEBPACK_JSONP=window.HUYA_MAIN_APP_WEBPACK_JSONP||[]).push([[228],{456:function(e,t,n){"use strict";n.r(t);var r=n(3),o=n(2),a=n(4),i=n(15),u=n(28),s=n.n(u),c=(n(42),n(285)),l=n.n(c),d=n(289),f=n.n(d),m=(n(49),n(301)),p=n(57),g=n(290),v=n(77),U=n(405);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function T(e,t){Object(i.reportEvent)({eid:"click/zhibo/gp/".concat(e),eid_desc:"点击/直播/公屏/".concat(t)})}function b(e,t){var n=e.formData,r=n.time,o=n.reasonType,a=n.reason,i=e.userInfo,u=e.muteText;return T("jzfy","禁言发言"),m.e.mute({iMutedAction:m.d.MuteSpeak,iStatu:t?m.c.MUTED_GLOBAL:m.c.MUTED_PID,lUid:i.tUsrBase.lUid,sText:u,iMutedTime:r,iReasonType:o,sReason:a})}function E(e,t){var n=e.formData.reason,r=e.userInfo,o=e.userType,a=e.presenterUid;T("jcjy","解除禁言");var i=(o.tRoleStatuInfo.vControl.value.find((function(e){return e.iStatu===(t?m.c.MUTED_GLOBAL:m.c.MUTED_PID)}))||{}).iRole;return m.e.unMute({iUnMuteAction:m.d.MuteSpeak,lPresenterUid:t?-1:a,lUid:r.tUsrBase.lUid,iRole:i,sReason:n})}var O={ROOMKEEPER_ADD:{Modal:U.b.Add,onOk:function(e){var t=e.formData,n=e.userInfo,r=t.expireTime,o=t.permission,a=24*r*3600,i=0;return Object.keys(o).forEach((function(e){o[e]&&(i|=m.a[e])})),T("tjfg","添加房管"),m.e.addRoomKeeper({iAction:1,lAuditorUid:n.tUsrBase.lUid,lExpireTime:a,lPermission:i})}},ROOMKEEPER_REMOVE:{Modal:U.b.Remove,onOk:function(e){var t=e.userInfo;return T("cxfg","撤销房管"),m.e.removeRoomKeeper({lAuditorUid:t.tUsrBase.lUid})}},MUTE:{Modal:function(e){return React.createElement(U.c.Add,h({},e,{isGlobal:!1}))},onOk:function(e){return b(e,!1)}},MUTE_GLOBAL:{Modal:function(e){return React.createElement(U.c.Add,h({},e,{isGlobal:!0}))},onOk:function(e){return b(e,!0)}},UN_MUTE:{Modal:U.c.Remove,onOk:function(e){return E(e,!1)}},UN_MUTE_GLOBAL:{Modal:U.c.Remove,onOk:function(e){return E(e,!0)}},BLOCK:{Modal:U.a.Add,onOk:function(e){var t=e.formData,n=t.time,r=t.reasonType,o=t.reason,a=e.userInfo,i=e.muteText;return T("frhmd","封入黑名单"),m.e.mute({iMutedAction:m.d.AddBlackList,iStatu:m.c.BLACKLIST_PID,lUid:a.tUsrBase.lUid,sText:i,iMutedTime:n,iReasonType:r,sReason:o})}},UN_BLOCK:{Modal:U.a.Remove,onOk:function(e){var t=e.formData.reason,n=e.userInfo,r=e.userType,o=e.presenterUid;T("jchmd","解除黑名单");var a=(r.tRoleStatuInfo.vControl.value.find((function(e){return e.iStatu===m.c.BLACKLIST_PID}))||{}).iRole;return m.e.unMute({iUnMuteAction:m.d.AddBlackList,lPresenterUid:o,lUid:n.tUsrBase.lUid,iRole:a,sReason:t})}},WARNING:{Modal:U.e,onOk:function(e){var t=e.formData,n=t.reasonType,r=t.reason,o=e.userInfo,a=e.muteText;return T("jg","警告"),m.e.mute({iMutedAction:m.d.Warning,iStatu:m.c.WARNING,lUid:o.tUsrBase.lUid,sText:a,iReasonType:n,sReason:r})}},VFANS_ADD:{Modal:U.d.Add,onOk:function(e){var t=e.formData,n=e.userInfo,r=e.presenterUid;return T("syzf","授予钻粉"),Object(v.setBadge)({lFansUid:n.tUsrBase.lUid,lBadgeId:r,iVFlag:1,iEffectiveDay:t.time})}},VFANS_REMOVE:{Modal:U.d.Remove,onOk:function(e){var t=e.userInfo,n=e.presenterUid;return T("cxzf","撤销钻粉"),Object(v.setBadge)({lFansUid:t.tUsrBase.lUid,lBadgeId:n,iVFlag:0,iEffectiveDay:-1})}}},y=n(858),A=n(919),M=n.n(A);function R(){return(R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(u)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k(e){var t=e.userInfo,n=e.userType,a=e.userBadge,c=e.viewerRoleInfo,l=e.presenterUid,d=e.muteText,f=e.onClose,m=e.onChange,v=x(Object(u.useState)(""),2),U=v[0],h=v[1],T=Object(u.useCallback)((function(){return h("")}),[]),b=Object(u.useCallback)((function(e){switch(e){case"CLOSE":f();break;case"APPLY_NOBLE":Object(p.default)(r.default.lp,o.default.id,o.default.sid,o.default.gid),Object(i.reportEvent)({eid:"click/zhibo/gp/xkp/gz",eid_desc:"点击/直播/公屏/小卡片/开通贵族"});break;default:h(e)}}),[f]),E=O[U]||{},A=E.Modal,M=E.onOk;return s.a.createElement(s.a.Fragment,null,s.a.createElement(y.a,{userInfo:t,userType:n,userBadge:a,viewerRoleInfo:c,presenterUid:l,onAction:b}),!!A&&s.a.createElement(A,{userInfo:t,userType:n,userBadge:a,viewerRoleInfo:c,muteText:d,onOk:function(e){var r=M({formData:e,userInfo:t,userType:n,userBadge:a,viewerRoleInfo:c,presenterUid:l,muteText:d});return r.then((function(){m(),h(""),g.default.success("操作成功")})).catch((function(e){g.default.error("操作失败：".concat(e.message))})),r},onCancel:T,onClose:T}))}t.default=function(e){var t=e.uid,n=e.muteText,o=e.onClose,i=x(Object(u.useState)(0),2),c=i[0],d=i[1],p=f()((function(e,n){var o=Object(v.getUserCard)(t,r.default.lp).catch((function(e){throw new Error("获取用户信息失败(".concat(e.message,")"))})),i=m.e.getMyRoleInfo().catch((function(e){throw new Error("获取角色信息失败(".concat(e.message,")"))}));Promise.all([o,i]).then((function(n){var o=x(n,2),i=o[0],u=o[1],s=Object(a.getUid)()==r.default.lp,c=null;c=s||m.e.isManager(u.tRole.iRole)?m.e.getUserType(t).catch((function(e){throw new Error("获取用户角色信息失败(".concat(e.message,")"))})):new Promise((function(e,t){TTP.ready((function(t){e(new t.taf.HUYA.GetUserTypeRsp)}))}));var l=null;l=s?Object(v.getUserBadge)(t,r.default.lp).catch((function(e){throw new Error("获取用户徽章信息失败(".concat(e.message,")"))})):Promise.resolve({iBadgeLevel:0}),e(Promise.all([c,l]).then((function(e){var t=x(e,2),n=t[0],o=t[1];return{userInfo:i,userType:n,userBadge:o,viewerRoleInfo:u,presenterUid:r.default.lp}})))})).catch(n)}),[t,c]),g=x(p,3),U=g[0],h=g[1],T=g[2],b=Object(u.useCallback)((function(){return d(c+1)}),[c]);return s.a.createElement("div",{className:l()(M.a["uc-box"])},U&&s.a.createElement(k,R({},U,{muteText:n,onClose:o,onChange:b})),!U&&s.a.createElement("div",{className:l()(M.a["uc-status"])},s.a.createElement("i",{className:M.a["uc-x"],onClick:o}),"pending"==T&&s.a.createElement("img",{src:"https://a.msstatic.com/huya/main/assets/img/loading.gif"}),h&&s.a.createElement("p",{className:M.a.msg},h.message)))}},919:function(e,t,n){var r=n(920);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(287)(r,o);r.locals&&(e.exports=r.locals)},920:function(e,t,n){var r=n(286),o=n(288),a=n(921),i=n(922);t=r(!1);var u=o(a),s=o(i);t.push([e.i,".uc-box--ThsdWS_RYfjN6LcTEPgIP{display:inline-block}.uc-status--1vkoQ7fM4T9ZzF7EKoL1Th{position:relative;display:flex;align-items:center;justify-content:center;width:250px;height:220px;background:#fff;box-shadow:0 0 10px 0px rgba(1,1,1,0.2);border-radius:8px}.uc-status--1vkoQ7fM4T9ZzF7EKoL1Th .msg--1SsdPQAoaOMdi8-14F5ab5{font-size:14px;padding:0 1.2em}.uc-status--1vkoQ7fM4T9ZzF7EKoL1Th .uc-x--gcL_slEJj2cAfLQ5sbntG{position:absolute;top:13px;right:11px;display:inline-block;width:10px;height:9px;overflow:hidden;cursor:pointer;background:url("+u+")}.uc-status--1vkoQ7fM4T9ZzF7EKoL1Th .uc-x--gcL_slEJj2cAfLQ5sbntG:hover{background:url("+s+")}\n",""]),t.locals={"uc-box":"uc-box--ThsdWS_RYfjN6LcTEPgIP","uc-status":"uc-status--1vkoQ7fM4T9ZzF7EKoL1Th",msg:"msg--1SsdPQAoaOMdi8-14F5ab5","uc-x":"uc-x--gcL_slEJj2cAfLQ5sbntG"},e.exports=t}}]);