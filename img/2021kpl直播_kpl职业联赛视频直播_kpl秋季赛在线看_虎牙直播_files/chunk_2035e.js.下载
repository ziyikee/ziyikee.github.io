(window.HUYA_MAIN_APP_WEBPACK_JSONP=window.HUYA_MAIN_APP_WEBPACK_JSONP||[]).push([[73],{78:function(e,t,l){"use strict";l.r(t);var n=l(3),a=l(0),o=l(749),u={};t.default=u;var i=HUYA_UTIL.getCookieVal("udb_uid"),s=function(e){var t=[];return $.each(e,(function(e,l){""!==l&&t.push(l)})),t.join("")},c=function(e){var t=[];return $.each("string"==typeof e&&e?e.split(""):[],(function(e,l){""!==l&&t.push(l)})),t},r=function(e){var t=null;try{t=JSON.parse(e)}catch(e){}return t||{}},f="TT_ROOM_BLOCK_WORDS_"+TT.env+"_"+i,d=f+"_4P",g=localStorage.getItem(f),p=localStorage.getItem(d),v=r(p);u.global=new o.a(c(g)),u.local=new o.a(c(v[n.default.lp]));var h=new RegExp("(\\"+"^$.*+?=!:|\\/()[]{}".split("").join("|\\")+")","g"),w=null;function S(){var e,t;e=[].concat(u.global.list).concat(u.local.list),t=[],$.each(e,(function(e,l){""!==l&&t.push(l.replace(h,(function(e,t){return"\\"+t})))})),w=new RegExp(t.join("|"),"i")}S(),u.global.on("ALL",S),u.local.on("ALL",S),u.test=function(e){return"string"==typeof e&&u.global.list.length+u.local.list.length>0&&w.test(e)},u.testMsg=function(e){var t=i&&i==e.tUserInfo.lUid,l=e.sContent;try{l=decodeURIComponent(l)}catch(e){}return!t&&u.test(l)};var y="blockwords",A="blockword4pid";function I(e,t){a.default.ready((function(l){if(a.default.isH5){var n=new l.taf.HUYA.SettingSetupReq;n.tId=l.userId;var o=new l.taf.HUYA.UserSettingItem;o.sKey=e,o.sValue=t,n.vItems.value.push(o),l.sendWup2("liveui","setUserSetting",n,(function(){}))}else if(a.default.isFlash){var u={};u[e]=t,l.callAs("SettingSetupReq",u)}}))}TT.sudo((function(){u.global.on("ALL",(function(e){if("add"==e||"del"==e){var t=s(u.global.list);I(y,t);try{localStorage.setItem(f,t)}catch(e){}}})),u.local.on("ALL",(function(e){if("add"==e||"del"==e){var t=s(u.local.list);t?v[n.default.lp]=t:delete v[n.default.lp];var l=JSON.stringify(v);I(A,l);try{localStorage.setItem(d,l)}catch(e){}}})),function(e){return new $.Deferred((function(e){a.default.ready((function(t){if(a.default.isH5){var l=new t.taf.HUYA.SettingFetchReq;l.tId=t.userId,l.vKeys.value.push(y),l.vKeys.value.push(A),t.sendWup2("liveui","getUserSetting",l,e.resolve)}else a.default.isFlash&&(t.callAs("SettingFetchReq",[y,A]),a.default.one("SettingFetchRsp",(function(t){e.resolve(t.param)})))}))}))}().done((function(e){$.each(e.vItems.value,(function(e,t){var l=HUYA_UTIL.unescape(t.sValue);if(t.sKey==y&&s(c(l))!=s(u.global.list)){u.global.update(c(l));try{localStorage.setItem(f,l)}catch(e){}}if(t.sKey==A&&l!=JSON.stringify(v)){v=r(l),s(c(v[n.default.lp]))!=s(u.local.list)&&u.local.update(c(v[n.default.lp]));try{localStorage.setItem(d,l)}catch(e){}}}))})),window.addEventListener&&window.addEventListener("storage",(function(e){e.key===f&&null!==e.newValue&&s(c(e.newValue))!=s(u.global.list)&&u.global.update(c(e.newValue)),e.key===d&&null!==e.newValue&&e.newValue!=JSON.stringify(v)&&(v=r(e.newValue),s(c(v[n.default.lp]))!=s(u.local.list)&&u.local.update(c(v[n.default.lp])))}))}),!1)}}]);