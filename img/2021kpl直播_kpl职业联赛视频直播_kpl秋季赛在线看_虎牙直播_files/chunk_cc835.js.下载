(window.HUYA_MAIN_APP_WEBPACK_JSONP=window.HUYA_MAIN_APP_WEBPACK_JSONP||[]).push([[212],{58:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var l=t(12),n=(0,l.__importStar)(t(28)),d=(0,l.__importDefault)(t(42)),u=(0,l.__importDefault)(t(348)),s=(0,l.__importDefault)(t(337)),i=t(964),f=(0,l.__importDefault)(t(965)),r=(0,l.__importDefault)(t(968)),o=(0,l.__importDefault)(t(969)),c=(0,l.__importDefault)(t(971)),g=(0,l.__importDefault)(t(979)),m=(0,l.__importDefault)(t(980));function B(){var e=(0,n.useState)([void 0,null,"pending"]),a=e[0],t=a[0],d=(a[1],a[2]),u=e[1];(0,n.useEffect)((function(){return Promise.all([s.default.ensureGetBadgeInfoList().catch((function(){})),s.default.getCurrentPresenterBadgeInfo().catch((function(){return{lBadgeId:0}}))]).then((function(e){return u([e,null,"fulfilled"])})),function(){u=function(){}}}),[]);var f="pending"===d,r=(0,i.useUsingBadge)(s.default),o=(0,i.useBadgeList)(s.default),c=s.default.hasUsableBadge()?s.default.visualUsingBadge.type:"empty",g=t?t[1]:{lBadgeId:0},B=s.default.normalBadge.badgeList.length+(s.default.trialBadge.find(g.lBadgeId)?1:0),v=(0,n.useCallback)((function(e){return s.default.useBadge(e)}),[]),E=(0,n.useState)(null),N=E[0],C=E[1];(0,n.useEffect)((function(){t&&(s.default.on("scoreChange:normal",(function(e){(e.iNewBadge||e.iBadgeLevelChanged)&&C({type:"normal",badgeScore:e,usable:e.tBadgeInfo.lBadgeId!=s.default.usingBadge.id})})),s.default.on("scoreChange:trial",(function(e){if((e.iNewBadge||e.iIsLevelUp)&&e.iNoticeType){var a=e.tNewInfo.tCompactInfo.lBadgeId;C({type:"trial",badgeScore:e,usable:a==g.lBadgeId&&a!=s.default.usingBadge.id})}})))}),[t]);var b=(0,n.useCallback)((function(){return C(null)}),[]);return n.default.createElement(n.default.Fragment,null,n.default.createElement(p,{pending:f,usingBadge:r,visualUsingBadge:s.default.visualUsingBadge,badgeList:o,usingBadgeType:c,onUse:v,presenterBadge:g,total:B}),N&&n.default.createElement("div",{className:"fansBadge-tip"},n.default.createElement(m.default,(0,l.__assign)({},N,{onUse:v,onClose:b}))))}function p(e){var a=e.pending,t=e.usingBadgeType,l=e.usingBadge,d=e.visualUsingBadge,s=e.badgeList,i=e.onUse,m=e.presenterBadge,B=e.total,p=(0,u.default)(!1),v=p[0],E=p[1],N=p[2],C=(0,u.default)(!1),b=C[0],F=C[1],I=C[2];return n.default.createElement("div",{className:"fansBadge-container",onMouseEnter:E,onMouseLeave:N},n.default.createElement("div",{className:"chat-fansbadge"},a&&n.default.createElement(f.default,{className:"badge-loading"}),!a&&n.default.createElement(r.default,{type:t,info:d.info})),n.default.createElement("div",{className:"fansBadge-detail",style:{display:v?"block":"none"}},a&&n.default.createElement(o.default,null),!a&&n.default.createElement(c.default,{type:t,info:d.info,presenterBadgeInfo:m,total:B,totalAll:s.normal.length+s.trial.length,onOpenList:function(){return F(!0)},onCloseList:I})),n.default.createElement("div",{className:"fansBadge-list",style:{display:b?"block":"none"},onMouseEnter:F,onMouseLeave:I},n.default.createElement(g.default,{usingBadge:l,badgeList:s,onUse:i,presenterBadge:m})))}t(981),a.default=function(e){d.default.render(n.default.createElement(B,null),e)}},968:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var l=t(12),n=(0,l.__importDefault)(t(28)),d=t(74),u=(0,l.__importDefault)(t(299));a.default=function(e){var a,t=e.type,l=e.info;switch(t){case"normal":var s=l,i=d.CustomFansBadge.getCustomBadgeAssets(s.iCustomBadgeFlag,s);a=i?n.default.createElement(u.default.Custom,{id:s.lBadgeId,name:s.sBadgeName,level:s.iBadgeLevel,SFFlag:s.tSuperFansInfo.iSFFlag,assets:i,className:"FansBadgeLogo"}):n.default.createElement(u.default.Normal,{id:s.lBadgeId,name:s.sBadgeName,level:s.iBadgeLevel,type:s.iBadgeType,SFFlag:s.tSuperFansInfo.iSFFlag,className:"FansBadgeLogo"});break;case"trial":var f=l;a=n.default.createElement(u.default.Trial,{id:f.tCompactInfo.lBadgeId,name:f.sBadgeName,level:f.tCompactInfo.iBadgeLevel,className:"FansBadgeLogo"});break;case"none":a=n.default.createElement("i",{className:"badge-null"});break;case"empty":a=n.default.createElement("i",{className:"badge-empty"});break;default:a=n.default.createElement("i",{className:"badge-null"})}return a}},979:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var l=t(12),n=(0,l.__importStar)(t(28)),d=(0,l.__importDefault)(t(285)),u=t(74),s=(0,l.__importDefault)(t(299)),i=t(340);function f(e){var a=e.active,t=e.info,l=t.lBadgeId,f=t.iBadgeType,r=t.tFaithInfo,o=t.sBadgeName,c=t.iBadgeLevel,g=t.tSuperFansInfo,m=t.sPresenterNickName,B=t.iQuotaUsed,p=t.tChannelInfo,v=t.iCustomBadgeFlag,E=e.onClick,N=u.CustomFansBadge.getCustomBadgeAssets(v,e.info),C=(0,n.useCallback)((function(){E(l)}),[E,l]);return n.default.createElement("li",{className:(0,d.default)({on:a}),onClick:C},n.default.createElement("i",{className:(0,d.default)("choice",{checked:a})}),N?n.default.createElement(s.default.Custom,{id:l,name:o,level:c,SFFlag:g.iSFFlag,assets:N,className:"FansBadgeLogo"}):n.default.createElement(s.default.Normal,{id:l,name:o,level:c,type:f,SFFlag:g.iSFFlag,className:"FansBadgeLogo"}),n.default.createElement("span",{className:"nick"},f==i.BadgeType.Faith?r.sFaithName:m),f==i.BadgeType.Faith&&B>0&&n.default.createElement("i",{className:"fansBadge-stateUp update-state"}),f==i.BadgeType.Faith&&B<0&&n.default.createElement("i",{className:"fansBadge-stateDown update-state"}),!(!p.lTid||!p.lSid)&&n.default.createElement("i",{className:"living"}))}function r(e){var a=e.active,t=e.info,l=t.sBadgeName,u=t.tCompactInfo,i=u.lBadgeId,f=u.iBadgeLevel,r=t.sPresenterNickName,o=t.tChannelInfo,c=e.onClick,g=e.disabled,m=(0,n.useCallback)((function(){c(i)}),[c,i]);return n.default.createElement("li",{className:(0,d.default)({on:a,disabled:g}),onClick:g?function(){}:m},n.default.createElement("i",{className:(0,d.default)("choice",{checked:a,disabled:g})}),n.default.createElement(s.default.Trial,{id:i,name:l,level:f,className:"FansBadgeLogo"}),n.default.createElement("span",{className:"nick"},r),!(!o.lTid||!o.lSid)&&n.default.createElement("i",{className:"living"}))}a.default=function(e){var a=e.usingBadge,t=e.badgeList,l=e.onUse,d=e.presenterBadge,u=t.trial.find((function(e){return e.tCompactInfo.lBadgeId==d.lBadgeId})),s=t.trial.filter((function(e){return e!=u}));return n.default.createElement("div",{className:"fansBadge-box son"},n.default.createElement("div",{className:"fansBadge-box-hd"},"我的粉丝徽章"),n.default.createElement("div",{className:"fansBadge-items"},n.default.createElement("ul",null,t.normal.map((function(e){var t=e.lBadgeId;return n.default.createElement(f,{key:t,active:a.id==t,info:e,onClick:l})})),u&&n.default.createElement(r,{key:u.tCompactInfo.lBadgeId,active:a.id==u.tCompactInfo.lBadgeId,info:u,onClick:l})),s.length>0&&n.default.createElement("div",{className:"fansBadge-items-line"},"以下徽章不可选"),s.length>0&&n.default.createElement("ul",null,s.map((function(e){var t=e.tCompactInfo.lBadgeId;return n.default.createElement(r,{key:t,active:a.id==t,info:e,onClick:l,disabled:!0})})))),n.default.createElement("a",{className:"fansBadge-itemNull",onClick:function(e){e.preventDefault(),l(0)},href:"#"},"不佩戴徽章"))}},980:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var l=t(12),n=(0,l.__importStar)(t(28)),d=t(74),u=(0,l.__importDefault)(t(299));function s(e){var a=e.badge,t=e.onUse,l=e.onClose,s=(0,n.useCallback)((function(e){e.preventDefault(),t(a.lBadgeId),l()}),[t,a.lBadgeId]),i=(0,n.useCallback)((function(e){e.preventDefault(),l()}),[l]),f=d.CustomFansBadge.getCustomBadgeAssets(a.iCustomBadgeFlag,a);return n.default.createElement("div",{className:"fansBadge-box"},n.default.createElement("div",{className:"fansBadge-tip-new"},n.default.createElement("p",null,"恭喜您获得 ",f?n.default.createElement(u.default.Custom,{id:a.lBadgeId,name:a.sBadgeName,level:a.iBadgeLevel,SFFlag:a.tSuperFansInfo.iSFFlag,assets:f}):n.default.createElement(u.default.Normal,{id:a.lBadgeId,name:a.sBadgeName,level:a.iBadgeLevel,type:a.iBadgeType,SFFlag:a.tSuperFansInfo.iSFFlag})," 粉丝徽章！"),n.default.createElement("div",{className:"fansBadge-tip-ft"},e.usable&&n.default.createElement("a",{href:"#",onClick:s},"立即佩戴"),n.default.createElement("a",{href:"#",onClick:i},"关闭"))))}function i(e){var a=e.badge,t=e.onClose,l=(0,n.useCallback)((function(e){e.preventDefault(),t()}),[t]),s=(0,n.useState)(5),i=s[0],f=s[1];(0,n.useEffect)((function(){if(i>0){var e=setTimeout((function(){f(i-1)}),1e3);return function(){clearTimeout(e)}}t()}),[i]);var r=d.CustomFansBadge.getCustomBadgeAssets(a.iCustomBadgeFlag,a);return n.default.createElement("div",{className:"fansBadge-box"},n.default.createElement("div",{className:"fansBadge-tip-up"},n.default.createElement("p",null,"恭喜您拥有的 ",r?n.default.createElement(u.default.Custom,{id:a.lBadgeId,name:a.sBadgeName,level:a.iBadgeLevel,SFFlag:a.tSuperFansInfo.iSFFlag,assets:r}):n.default.createElement(u.default.Normal,{id:a.lBadgeId,name:a.sBadgeName,level:a.iBadgeLevel,type:a.iBadgeType,SFFlag:a.tSuperFansInfo.iSFFlag})," 粉丝徽章升级了！"),n.default.createElement("div",{className:"fansBadge-tip-ft"},n.default.createElement("a",{href:"#",onClick:l},"我知道了(",i,")"))))}function f(e){var a=e.badge,t=a.sBadgeName,l=a.tCompactInfo,d=l.lBadgeId,s=l.iBadgeLevel,i=e.onUse,f=e.onClose,r=(0,n.useCallback)((function(e){e.preventDefault(),i(d),f()}),[i,d]),o=(0,n.useCallback)((function(e){e.preventDefault(),f()}),[f]);return n.default.createElement("div",{className:"fansBadge-box"},n.default.createElement("div",{className:"fansBadge-tip-new"},n.default.createElement("p",null,"恭喜您获得 ",n.default.createElement(u.default.Trial,{id:d,name:t,level:s})," 粉丝徽章！"),n.default.createElement("div",{className:"fansBadge-tip-ft"},e.usable&&n.default.createElement("a",{href:"#",onClick:r},"立即佩戴"),n.default.createElement("a",{href:"#",onClick:o},"关闭"))))}function r(e){var a=e.badge,t=a.sBadgeName,l=a.tCompactInfo,d=l.lBadgeId,s=l.iBadgeLevel,i=e.onClose,f=(0,n.useCallback)((function(e){e.preventDefault(),i()}),[i]),r=(0,n.useState)(5),o=r[0],c=r[1];return(0,n.useEffect)((function(){if(o>0){var e=setTimeout((function(){c(o-1)}),1e3);return function(){clearTimeout(e)}}i()}),[o]),n.default.createElement("div",{className:"fansBadge-box"},n.default.createElement("div",{className:"fansBadge-tip-up"},n.default.createElement("p",null,"您的 ",n.default.createElement(u.default.Trial,{id:d,name:t,level:s})," 徽章可升级至",s,"级了！"),n.default.createElement("div",{className:"fansBadge-tip-ft"},n.default.createElement("a",{href:"#",onClick:f},"我知道了(",o,")"))))}a.default=function(e){var a=e.type,t=e.badgeScore,l=e.onUse,d=e.onClose,u=null;if("normal"===a){var o=t;o.iNewBadge?u=n.default.createElement(s,{badge:o.tBadgeInfo,onUse:l,onClose:d,usable:e.usable}):o.iBadgeLevelChanged&&(u=n.default.createElement(i,{badge:o.tBadgeInfo,onClose:d}))}else if("trial"===a){var c=t;c.iNewBadge?u=n.default.createElement(f,{badge:c.tNewInfo,onUse:l,onClose:d,usable:e.usable}):c.iIsLevelUp&&(u=n.default.createElement(r,{badge:c.tNewInfo,onClose:d}))}return u}},981:function(e,a,t){}}]);