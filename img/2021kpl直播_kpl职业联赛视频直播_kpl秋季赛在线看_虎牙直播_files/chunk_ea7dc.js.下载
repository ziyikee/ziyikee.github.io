(window.HUYA_MAIN_APP_WEBPACK_JSONP=window.HUYA_MAIN_APP_WEBPACK_JSONP||[]).push([[22],{1010:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(12),n=(0,i.__importDefault)(o(19)),r=(0,i.__importDefault)(o(4)),a=function(e){function t(o,i,n){void 0===n&&(n=16);var a=e.call(this)||this;return a.history=[],a.maxLength=n,a.storageKey=i,a.history=t.read(i),a.emoticon=o,window.addEventListener("storage",r.default.throttle((function(e){null!==e.newValue&&e.key!==a.storageKey||(a.history=t.read(a.storageKey),a.emit("update",a.get()))}),200)),a}return(0,i.__extends)(t,e),t.read=function(e){var t=[];if(e&&"string"==typeof e)try{var o=localStorage.getItem(e);o&&(t=o.split(","))}catch(e){}return t},t.write=function(e,t){if(e&&"string"==typeof e&&t&&t.length>0)try{localStorage.setItem(e,t.join(","))}catch(e){}},t.prototype.get=function(){var e=this;return this.history.map((function(t){return e.emoticon.findAvailableEmoticon(t)})).filter((function(e){return!!e}))},t.prototype.add=function(e){if(e){var o=this.history.indexOf(e.id);-1!==o&&this.history.splice(o,1),this.history.unshift(e.id),this.history=this.history.slice(0,this.maxLength),t.write(this.storageKey,this.history),this.emit("update",this.get())}},t}(n.default);t.default=a},317:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(12),n=(0,i.__importDefault)(o(387)),r=(0,i.__importDefault)(o(388)),a=new n.default(c());function c(){var e=(0,i.__spreadArray)((0,i.__spreadArray)([],r.default.availableEmoticonPackage,!0),r.default.defaultEmoticonPackge,!0),t=[];return e.filter((function(e){return 0===e.type})).forEach((function(e){var o=e.emoticon;return t.push.apply(t,o)})),t}r.default.on("update",(function(){a.register(c())})),t.default=a},318:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(12),n=(0,i.__importDefault)(o(19)),r=o(4),a=o(608),c=(0,i.__importDefault)(o(609)),s=o(389);(0,i.__exportStar)(o(389),t);var u=function(e){function t(t){void 0===t&&(t={pid:0,gid:0,uid:0});var o=e.call(this)||this;return o.memoReq=null,o.options=t,o.defaultEmoticonPackge=(0,i.__spreadArray)([],c.default,!0),o.allEmoticonPackage=[],o.availableEmoticonPackage=[],o}return(0,i.__extends)(t,e),t.getUnavailEmoticonActionName=function(e){var o=e.context,i=e.actionType;return o&&o.itemType&&o.itemCount?t.UnavailEmoticonActionSendGfit:s.EUnavailEmoticonActionType[i]},t.prototype.findEmoticon=function(e,t){return void 0===t&&(t=""),this.find((0,i.__spreadArray)((0,i.__spreadArray)([],this.allEmoticonPackage,!0),this.defaultEmoticonPackge,!0),e,t)},t.prototype.findAvailableEmoticon=function(e,t){return void 0===t&&(t=""),this.find(this.availableEmoticonPackage,e,t)},t.prototype.find=function(e,t,o){if(void 0===o&&(o=""),o){var i=e.find((function(e){return e.packageId==o}));return i&&i.emoticon.find((function(e){var o=e.id;return t==o}))}var n;return e.find((function(e){return!!(n=e.emoticon.find((function(e){var o=e.id;return t==o})))})),n},t.prototype.getUnavailEmoticonConfig=function(e,t){if(void 0===t&&(t=""),t){var o=this.allEmoticonPackage.find((function(e){return e.packageId==t}));return o&&o.unavailEmoticon.find((function(t){return-1!=t.unAvailableId.indexOf(e)}))}var i;return this.allEmoticonPackage.find((function(t){return!!(i=t.unavailEmoticon.find((function(t){return-1!=t.unAvailableId.indexOf(e)})))})),i},t.prototype.fetchExpressionEmoticonPackage=function(e){var o=this;return void 0===e&&(e=!1),null!==this.memoReq&&!0!==e||(this.memoReq=t.getExpressionEmoticonPackage(this.options),this.memoReq.then((function(e){var t=e.packages,i=e.availables;o.allEmoticonPackage=t,o.availableEmoticonPackage=t.filter((function(e){var t=e.packageId;return-1!=i.indexOf(t)})),o.emit("update")})).catch((function(e){console.error(e)}))),this.memoReq},t.getExpressionEmoticonPackage=function(e){var t=void 0===e?{pid:0,gid:0,uid:0}:e,o=t.pid,i=t.gid,n=t.uid;return new Promise((function(e,t){if(0==o&&0==i){var c=localStorage.getItem("HUYA_EXPRESSION_EMOTICON_MEMO"),s=function(){var e=(0,a.getExpressionEmoticonPackage)({pid:o,gid:i,uid:n});return e.then((function(e){localStorage.setItem("HUYA_EXPRESSION_EMOTICON_MEMO",JSON.stringify({time:(0,r.createTimestamp)(),data:e}))})).catch(console.error),e};if(c){var u=JSON.parse(c);e((0,r.createTimestamp)()-u.time>600?s():u.data)}else e(s())}else e((0,a.getExpressionEmoticonPackage)({pid:o,gid:i,uid:n}))}))},t.UnavailEmoticonActionSendGfit="SEND_GIFT",t}(n.default);t.default=u},387:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(12),n=o(4),r=o(334),a=(0,i.__importDefault)(o(607)),c=function(){function e(t){var o=this;void 0===t&&(t=[]),this.registry=new a.default(t),this.parser=e.createParser(t,(function(e){return e.match(r.EmoticonParser.emoticonEscapeMatcher)?o.registry.find(e):e.match(r.EmoticonParser.emoticonNameMatcher)?o.registry.findByName(e):void 0}))}return e.createParser=function(e,t){var o=[r.EmoticonParser.emoticonNameRegExpCharacters];return e.forEach((function(e){var t=e.escape.match(/\/\{(.+)/);t&&o.push((0,n.replaceRegExpMetacharacters)(t[0]))})),new r.EmoticonParser(t,new RegExp("("+o.join("|")+")"))},e.prototype.parse=function(e,t){return this.parser.parse(e,t)},e.prototype.replaceEmoticonTextWithHTMLImg=function(e){return this.parse(e,(function(e,t){var o=e.extraUrl,i=e.url,r=e.name,a=o||i;return a?'<img style="max-width: 28px;" src="'+(0,n.escapeHTMLSpecialChars)(TT.trimUrl(a))+'" alt="'+(0,n.escapeHTMLSpecialChars)(r)+'" />':(0,n.escapeHTMLSpecialChars)(r||t)})).join("")},e.prototype.replaceNameWithEscape=function(e){var t=this;return r.EmoticonParser.parse(e,(function(e){var o=t.registry.findByName(e);if(o)return o.escape}),r.EmoticonParser.emoticonNameMatcher).join("")},e.prototype.register=function(t){var o=this;this.registry=new a.default(t),this.parser=e.createParser(t,(function(e){return e.match(r.EmoticonParser.emoticonEscapeMatcher)?o.registry.find(e):e.match(r.EmoticonParser.emoticonNameMatcher)?o.registry.findByName(e):void 0}))},e}();t.default=c},388:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(12),n=o(4),r=(0,i.__importDefault)(o(318));(0,i.__exportStar)(o(318),t);var a=new r.default({pid:0,gid:0,uid:(0,n.getUid)()});a.fetchExpressionEmoticonPackage(),t.default=a},389:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EUnavailEmoticonActionType=t.ExpressionEmoticonPackageType=void 0,function(e){e[e.ExpressionEmoticonPackageTypeSmall=0]="ExpressionEmoticonPackageTypeSmall",e[e.ExpressionEmoticonPackageTypeFrame=1]="ExpressionEmoticonPackageTypeFrame",e[e.ExpressionEmoticonPackageTypeFlexi=2]="ExpressionEmoticonPackageTypeFlexi"}(t.ExpressionEmoticonPackageType||(t.ExpressionEmoticonPackageType={})),function(e){e[e.NONE=0]="NONE",e[e.RECHARGEPAGE=1]="RECHARGEPAGE",e[e.NOBLEPAGE=2]="NOBLEPAGE",e[e.GuardPAGE=3]="GuardPAGE",e[e.FANSPAGE=4]="FANSPAGE",e[e.SFANSPAGE=5]="SFANSPAGE",e[e.MINIAPP=6]="MINIAPP",e[e.IACPAGE=7]="IACPAGE",e[e.RNPAGE=8]="RNPAGE",e[e.H5PAGE=9]="H5PAGE"}(t.EUnavailEmoticonActionType||(t.EUnavailEmoticonActionType={}))},607:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(334),n=function(){function e(t){void 0===t&&(t=[]),this.registry=e.createRegistry(t)}return e.createRegistry=function(t){var o={};return t.forEach((function(t){var i=t.escape.match(e.emoticonMatcher);i&&!o["escape-"+i[0]]&&(o["escape-"+i[0]]=t);var n=t.name.match(e.emoticonNameMatcher);n&&!o["name-"+n[0]]&&(o["name-"+n[0]]=t)})),o},e.prototype.find=function(e){if(e&&"string"==typeof e)return this.registry["escape-"+e]},e.prototype.findByName=function(e){if(e&&"string"==typeof e)return this.registry["name-"+e]},e.emoticonMatcher=new RegExp(i.EmoticonParser.emoticonEscapeRegExpCharacters),e.emoticonNameMatcher=new RegExp(i.EmoticonParser.emoticonNameRegExpCharacters),e}();t.default=n},608:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExpressionEmoticonPackage=void 0,t.getExpressionEmoticonPackage=function(e,t){var o=void 0===e?{uid:0,pid:0,gid:0}:e,i=o.uid,n=o.pid,r=o.gid;return void 0===t&&(t=8e3),new Promise((function(e,o){var a={url:"//liveapi.huya.com/cache/emoticon/getExpressionEmoticonPackage",type:"GET",data:{uid:i||0,pid:n||0,gid:r||0},dataType:"json",cache:!0,timeout:t,xhrFields:{withCredentials:!0},__forceTrace:!0};$.ajax(a).done((function(t){t?200==t.status?t.data?e(t.data):o(new Error("数据为空")):o(new Error(t.msg||"unknown")):o(new Error("数据异常(Empty)"))})).fail((function(e,t){o(new Error("网络异常("+t+")"))}))}))}},609:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=[{packageId:"0",name:"本地默认表情",type:0,coverUrl:"https://a.msstatic.com/huya/main3/widget/roomEmot/icon-normal_6ec78.png",emoticon:[{code:"dx",text:"大笑"},{code:"sh",text:"送花"},{code:"tx",text:"偷笑"},{code:"dk",text:"大哭"},{code:"hh",text:"嘿哈"},{code:"66",text:"666"},{code:"gd",text:"感动"},{code:"yw",text:"疑问"},{code:"xh",text:"喜欢"},{code:"jx",text:"奸笑"},{code:"zan",text:"赞"},{code:"ka",text:"可爱"},{code:"am",text:"傲慢"},{code:"kx",text:"开心"},{code:"88",text:"拜拜"},{code:"hx",text:"害羞"},{code:"zs",text:"衰"},{code:"pu",text:"吐血"},{code:"zc",text:"嘴馋"},{code:"sq",text:"生气"},{code:"fe",text:"扶额"},{code:"bz",text:"闭嘴"},{code:"kw",text:"枯萎"},{code:"xu",text:"嘘"},{code:"xk",text:"笑哭"},{code:"lh",text:"流汗"},{code:"bk",text:"不看"},{code:"hq",text:"哈欠"},{code:"tp",text:"调皮"},{code:"gl",text:"鬼脸"},{code:"cl",text:"戳脸"},{code:"dg",text:"大哥"},{code:"kun",text:"困"},{code:"yb",text:"拥抱"},{code:"zt",text:"猪头"},{code:"kl",text:"骷髅"},{code:"cc",text:"臭臭"},{code:"xd",text:"心动"},{code:"dao",text:"刀"}].map((function(e){var t=e.code,o=e.text;return{id:t+"_"+Math.floor(1e9*Math.random()),name:"["+o+"]",escape:"/{"+t,url:"https://a.msstatic.com/huya/main/emot_png/"+t+".png",extraUrl:"",type:0,frameSize:0,flexiUrl:"",price:0}})),unavailEmoticon:[],isLocked:0,lockedMsg:""}];t.default=i}}]);