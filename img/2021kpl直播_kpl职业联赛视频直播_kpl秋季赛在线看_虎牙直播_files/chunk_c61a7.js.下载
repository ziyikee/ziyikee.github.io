(window.HUYA_MAIN_APP_WEBPACK_JSONP=window.HUYA_MAIN_APP_WEBPACK_JSONP||[]).push([[391],{103:function(e,t,n){"use strict";n.r(t);n(956);var a=n(14),r=n(68),l=n(2),c=n(3),u=n(15),o=n(84),i=n(285),s=n.n(i),f=n(36),d=n(957),m=n.n(d);function b(e,t,n,a,r,l,c){try{var u=e[l](c),o=u.value}catch(e){return void n(e)}u.done?t(o):Promise.resolve(o).then(a,r)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var l=e.apply(t,n);function c(e){b(l,a,r,c,u,"next",e)}function u(e){b(l,a,r,c,u,"throw",e)}c(void 0)}))}}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,l=[],c=!0,u=!1;try{for(n=n.call(e);!(c=(a=n.next()).done)&&(l.push(a.value),!t||l.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{c||null==n.return||n.return()}finally{if(u)throw r}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var h=HUYA_UTIL.getCookieVal("udb_uid"),E=null;function w(e){var t=y(Object(a.useState)(f.default.count),2),n=t[0],r=t[1],i=y(Object(a.useState)(o.default.state),2),d=i[0],b=i[1],p=y(Object(a.useState)(!1),2),v=p[0],w=p[1],g=y(Object(a.useState)(!1),2),A=g[0],N=g[1];function _(){w(!1)}function k(){return E||(E=new Promise((function(e,t){var n=(new Date).getTime();try{window.performanceInfo._hmt.push(["reportApiTime","huya-main-follow","start",n,"",n])}catch(e){}var a=d;o.default[d?"off":"on"]().always((function(){try{window.performanceInfo._hmt.push(["reportApiTime","huya-main-follow","end",(new Date).getTime(),"",n])}catch(e){}E=null,o.default.state!=a?(e(),Object(u.reportEvent)({eid:"click/room/anchor/"+(o.default.state?"follow":"unfollow"),gid:l.default.gid,pid:c.default.lp})):t()}))}))),E}return Object(a.useEffect)((function(){f.default.on("change",(function(){r(f.default.count)})),h&&o.default.change((function(e){b(o.default.state)}))}),[]),a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{onClick:function(){h&&(d?(N(!0),w(!0)):(N(!1),k().then((function(){w(!0)}))))},className:s()("subscribe-hd","clickstat",{"sub-off":!d,"sub-on":d}),id:"yyliveRk_game_newsBut",eid:"click/zhibo/".concat(d?"unbook":"book","/").concat(o.default.target),eid_desc:"点击/直播间/".concat(d?"取消订阅":"订阅","/").concat(o.default.target)},a.default.createElement("div",{className:"subscribe-control"},a.default.createElement("em",null),d?"已订阅":"订阅"),a.default.createElement("div",{className:"subscribe-count",id:"activityCount"},n)),v&&a.default.createElement("div",{className:"entrance-expand subscribe-expand",style:{display:"block"}},a.default.createElement("em",{className:"entrance-expand-arr"}),a.default.createElement("div",{className:"entrance-expand-bor"}),a.default.createElement("div",{className:"subscribe-layer-wrap"},d&&A?a.default.createElement("div",{className:"subscribe-layer-cancel"},a.default.createElement("div",{className:"subscribe-layer-cancel-prompt"},a.default.createElement("i",null),"确定要取消订阅吗？"),a.default.createElement("div",{className:"subscribe-layer-cancel-control"},a.default.createElement("span",{onClick:function(){k().finally(_)}},"确定"),a.default.createElement("span",{onClick:function(){_()}},"取消"))):a.default.createElement("div",{className:"subscribe-layer-success"},a.default.createElement("h3",null,a.default.createElement("i",null),"订阅成功！"),a.default.createElement("div",{className:"subscribe-layer-qrc"},a.default.createElement("img",{src:m.a})),a.default.createElement("p",null,"第一时间收到开播提示，请下载虎牙APP"),a.default.createElement("span",{onClick:function(){_(),Object(u.reportEvent)({eid:"click/zhibo/book/close",position:"点击/直播间/订阅/关闭"})},className:"subscribe-layer-x J_sub_x"})))))}function g(){return(g=p(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=document.getElementsByClassName("subscribe-entrance")[0],r.default.render(a.default.createElement(w,null),t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){g.apply(this,arguments)}()},956:function(e,t,n){}}]);