(window.HUYA_MAIN_APP_WEBPACK_JSONP=window.HUYA_MAIN_APP_WEBPACK_JSONP||[]).push([[297],{660:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),o=(0,i.__importDefault)(n(3)),r=(0,i.__importDefault)(n(319)),u=(0,i.__importDefault)(n(44)),c=(0,i.__importDefault)(n(661)),a=(0,i.__importDefault)(n(664)),f=(0,i.__importDefault)(n(665)),s=new c.default(o.default.lp),d=[],l=null;function _(e){d.push(e),r.default.preprocess((function(e,t){var n=d.shift(),i=document.getElementById("J_bigStreamerStage"),o=n?s.findConfig(n.iResourceId):null;n&&o&&i?l=new f.default({data:n,conf:o,container:i,onEnd:function(){l=null,e()}}):e()}))}s.on("notify",(function(e){u.default.cfg[20002]||function(e){s.fetchConfig().then((function(){var t=e.iResourceId,n=e.iSFold;if(s.findConfig(t))if(n){var o=a.default.createGroupId(e),r=(0,i.__spreadArray)([],d,!0).reverse().find((function(e){return o===a.default.createGroupId(e)}));r?d.splice(d.indexOf(r),1,e):l&&a.default.createGroupId(l.data)===o?l.comb(e):_(e)}else _(e);else try{console.warn("未知的 iResourceId '"+t+"'")}catch(e){}}))}(e)})),t.default=s},661:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),o=(0,i.__importDefault)(n(19)),r=(0,i.__importDefault)(n(0)),u=n(662);(0,i.__exportStar)(n(663),t);var c=function(e){function t(t){var n=e.call(this)||this;return n.req=null,n.config={iReturnCode:0,vResource:{value:[]},sMd5:""},r.default.isH5&&r.default.ready((function(e){e.addTafListener("6540",(function(e){e.lPresenterUid==t&&n.emit("notify",e)}))})),n}return(0,i.__extends)(t,e),t.prototype.findConfig=function(e){return this.config.vResource.value.find((function(t){var n=t.iResourceId;return e==n}))},t.prototype.fetchConfig=function(e){var t=this;return null!==this.req&&!0!==e||(this.req=(0,u.getActivitySpecialResource)(),this.req.then((function(e){t.emit("update",t.config=e)}))),this.req},t}(o.default);t.default=c},662:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActivitySpecialResource=void 0;var i=(0,n(12).__importDefault)(n(0));t.getActivitySpecialResource=function(){return new Promise((function(e,t){var n=setTimeout((function(){t(new Error("TIMEOUT"))}),8e3);i.default.isH5?i.default.ready((function(i){var o=Object.assign(new i.taf.HUYA.ActivitySpecialResourceReq,{tId:i.userId});i.sendWup2("wupui","getActivitySpecialResource",o,(function(i){clearTimeout(n),0===i.iReturnCode?e(i):t(new Error(""+i.iReturnCode))}))})):t(new Error("NOT SUPPORTING FLASH"))}))}},663:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},664:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Group=void 0;var i=function(){function e(){}return e.createGroupId=function(e){return e.iResourceId+"-"+e.lSenderUid+"-"+e.lComboSeqId},e}();t.Group=i,t.default=i},665:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),o=(0,i.__importDefault)(n(19)),r=n(4),u=function(e){function t(t){var n=t.data,i=t.conf,o=t.container,u=t.onEnd,c=e.call(this)||this;return c.__startTime=0,c.__lastTimming=0,c.data=n,c.conf=i,c.container=o,c.onEnd=(0,r.once)(u),c.__startTime=(new Date).getTime(),c.show(),c}return(0,i.__extends)(t,e),t.prototype.comb=function(e){this.__lastTimming=(new Date).getTime(),this.emit("comb",this.data=e)},t.prototype.show=function(){var e=this,t=this.container,o=this.data,r=this.conf,u=this.onEnd;Promise.resolve().then((function(){return(0,i.__importStar)(n(666))})).then((function(n){(0,n.mount)({data:o,conf:r,container:t,onStart:function(){e.__startTime=(new Date).getTime()},onEnd:function(){var t=(new Date).getTime()-e.__startTime;e.__lastTimming-e.__startTime>.75*t?e.show():e.onEnd()},onError:function(e){u();try{console.log(e)}catch(e){}},listenComb:function(t){return e.on("comb",t)},unlistenComb:function(t){return e.off("comb",t)}})})).catch((function(e){u()}))},t}(o.default);t.default=u}}]);